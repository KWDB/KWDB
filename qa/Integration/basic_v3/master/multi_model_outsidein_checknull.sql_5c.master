> set cluster setting ts.sql.query_opt_mode = 1100;
SET CLUSTER SETTING
> set cluster setting sql.stats.tag_automatic_collection.enabled = false;
SET CLUSTER SETTING
> set cluster setting sql.stats.automatic_collection.enabled = false;
SET CLUSTER SETTING
> CREATE TS DATABASE my_timeseries_db;
CREATE TS DATABASE
> CREATE TABLE my_timeseries_db.firegases (
  "time" TIMESTAMPTZ NOT NULL,
  "value" FLOAT8 NULL
) TAGS (
  adr VARCHAR(20) NOT NULL,
  state VARCHAR(20) NULL,
  second_val FLOAT8 NULL
) PRIMARY TAGS (
  adr
);
CREATE TABLE
> INSERT INTO my_timeseries_db.firegases VALUES
  ('2024-09-01 10:00:00+00', 22.5, 'adr1', 'active', 22.5),
  ('2024-09-01 10:05:00+00', NULL, 'adr2', 'inactive', NULL),
  ('2024-09-01 10:10:00+00', 30.0, 'adr3', NULL, 30.0),
  ('2024-09-01 10:15:00+00', 15.0, 'adr4', 'pending', 15.0);
INSERT 4
> CREATE DATABASE my_relation_db;
CREATE DATABASE
> CREATE TABLE my_relation_db.station_info (
  station_sn VARCHAR(20) PRIMARY KEY NOT NULL,
  station_name VARCHAR(80) NULL,
  work_area_sn VARCHAR(20) NULL,
  expected_state VARCHAR(20) NULL,
  standard_val FLOAT8 NULL
);
CREATE TABLE
> INSERT INTO my_relation_db.station_info VALUES
  ('sn1', 'Station One', 'adr1', 'active', 22.5),
  ('sn2', 'Station Two', NULL, 'inactive', 10.0),
  ('sn3', 'Station Three', 'adr3', 'pending', 35.0),
  ('sn4', 'Station Four', NULL, 'pending', NULL),
  ('sn5', 'Station Five', 'adr5', NULL, 15.5),
  ('sn6', 'Station Six', NULL, NULL, NULL);
INSERT 6
> CREATE STATISTICS _stats_firegases FROM my_timeseries_db.firegases;
CREATE STATISTICS
> CREATE STATISTICS _stats_station_info FROM my_relation_db.station_info;
CREATE STATISTICS
> select "name","columnIDs","rowCount","distinctCount","nullCount" from system.table_statistics  where name = '_stats_firegases';
        name       | columnIDs | rowCount | distinctCount | nullCount
-------------------+-----------+----------+---------------+------------
  _stats_firegases | {1}       |        4 |             4 |         0
  _stats_firegases | {2}       |        4 |             4 |         1
  _stats_firegases | {4}       |        4 |             4 |         1
  _stats_firegases | {5}       |        4 |             4 |         1
  _stats_firegases | {3}       |        4 |             4 |         0
(5 rows)
> select "name","columnIDs","rowCount","distinctCount","nullCount" from system.table_statistics  where name = '_stats_station_info';
         name         | columnIDs | rowCount | distinctCount | nullCount
----------------------+-----------+----------+---------------+------------
  _stats_station_info | {1}       |        6 |             6 |         0
  _stats_station_info | {2}       |        6 |             6 |         0
  _stats_station_info | {3}       |        6 |             4 |         3
  _stats_station_info | {4}       |        6 |             4 |         2
  _stats_station_info | {5}       |        6 |             5 |         2
(5 rows)
> set enable_multimodel=true;
SET
> set hash_scan_mode = 0;
SET
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
ORDER BY f."time", s.station_sn;
                tree               |     field      |        description
-----------------------------------+----------------+-----------------------------
                                   | distributed    | true
                                   | vectorized     | false
  render                           |                |
   │                               | time           | "time"
   │                               | value          | value
   │                               | station_sn     | station_sn
   │                               | station_name   | station_name
   │                               | work_area_sn   | work_area_sn
   │                               | expected_state | expected_state
   │                               | standard_val   | standard_val
   │                               | adr            | adr
   │                               | state          | state
   │                               | second_val     | second_val
   └── sort                        |                |
        │                          | order          | +"time",+station_sn
        └── hash-join              |                |
             │                     | type           | inner
             │                     | equality       | (expected_state) = (state)
             ├── scan              |                |
             │                     | table          | station_info@primary
             │                     | spans          | FULL SCAN
             │                     | filter         | expected_state IS NOT NULL
             └── filter            |                |
                  │                | filter         | state IS NOT NULL
                  └── synchronizer |                |
                       └── ts scan |                |
                                   | ts-table       | firegases
                                   | access mode    | tableTableMeta
(28 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
ORDER BY f."time", s.station_sn;
            time            | value | station_sn | station_name  | work_area_sn | expected_state | standard_val | adr  |  state   | second_val
----------------------------+-------+------------+---------------+--------------+----------------+--------------+------+----------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One   | adr1         | active         |         22.5 | adr1 | active   |       22.5
  2024-09-01 10:05:00+00:00 | NULL  | sn2        | Station Two   | NULL         | inactive       |           10 | adr2 | inactive | NULL
  2024-09-01 10:15:00+00:00 |    15 | sn3        | Station Three | adr3         | pending        |           35 | adr4 | pending  |         15
  2024-09-01 10:15:00+00:00 |    15 | sn4        | Station Four  | NULL         | pending        | NULL         | adr4 | pending  |         15
(4 rows)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state != 'pending' and f.state = s.expected_state
ORDER BY f."time";
             tree             |     field      |         description
------------------------------+----------------+------------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (expected_state) = (state)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             │                | filter         | expected_state != 'pending'
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
                              | tag filter[0]  | state != 'pending'
(27 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state != 'pending' and f.state = s.expected_state
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  |  state   | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+----------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active   |       22.5
  2024-09-01 10:05:00+00:00 | NULL  | sn2        | Station Two  | NULL         | inactive       |           10 | adr2 | inactive | NULL
(2 rows)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
ORDER BY f."time", s.station_sn;
             tree             |     field      |        description
------------------------------+----------------+-----------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time",+station_sn
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (expected_state) = (state)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
ORDER BY f."time", s.station_sn;
            time            | value | station_sn | station_name  | work_area_sn | expected_state | standard_val | adr  |  state   | second_val
----------------------------+-------+------------+---------------+--------------+----------------+--------------+------+----------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One   | adr1         | active         |         22.5 | adr1 | active   |       22.5
  2024-09-01 10:05:00+00:00 | NULL  | sn2        | Station Two   | NULL         | inactive       |           10 | adr2 | inactive | NULL
  2024-09-01 10:15:00+00:00 |    15 | sn3        | Station Three | adr3         | pending        |           35 | adr4 | pending  |         15
  2024-09-01 10:15:00+00:00 |    15 | sn4        | Station Four  | NULL         | pending        | NULL         | adr4 | pending  |         15
(4 rows)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.standard_val is not NULL AND f."value" = s.standard_val
ORDER BY f."time";
             tree             |     field      |       description
------------------------------+----------------+---------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (value) = (standard_val)
             ├── synchronizer |                |
             │    └── ts scan |                |
             │                | ts-table       | firegases
             │                | access mode    | tableTableMeta
             └── scan         |                |
                              | table          | station_info@primary
                              | spans          | FULL SCAN
                              | filter         | standard_val IS NOT NULL
(26 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.standard_val is not NULL AND f."value" = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" is not NULL AND f."value" = s.standard_val
ORDER BY f."time";
                tree               |        field        |       description
-----------------------------------+---------------------+---------------------------
                                   | distributed         | true
                                   | vectorized          | false
  render                           |                     |
   │                               | time                | "time"
   │                               | value               | value
   │                               | station_sn          | station_sn
   │                               | station_name        | station_name
   │                               | work_area_sn        | work_area_sn
   │                               | expected_state      | expected_state
   │                               | standard_val        | standard_val
   │                               | adr                 | adr
   │                               | state               | state
   │                               | second_val          | second_val
   └── sort                        |                     |
        │                          | order               | +"time"
        └── hash-join              |                     |
             │                     | type                | inner
             │                     | equality            | (standard_val) = (value)
             ├── scan              |                     |
             │                     | table               | station_info@primary
             │                     | spans               | FULL SCAN
             └── filter            |                     |
                  │                | filter              | value IS NOT NULL
                  └── synchronizer |                     |
                       └── ts scan |                     |
                                   | ts-table            | firegases
                                   | access mode         | tableTableMeta
                                   | block filter[value] | NOT NULL
(28 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" is not NULL AND f."value" = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" = s.standard_val
ORDER BY f."time";
             tree             |     field      |       description
------------------------------+----------------+---------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (standard_val) = (value)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.standard_val is not NULL AND f.second_val = s.standard_val
ORDER BY f."time";
             tree             |     field      |          description
------------------------------+----------------+--------------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (second_val) = (standard_val)
             ├── synchronizer |                |
             │    └── ts scan |                |
             │                | ts-table       | firegases
             │                | access mode    | tableTableMeta
             └── scan         |                |
                              | table          | station_info@primary
                              | spans          | FULL SCAN
                              | filter         | standard_val IS NOT NULL
(26 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.standard_val is not NULL AND f.second_val = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" is not NULL AND f.second_val = s.standard_val
ORDER BY f."time";
                tree               |        field        |          description
-----------------------------------+---------------------+--------------------------------
                                   | distributed         | true
                                   | vectorized          | false
  render                           |                     |
   │                               | time                | "time"
   │                               | value               | value
   │                               | station_sn          | station_sn
   │                               | station_name        | station_name
   │                               | work_area_sn        | work_area_sn
   │                               | expected_state      | expected_state
   │                               | standard_val        | standard_val
   │                               | adr                 | adr
   │                               | state               | state
   │                               | second_val          | second_val
   └── sort                        |                     |
        │                          | order               | +"time"
        └── hash-join              |                     |
             │                     | type                | inner
             │                     | equality            | (standard_val) = (second_val)
             ├── scan              |                     |
             │                     | table               | station_info@primary
             │                     | spans               | FULL SCAN
             └── filter            |                     |
                  │                | filter              | value IS NOT NULL
                  └── synchronizer |                     |
                       └── ts scan |                     |
                                   | ts-table            | firegases
                                   | access mode         | tableTableMeta
                                   | block filter[value] | NOT NULL
(28 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" is not NULL AND f.second_val = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.second_val = s.standard_val
ORDER BY f."time";
             tree             |     field      |          description
------------------------------+----------------+--------------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (standard_val) = (second_val)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.second_val = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
                  tree                  |    field     |        description
----------------------------------------+--------------+-----------------------------
                                        | distributed  | true
                                        | vectorized   | false
  sort                                  |              |
   │                                    | order        | +work_area_sn
   └── group                            |              |
        │                               | aggregate 0  | work_area_sn
        │                               | aggregate 1  | avg(value)
        │                               | aggregate 2  | avg(standard_val)
        │                               | aggregate 3  | sum(second_val)
        │                               | aggregate 4  | count(standard_val)
        │                               | aggregate 5  | count(state)
        │                               | aggregate 6  | count(station_name)
        │                               | group by     | work_area_sn
        └── render                      |              |
             │                          | value        | value
             │                          | state        | state
             │                          | second_val   | second_val
             │                          | station_name | station_name
             │                          | work_area_sn | work_area_sn
             │                          | standard_val | standard_val
             └── hash-join              |              |
                  │                     | type         | inner
                  │                     | equality     | (expected_state) = (state)
                  ├── scan              |              |
                  │                     | table        | station_info@primary
                  │                     | spans        | FULL SCAN
                  │                     | filter       | expected_state IS NOT NULL
                  └── filter            |              |
                       │                | filter       | state IS NOT NULL
                       └── synchronizer |              |
                            └── ts scan |              |
                                        | ts-table     | firegases
                                        | access mode  | tableTableMeta
(33 rows)
> SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
  work_area_sn | avg  | avg  | sum  | count | count | count
---------------+------+------+------+-------+-------+--------
  NULL         |   15 |   10 |   15 |     1 |     2 |     2
  adr1         | 22.5 | 22.5 | 22.5 |     1 |     1 |     1
  adr3         |   15 |   35 |   15 |     1 |     1 |     1
(3 rows)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
      AND f.adr = s.work_area_sn
ORDER BY f."time", s.station_sn;
             tree             |     field      |                  description
------------------------------+----------------+------------------------------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time",+station_sn
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (expected_state, work_area_sn) = (state, adr)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
      AND f.adr = s.work_area_sn
ORDER BY f."time", s.station_sn;
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.second_val + 5 = s.standard_val
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
                  tree                  |    field     |         description
----------------------------------------+--------------+------------------------------
                                        | distributed  | true
                                        | vectorized   | false
  sort                                  |              |
   │                                    | order        | +work_area_sn
   └── group                            |              |
        │                               | aggregate 0  | work_area_sn
        │                               | aggregate 1  | avg(value)
        │                               | aggregate 2  | avg(standard_val)
        │                               | aggregate 3  | sum(second_val)
        │                               | aggregate 4  | count(standard_val)
        │                               | aggregate 5  | count(state)
        │                               | aggregate 6  | count(station_name)
        │                               | group by     | work_area_sn
        └── render                      |              |
             │                          | value        | value
             │                          | state        | state
             │                          | second_val   | second_val
             │                          | station_name | station_name
             │                          | work_area_sn | work_area_sn
             │                          | standard_val | standard_val
             └── hash-join              |              |
                  │                     | type         | inner
                  │                     | equality     | (column11) = (standard_val)
                  ├── render            |              |
                  │    │                | column11     | second_val + 5.0
                  │    │                | value        | value
                  │    │                | state        | state
                  │    │                | second_val   | second_val
                  │    └── synchronizer |              |
                  │         └── ts scan |              |
                  │                     | ts-table     | firegases
                  │                     | access mode  | tableTableMeta
                  └── scan              |              |
                                        | table        | station_info@primary
                                        | spans        | FULL SCAN
                                        | filter       | expected_state IS NOT NULL
(36 rows)
> SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.second_val + 5 = s.standard_val
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
  work_area_sn | avg | avg | sum | count | count | count
---------------+-----+-----+-----+-------+-------+--------
  adr3         |  30 |  35 |  30 |     1 |     0 |     1
(1 row)
> explain SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.second_val = s.standard_val and f.state = s.expected_state
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
                  tree                  |    field     |                     description
----------------------------------------+--------------+-------------------------------------------------------
                                        | distributed  | true
                                        | vectorized   | false
  group                                 |              |
   │                                    | aggregate 0  | work_area_sn
   │                                    | aggregate 1  | avg(value)
   │                                    | aggregate 2  | avg(standard_val)
   │                                    | aggregate 3  | sum(second_val)
   │                                    | aggregate 4  | count(standard_val)
   │                                    | aggregate 5  | count(state)
   │                                    | aggregate 6  | count(station_name)
   │                                    | group by     | work_area_sn
   │                                    | ordered      | +work_area_sn
   └── render                           |              |
        │                               | value        | value
        │                               | state        | state
        │                               | second_val   | second_val
        │                               | station_name | station_name
        │                               | work_area_sn | work_area_sn
        │                               | standard_val | standard_val
        └── sort                        |              |
             │                          | order        | +work_area_sn
             └── hash-join              |              |
                  │                     | type         | inner
                  │                     | equality     | (standard_val, expected_state) = (second_val, state)
                  ├── scan              |              |
                  │                     | table        | station_info@primary
                  │                     | spans        | FULL SCAN
                  │                     | filter       | expected_state IS NOT NULL
                  └── filter            |              |
                       │                | filter       | state IS NOT NULL
                       └── synchronizer |              |
                            └── ts scan |              |
                                        | ts-table     | firegases
                                        | access mode  | tableTableMeta
(34 rows)
> SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.second_val = s.standard_val and f.state = s.expected_state
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
  work_area_sn | avg  | avg  | sum  | count | count | count
---------------+------+------+------+-------+-------+--------
  adr1         | 22.5 | 22.5 | 22.5 |     1 |     1 |     1
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE s.expected_state is not NULL and f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.work_area_sn = ts.adr
ORDER BY ts."value";
                       tree                       |       field        |        description
--------------------------------------------------+--------------------+-----------------------------
                                                  | distributed        | true
                                                  | vectorized         | false
  render                                          |                    |
   │                                              | time               | "time"
   │                                              | value              | value
   │                                              | work_area_sn       | work_area_sn
   │                                              | avg                | avg
   │                                              | avg                | avg
   │                                              | sum                | sum
   │                                              | count              | count
   │                                              | count              | count
   │                                              | count              | count
   │                                              | adr                | adr
   │                                              | state              | state
   │                                              | second_val         | second_val
   └── sort                                       |                    |
        │                                         | order              | +value
        └── hash-join                             |                    |
             │                                    | type               | inner
             │                                    | equality           | (adr) = (work_area_sn)
             │                                    | right cols are key |
             ├── synchronizer                     |                    |
             │    └── ts scan                     |                    |
             │                                    | ts-table           | firegases
             │                                    | access mode        | tableTableMeta
             └── group                            |                    |
                  │                               | aggregate 0        | work_area_sn
                  │                               | aggregate 1        | avg(value)
                  │                               | aggregate 2        | avg(standard_val)
                  │                               | aggregate 3        | sum(second_val)
                  │                               | aggregate 4        | count(standard_val)
                  │                               | aggregate 5        | count(state)
                  │                               | aggregate 6        | count(station_name)
                  │                               | group by           | work_area_sn
                  └── render                      |                    |
                       │                          | value              | value
                       │                          | state              | state
                       │                          | second_val         | second_val
                       │                          | station_name       | station_name
                       │                          | work_area_sn       | work_area_sn
                       │                          | standard_val       | standard_val
                       └── hash-join              |                    |
                            │                     | type               | inner
                            │                     | equality           | (expected_state) = (state)
                            ├── scan              |                    |
                            │                     | table              | station_info@primary
                            │                     | spans              | FULL SCAN
                            │                     | filter             | expected_state IS NOT NULL
                            └── filter            |                    |
                                 │                | filter             | state IS NOT NULL
                                 └── synchronizer |                    |
                                      └── ts scan |                    |
                                                  | ts-table           | firegases
                                                  | access mode        | tableTableMeta
(54 rows)
> SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE s.expected_state is not NULL and f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.work_area_sn = ts.adr
ORDER BY ts."value";
            time            | value | work_area_sn | avg  | avg  | sum  | count | count | count | adr  | state  | second_val
----------------------------+-------+--------------+------+------+------+-------+-------+-------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | adr1         | 22.5 | 22.5 | 22.5 |     1 |     1 |     1 | adr1 | active |       22.5
  2024-09-01 10:10:00+00:00 |    30 | adr3         |   15 |   35 |   15 |     1 |     1 |     1 | adr3 | NULL   |         30
(2 rows)
> explain SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value") as value_avg,
      AVG(s.standard_val) as standard_avg,
      SUM(f.second_val) as second_avg,
      COUNT(s.standard_val) as standar_count,
      COUNT(f.state) as state_count,
      COUNT(s.station_name) as station_count
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.standard_avg= ts.second_val;
                  tree                  |     field     |        description
----------------------------------------+---------------+-----------------------------
                                        | distributed   | true
                                        | vectorized    | false
  render                                |               |
   │                                    | time          | "time"
   │                                    | value         | value
   │                                    | work_area_sn  | work_area_sn
   │                                    | value_avg     | avg
   │                                    | standard_avg  | avg
   │                                    | second_avg    | sum
   │                                    | standar_count | count
   │                                    | state_count   | count
   │                                    | station_count | count
   │                                    | adr           | adr
   │                                    | state         | state
   │                                    | second_val    | second_val
   └── hash-join                        |               |
        │                               | type          | inner
        │                               | equality      | (second_val) = (avg)
        ├── synchronizer                |               |
        │    └── ts scan                |               |
        │                               | ts-table      | firegases
        │                               | access mode   | tableTableMeta
        └── group                       |               |
             │                          | aggregate 0   | work_area_sn
             │                          | aggregate 1   | avg(value)
             │                          | aggregate 2   | avg(standard_val)
             │                          | aggregate 3   | sum(second_val)
             │                          | aggregate 4   | count(standard_val)
             │                          | aggregate 5   | count(state)
             │                          | aggregate 6   | count(station_name)
             │                          | group by      | work_area_sn
             └── render                 |               |
                  │                     | value         | value
                  │                     | state         | state
                  │                     | second_val    | second_val
                  │                     | station_name  | station_name
                  │                     | work_area_sn  | work_area_sn
                  │                     | standard_val  | standard_val
                  └── hash-join         |               |
                       │                | type          | inner
                       │                | equality      | (expected_state) = (state)
                       ├── scan         |               |
                       │                | table         | station_info@primary
                       │                | spans         | FULL SCAN
                       └── synchronizer |               |
                            └── ts scan |               |
                                        | ts-table      | firegases
                                        | access mode   | tableTableMeta
(48 rows)
> SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value") as value_avg,
      AVG(s.standard_val) as standard_avg,
      SUM(f.second_val) as second_avg,
      COUNT(s.standard_val) as standar_count,
      COUNT(f.state) as state_count,
      COUNT(s.station_name) as station_count
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.standard_avg= ts.second_val;
            time            | value | work_area_sn | value_avg | standard_avg | second_avg | standar_count | state_count | station_count | adr  | state  | second_val
----------------------------+-------+--------------+-----------+--------------+------------+---------------+-------------+---------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | adr1         |      22.5 |         22.5 |       22.5 |             1 |           1 |             1 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value") as value_avg,
      AVG(s.standard_val) as standard_avg,
      SUM(f.second_val) as second_avg,
      COUNT(s.standard_val) as standar_count,
      COUNT(f.state) as state_count,
      COUNT(s.station_name) as station_count
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.standard_avg + 5 = ts.second_val;
                     tree                    |     field     |        description
---------------------------------------------+---------------+-----------------------------
                                             | distributed   | true
                                             | vectorized    | false
  render                                     |               |
   │                                         | time          | "time"
   │                                         | value         | value
   │                                         | work_area_sn  | work_area_sn
   │                                         | value_avg     | avg
   │                                         | standard_avg  | avg
   │                                         | second_avg    | sum
   │                                         | standar_count | count
   │                                         | state_count   | count
   │                                         | station_count | count
   │                                         | adr           | adr
   │                                         | state         | state
   │                                         | second_val    | second_val
   └── hash-join                             |               |
        │                                    | type          | inner
        │                                    | equality      | (second_val) = (column22)
        ├── synchronizer                     |               |
        │    └── ts scan                     |               |
        │                                    | ts-table      | firegases
        │                                    | access mode   | tableTableMeta
        └── render                           |               |
             │                               | column22      | avg + 5.0
             │                               | work_area_sn  | work_area_sn
             │                               | avg           | avg
             │                               | avg           | avg
             │                               | sum           | sum
             │                               | count         | count
             │                               | count         | count
             │                               | count         | count
             └── group                       |               |
                  │                          | aggregate 0   | work_area_sn
                  │                          | aggregate 1   | avg(value)
                  │                          | aggregate 2   | avg(standard_val)
                  │                          | aggregate 3   | sum(second_val)
                  │                          | aggregate 4   | count(standard_val)
                  │                          | aggregate 5   | count(state)
                  │                          | aggregate 6   | count(station_name)
                  │                          | group by      | work_area_sn
                  └── render                 |               |
                       │                     | value         | value
                       │                     | state         | state
                       │                     | second_val    | second_val
                       │                     | station_name  | station_name
                       │                     | work_area_sn  | work_area_sn
                       │                     | standard_val  | standard_val
                       └── hash-join         |               |
                            │                | type          | inner
                            │                | equality      | (expected_state) = (state)
                            ├── scan         |               |
                            │                | table         | station_info@primary
                            │                | spans         | FULL SCAN
                            └── synchronizer |               |
                                 └── ts scan |               |
                                             | ts-table      | firegases
                                             | access mode   | tableTableMeta
(57 rows)
> SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value") as value_avg,
      AVG(s.standard_val) as standard_avg,
      SUM(f.second_val) as second_avg,
      COUNT(s.standard_val) as standar_count,
      COUNT(f.state) as state_count,
      COUNT(s.station_name) as station_count
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.standard_avg + 5 = ts.second_val;
            time            | value | work_area_sn | value_avg | standard_avg | second_avg | standar_count | state_count | station_count | adr  |  state  | second_val
----------------------------+-------+--------------+-----------+--------------+------------+---------------+-------------+---------------+------+---------+-------------
  2024-09-01 10:15:00+00:00 |    15 | NULL         |        15 |           10 |         15 |             1 |           2 |             2 | adr4 | pending |         15
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
    (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s,
        my_timeseries_db.firegases fire
    WHERE s.expected_state = fire.state
    GROUP BY expected_state) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
                  tree                  |       field        |                 description
----------------------------------------+--------------------+----------------------------------------------
                                        | distributed        | true
                                        | vectorized         | false
  render                                |                    |
   │                                    | time               | "time"
   │                                    | value              | value
   │                                    | expected_state     | expected_state
   │                                    | standard_avg       | avg
   │                                    | adr                | adr
   │                                    | state              | state
   │                                    | second_val         | second_val
   └── hash-join                        |                    |
        │                               | type               | inner
        │                               | equality           | (second_val, state) = (avg, expected_state)
        │                               | right cols are key |
        ├── synchronizer                |                    |
        │    └── ts scan                |                    |
        │                               | ts-table           | firegases
        │                               | access mode        | tableTableMeta
        └── group                       |                    |
             │                          | aggregate 0        | expected_state
             │                          | aggregate 1        | avg(standard_val)
             │                          | group by           | expected_state
             └── render                 |                    |
                  │                     | expected_state     | expected_state
                  │                     | standard_val       | standard_val
                  └── hash-join         |                    |
                       │                | type               | inner
                       │                | equality           | (expected_state) = (state)
                       ├── scan         |                    |
                       │                | table              | station_info@primary
                       │                | spans              | FULL SCAN
                       └── synchronizer |                    |
                            └── ts scan |                    |
                                        | ts-table           | firegases
                                        | access mode        | tableTableMeta
(35 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
    (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s,
        my_timeseries_db.firegases fire
    WHERE s.expected_state = fire.state
    GROUP BY expected_state) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
            time            | value | expected_state | standard_avg | adr  | state  | second_val
----------------------------+-------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
    ((SELECT expected_state, standard_val as standard_avg
    FROM my_relation_db.station_info)
    UNION (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s,
        my_timeseries_db.firegases fire
    WHERE s.expected_state = fire.state
    GROUP BY expected_state)) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
                     tree                    |       field       |                     description
---------------------------------------------+-------------------+-------------------------------------------------------
                                             | distributed       | true
                                             | vectorized        | false
  render                                     |                   |
   │                                         | time              | "time"
   │                                         | value             | value
   │                                         | expected_state    | expected_state
   │                                         | standard_avg      | standard_val
   │                                         | adr               | adr
   │                                         | state             | state
   │                                         | second_val        | second_val
   └── hash-join                             |                   |
        │                                    | type              | inner
        │                                    | equality          | (standard_val, expected_state) = (second_val, state)
        │                                    | left cols are key |
        ├── union                            |                   |
        │    ├── group                       |                   |
        │    │    │                          | aggregate 0       | expected_state
        │    │    │                          | aggregate 1       | avg(standard_val)
        │    │    │                          | group by          | expected_state
        │    │    └── render                 |                   |
        │    │         │                     | expected_state    | expected_state
        │    │         │                     | standard_val      | standard_val
        │    │         └── hash-join         |                   |
        │    │              │                | type              | inner
        │    │              │                | equality          | (expected_state) = (state)
        │    │              ├── scan         |                   |
        │    │              │                | table             | station_info@primary
        │    │              │                | spans             | FULL SCAN
        │    │              └── synchronizer |                   |
        │    │                   └── ts scan |                   |
        │    │                               | ts-table          | firegases
        │    │                               | access mode       | tableTableMeta
        │    └── scan                        |                   |
        │                                    | table             | station_info@primary
        │                                    | spans             | FULL SCAN
        └── synchronizer                     |                   |
             └── ts scan                     |                   |
                                             | ts-table          | firegases
                                             | access mode       | tableTableMeta
(39 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
    ((SELECT expected_state, standard_val as standard_avg
    FROM my_relation_db.station_info)
    UNION (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s,
        my_timeseries_db.firegases fire
    WHERE s.expected_state = fire.state
    GROUP BY expected_state)) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
            time            | value | expected_state | standard_avg | adr  | state  | second_val
----------------------------+-------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
    ((SELECT expected_state, standard_val as standard_avg
    FROM my_relation_db.station_info)
    UNION (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s
    RIGHT JOIN my_timeseries_db.firegases fire
    ON s.expected_state = fire.state
    GROUP BY expected_state)) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
                     tree                    |       field       |                     description
---------------------------------------------+-------------------+-------------------------------------------------------
                                             | distributed       | true
                                             | vectorized        | false
  render                                     |                   |
   │                                         | time              | "time"
   │                                         | value             | value
   │                                         | expected_state    | expected_state
   │                                         | standard_avg      | standard_val
   │                                         | adr               | adr
   │                                         | state             | state
   │                                         | second_val        | second_val
   └── hash-join                             |                   |
        │                                    | type              | inner
        │                                    | equality          | (standard_val, expected_state) = (second_val, state)
        │                                    | left cols are key |
        ├── union                            |                   |
        │    ├── group                       |                   |
        │    │    │                          | aggregate 0       | expected_state
        │    │    │                          | aggregate 1       | avg(standard_val)
        │    │    │                          | group by          | expected_state
        │    │    └── render                 |                   |
        │    │         │                     | expected_state    | expected_state
        │    │         │                     | standard_val      | standard_val
        │    │         └── hash-join         |                   |
        │    │              │                | type              | right outer
        │    │              │                | equality          | (expected_state) = (state)
        │    │              ├── scan         |                   |
        │    │              │                | table             | station_info@primary
        │    │              │                | spans             | FULL SCAN
        │    │              └── synchronizer |                   |
        │    │                   └── ts scan |                   |
        │    │                               | ts-table          | firegases
        │    │                               | access mode       | tableTableMeta
        │    └── scan                        |                   |
        │                                    | table             | station_info@primary
        │                                    | spans             | FULL SCAN
        └── synchronizer                     |                   |
             └── ts scan                     |                   |
                                             | ts-table          | firegases
                                             | access mode       | tableTableMeta
(39 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
    ((SELECT expected_state, standard_val as standard_avg
    FROM my_relation_db.station_info)
    UNION (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s
    RIGHT JOIN my_timeseries_db.firegases fire
    ON s.expected_state = fire.state
    GROUP BY expected_state)) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
            time            | value | expected_state | standard_avg | adr  | state  | second_val
----------------------------+-------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | active         |         22.5 | adr1 | active |       22.5
(1 row)
> CREATE TS DATABASE my_timeseries_db_v2;
CREATE TS DATABASE
> CREATE TABLE my_timeseries_db_v2.firegases (
  "time" TIMESTAMPTZ NOT NULL,
  second_val FLOAT8 NULL
)
TAGS (
  adr INT NOT NULL,
  state VARCHAR(20) NULL,
  int2_val INT2 NULL,
  int4_val INT4 NULL,
  int_val INT NULL,
  float4_val FLOAT4 NULL,
  float_val FLOAT8 NULL,
  bool_val BOOL NULL
)
PRIMARY TAGS (
  adr
);
CREATE TABLE
> INSERT INTO my_timeseries_db_v2.firegases ("time", int2_val, int4_val, int_val, float4_val, float_val, bool_val, adr, state, second_val) VALUES
  ('2024-09-01 10:00:00+00', 10, 1000, 10000, 22.5, 22.5, TRUE, 1, 'active', 25.0),
  ('2024-09-01 10:05:00+00', 20, 2000, 20000, 18.5, NULL, FALSE, 2, 'inactive', NULL),
  ('2024-09-01 10:10:00+00', NULL, 3000, NULL, 30.0, 30.0, TRUE, 3, 'pending', 30.0),
  ('2024-09-01 10:15:00+00', 40, NULL, 40000, NULL, 15.0, NULL, 4, 'active', 15.0),
  ('2024-09-01 10:20:00+00', 50, 5000, NULL, 12.5, 12.5, TRUE, 5, NULL, NULL),
  ('2024-09-01 10:25:00+00', 60, 6000, 60000, 17.5, 17.5, FALSE, 6, 'inactive', NULL);
INSERT 6
> CREATE DATABASE my_relation_db_v2;
CREATE DATABASE
> CREATE TABLE my_relation_db_v2.station_info (
  station_sn INT PRIMARY KEY NOT NULL,   -- Using INT
  station_name VARCHAR(80) NULL,
  work_area_sn_int2 INT2 NULL,           -- Using INT2
  work_area_sn_int4 INT4 NULL,           -- Using INT4
  work_area_sn_int INT NULL,              -- Using INT
  expected_state VARCHAR(20) NULL,
  standard_val_float4 FLOAT4 NULL,       -- Using FLOAT4
  standard_val_float FLOAT NULL,          -- Using FLOAT
  bool_val BOOL NULL                      -- Using BOOL
);
CREATE TABLE
> INSERT INTO my_relation_db_v2.station_info VALUES
  (1, 'Station One', 1, 10, 10000, 'active', 22.5, 20.0, TRUE),   -- 添加 float 列
  (2, 'Station Two', 2, NULL, 200, 'inactive', 10.0, 5.0, FALSE),
  (3, 'Station Three', NULL, 3000, NULL, 'pending', 35.0, 30.0, TRUE),
  (4, 'Station Four', NULL, NULL, 40000, 'pending', NULL, 15.0, NULL),
  (5, 'Station Five', 40, 6000, 500, NULL, 15.5, 12.5, TRUE),
  (6, 'Station Six', NULL, NULL, NULL, NULL, NULL, NULL, FALSE);
INSERT 6
> CREATE STATISTICS _stats_ FROM my_timeseries_db_v2.firegases;
CREATE STATISTICS
> CREATE STATISTICS _stats_ FROM my_relation_db_v2.station_info;
CREATE STATISTICS
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.int2_val = s.work_area_sn_int2
ORDER BY f."time";
             tree             |        field        |           description
------------------------------+---------------------+-----------------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (int2_val) = (work_area_sn_int2)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.int2_val = s.work_area_sn_int2
ORDER BY f."time";
            time            | second_val | station_sn | station_name | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr | state  | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+--------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+--------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:15:00+00:00 |         15 |          5 | Station Five |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   4 | active |       40 | NULL     |   40000 | NULL       |        15 |   NULL
(1 row)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.int4_val = s.work_area_sn_int4
ORDER BY f."time";
             tree             |        field        |           description
------------------------------+---------------------+-----------------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (int4_val) = (work_area_sn_int4)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.int4_val = s.work_area_sn_int4
ORDER BY f."time";
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state   | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+----------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:25:00+00:00 | NULL       |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   6 | inactive |       60 |     6000 |   60000 |       17.5 |      17.5 |  false
(2 rows)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.adr = s.station_sn
ORDER BY f."time";
             tree             |        field        |     description
------------------------------+---------------------+-----------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (adr) = (station_sn)
             │                | right cols are key  |
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(35 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.adr = s.station_sn
ORDER BY f."time";
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state   | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+----------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:00:00+00:00 |         25 |          1 | Station One   |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   1 | active   |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
  2024-09-01 10:05:00+00:00 | NULL       |          2 | Station Two   |                 2 | NULL              |              200 | inactive       |                  10 |                  5 |  false   |   2 | inactive |       20 |     2000 |   20000 |       18.5 | NULL      |  false
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:15:00+00:00 |         15 |          4 | Station Four  | NULL              | NULL              |            40000 | pending        | NULL                |                 15 |   NULL   |   4 | active   |       40 | NULL     |   40000 | NULL       |        15 |   NULL
  2024-09-01 10:20:00+00:00 | NULL       |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   5 | NULL     |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
  2024-09-01 10:25:00+00:00 | NULL       |          6 | Station Six   | NULL              | NULL              | NULL             | NULL           | NULL                | NULL               |  false   |   6 | inactive |       60 |     6000 |   60000 |       17.5 |      17.5 |  false
(6 rows)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.float4_val = s.standard_val_float4
ORDER BY f."time";
             tree             |        field        |             description
------------------------------+---------------------+---------------------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (float4_val) = (standard_val_float4)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.float4_val = s.standard_val_float4
ORDER BY f."time";
            time            | second_val | station_sn | station_name | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr | state  | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+--------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+--------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:00:00+00:00 |         25 |          1 | Station One  |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   1 | active |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
(1 row)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.float_val = s.standard_val_float
ORDER BY f."time";
             tree             |        field        |            description
------------------------------+---------------------+-------------------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (float_val) = (standard_val_float)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.float_val = s.standard_val_float
ORDER BY f."time";
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state  | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+---------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:15:00+00:00 |         15 |          4 | Station Four  | NULL              | NULL              |            40000 | pending        | NULL                |                 15 |   NULL   |   4 | active  |       40 | NULL     |   40000 | NULL       |        15 |   NULL
  2024-09-01 10:20:00+00:00 | NULL       |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   5 | NULL    |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
(3 rows)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f
JOIN my_relation_db_v2.station_info s ON f.second_val = s.standard_val_float
WHERE f.second_val IS NOT NULL AND s.standard_val_float IS NOT NULL
ORDER BY f."time";
                tree               |          field           |             description
-----------------------------------+--------------------------+--------------------------------------
                                   | distributed              | true
                                   | vectorized               | false
  render                           |                          |
   │                               | time                     | "time"
   │                               | second_val               | second_val
   │                               | station_sn               | station_sn
   │                               | station_name             | station_name
   │                               | work_area_sn_int2        | work_area_sn_int2
   │                               | work_area_sn_int4        | work_area_sn_int4
   │                               | work_area_sn_int         | work_area_sn_int
   │                               | expected_state           | expected_state
   │                               | standard_val_float4      | standard_val_float4
   │                               | standard_val_float       | standard_val_float
   │                               | bool_val                 | bool_val
   │                               | adr                      | adr
   │                               | state                    | state
   │                               | int2_val                 | int2_val
   │                               | int4_val                 | int4_val
   │                               | int_val                  | int_val
   │                               | float4_val               | float4_val
   │                               | float_val                | float_val
   │                               | bool_val                 | bool_val
   └── sort                        |                          |
        │                          | order                    | +"time"
        └── hash-join              |                          |
             │                     | type                     | inner
             │                     | equality                 | (standard_val_float) = (second_val)
             ├── scan              |                          |
             │                     | table                    | station_info@primary
             │                     | spans                    | FULL SCAN
             │                     | filter                   | standard_val_float IS NOT NULL
             └── filter            |                          |
                  │                | filter                   | second_val IS NOT NULL
                  └── synchronizer |                          |
                       └── ts scan |                          |
                                   | ts-table                 | firegases
                                   | access mode              | tableTableMeta
                                   | block filter[second_val] | NOT NULL
(38 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f
JOIN my_relation_db_v2.station_info s ON f.second_val = s.standard_val_float
WHERE f.second_val IS NOT NULL AND s.standard_val_float IS NOT NULL
ORDER BY f."time";
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state  | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+---------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:15:00+00:00 |         15 |          4 | Station Four  | NULL              | NULL              |            40000 | pending        | NULL                |                 15 |   NULL   |   4 | active  |       40 | NULL     |   40000 | NULL       |        15 |   NULL
(2 rows)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.bool_val = s.bool_val
ORDER BY f."time";
             tree             |        field        |       description
------------------------------+---------------------+--------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (bool_val) = (bool_val)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.bool_val = s.bool_val
ORDER BY f."time", s.station_sn, f.float_val, f.int_val, f.adr;
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state   | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+----------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:00:00+00:00 |         25 |          1 | Station One   |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   1 | active   |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
  2024-09-01 10:00:00+00:00 |         25 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   1 | active   |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
  2024-09-01 10:00:00+00:00 |         25 |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   1 | active   |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
  2024-09-01 10:05:00+00:00 | NULL       |          2 | Station Two   |                 2 | NULL              |              200 | inactive       |                  10 |                  5 |  false   |   2 | inactive |       20 |     2000 |   20000 |       18.5 | NULL      |  false
  2024-09-01 10:05:00+00:00 | NULL       |          6 | Station Six   | NULL              | NULL              | NULL             | NULL           | NULL                | NULL               |  false   |   2 | inactive |       20 |     2000 |   20000 |       18.5 | NULL      |  false
  2024-09-01 10:10:00+00:00 |         30 |          1 | Station One   |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:10:00+00:00 |         30 |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:20:00+00:00 | NULL       |          1 | Station One   |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   5 | NULL     |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
  2024-09-01 10:20:00+00:00 | NULL       |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   5 | NULL     |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
  2024-09-01 10:20:00+00:00 | NULL       |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   5 | NULL     |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
  2024-09-01 10:25:00+00:00 | NULL       |          2 | Station Two   |                 2 | NULL              |              200 | inactive       |                  10 |                  5 |  false   |   6 | inactive |       60 |     6000 |   60000 |       17.5 |      17.5 |  false
  2024-09-01 10:25:00+00:00 | NULL       |          6 | Station Six   | NULL              | NULL              | NULL             | NULL           | NULL                | NULL               |  false   |   6 | inactive |       60 |     6000 |   60000 |       17.5 |      17.5 |  false
(13 rows)
> set hash_scan_mode = 1;
SET
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
ORDER BY f."time", s.station_sn;
                tree               |     field      |        description
-----------------------------------+----------------+-----------------------------
                                   | distributed    | true
                                   | vectorized     | false
  render                           |                |
   │                               | time           | "time"
   │                               | value          | value
   │                               | station_sn     | station_sn
   │                               | station_name   | station_name
   │                               | work_area_sn   | work_area_sn
   │                               | expected_state | expected_state
   │                               | standard_val   | standard_val
   │                               | adr            | adr
   │                               | state          | state
   │                               | second_val     | second_val
   └── sort                        |                |
        │                          | order          | +"time",+station_sn
        └── hash-join              |                |
             │                     | type           | inner
             │                     | equality       | (expected_state) = (state)
             ├── scan              |                |
             │                     | table          | station_info@primary
             │                     | spans          | FULL SCAN
             │                     | filter         | expected_state IS NOT NULL
             └── filter            |                |
                  │                | filter         | state IS NOT NULL
                  └── synchronizer |                |
                       └── ts scan |                |
                                   | ts-table       | firegases
                                   | access mode    | tableTableMeta
(28 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
ORDER BY f."time", s.station_sn;
            time            | value | station_sn | station_name  | work_area_sn | expected_state | standard_val | adr  |  state   | second_val
----------------------------+-------+------------+---------------+--------------+----------------+--------------+------+----------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One   | adr1         | active         |         22.5 | adr1 | active   |       22.5
  2024-09-01 10:05:00+00:00 | NULL  | sn2        | Station Two   | NULL         | inactive       |           10 | adr2 | inactive | NULL
  2024-09-01 10:15:00+00:00 |    15 | sn3        | Station Three | adr3         | pending        |           35 | adr4 | pending  |         15
  2024-09-01 10:15:00+00:00 |    15 | sn4        | Station Four  | NULL         | pending        | NULL         | adr4 | pending  |         15
(4 rows)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state != 'pending' and f.state = s.expected_state
ORDER BY f."time";
             tree             |     field      |         description
------------------------------+----------------+------------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (expected_state) = (state)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             │                | filter         | expected_state != 'pending'
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
                              | tag filter[0]  | state != 'pending'
(27 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state != 'pending' and f.state = s.expected_state
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  |  state   | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+----------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active   |       22.5
  2024-09-01 10:05:00+00:00 | NULL  | sn2        | Station Two  | NULL         | inactive       |           10 | adr2 | inactive | NULL
(2 rows)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
ORDER BY f."time", s.station_sn;
             tree             |     field      |        description
------------------------------+----------------+-----------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time",+station_sn
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (expected_state) = (state)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
ORDER BY f."time", s.station_sn;
            time            | value | station_sn | station_name  | work_area_sn | expected_state | standard_val | adr  |  state   | second_val
----------------------------+-------+------------+---------------+--------------+----------------+--------------+------+----------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One   | adr1         | active         |         22.5 | adr1 | active   |       22.5
  2024-09-01 10:05:00+00:00 | NULL  | sn2        | Station Two   | NULL         | inactive       |           10 | adr2 | inactive | NULL
  2024-09-01 10:15:00+00:00 |    15 | sn3        | Station Three | adr3         | pending        |           35 | adr4 | pending  |         15
  2024-09-01 10:15:00+00:00 |    15 | sn4        | Station Four  | NULL         | pending        | NULL         | adr4 | pending  |         15
(4 rows)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.standard_val is not NULL AND f."value" = s.standard_val
ORDER BY f."time";
             tree             |     field      |       description
------------------------------+----------------+---------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (value) = (standard_val)
             ├── synchronizer |                |
             │    └── ts scan |                |
             │                | ts-table       | firegases
             │                | access mode    | tableTableMeta
             └── scan         |                |
                              | table          | station_info@primary
                              | spans          | FULL SCAN
                              | filter         | standard_val IS NOT NULL
(26 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.standard_val is not NULL AND f."value" = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" is not NULL AND f."value" = s.standard_val
ORDER BY f."time";
                tree               |        field        |       description
-----------------------------------+---------------------+---------------------------
                                   | distributed         | true
                                   | vectorized          | false
  render                           |                     |
   │                               | time                | "time"
   │                               | value               | value
   │                               | station_sn          | station_sn
   │                               | station_name        | station_name
   │                               | work_area_sn        | work_area_sn
   │                               | expected_state      | expected_state
   │                               | standard_val        | standard_val
   │                               | adr                 | adr
   │                               | state               | state
   │                               | second_val          | second_val
   └── sort                        |                     |
        │                          | order               | +"time"
        └── hash-join              |                     |
             │                     | type                | inner
             │                     | equality            | (standard_val) = (value)
             ├── scan              |                     |
             │                     | table               | station_info@primary
             │                     | spans               | FULL SCAN
             └── filter            |                     |
                  │                | filter              | value IS NOT NULL
                  └── synchronizer |                     |
                       └── ts scan |                     |
                                   | ts-table            | firegases
                                   | access mode         | tableTableMeta
                                   | block filter[value] | NOT NULL
(28 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" is not NULL AND f."value" = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" = s.standard_val
ORDER BY f."time";
             tree             |     field      |       description
------------------------------+----------------+---------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (standard_val) = (value)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.standard_val is not NULL AND f.second_val = s.standard_val
ORDER BY f."time";
             tree             |     field      |          description
------------------------------+----------------+--------------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (second_val) = (standard_val)
             ├── synchronizer |                |
             │    └── ts scan |                |
             │                | ts-table       | firegases
             │                | access mode    | tableTableMeta
             └── scan         |                |
                              | table          | station_info@primary
                              | spans          | FULL SCAN
                              | filter         | standard_val IS NOT NULL
(26 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.standard_val is not NULL AND f.second_val = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" is not NULL AND f.second_val = s.standard_val
ORDER BY f."time";
                tree               |        field        |          description
-----------------------------------+---------------------+--------------------------------
                                   | distributed         | true
                                   | vectorized          | false
  render                           |                     |
   │                               | time                | "time"
   │                               | value               | value
   │                               | station_sn          | station_sn
   │                               | station_name        | station_name
   │                               | work_area_sn        | work_area_sn
   │                               | expected_state      | expected_state
   │                               | standard_val        | standard_val
   │                               | adr                 | adr
   │                               | state               | state
   │                               | second_val          | second_val
   └── sort                        |                     |
        │                          | order               | +"time"
        └── hash-join              |                     |
             │                     | type                | inner
             │                     | equality            | (standard_val) = (second_val)
             ├── scan              |                     |
             │                     | table               | station_info@primary
             │                     | spans               | FULL SCAN
             └── filter            |                     |
                  │                | filter              | value IS NOT NULL
                  └── synchronizer |                     |
                       └── ts scan |                     |
                                   | ts-table            | firegases
                                   | access mode         | tableTableMeta
                                   | block filter[value] | NOT NULL
(28 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" is not NULL AND f.second_val = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.second_val = s.standard_val
ORDER BY f."time";
             tree             |     field      |          description
------------------------------+----------------+--------------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (standard_val) = (second_val)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.second_val = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
                  tree                  |    field     |        description
----------------------------------------+--------------+-----------------------------
                                        | distributed  | true
                                        | vectorized   | false
  sort                                  |              |
   │                                    | order        | +work_area_sn
   └── group                            |              |
        │                               | aggregate 0  | work_area_sn
        │                               | aggregate 1  | avg(value)
        │                               | aggregate 2  | avg(standard_val)
        │                               | aggregate 3  | sum(second_val)
        │                               | aggregate 4  | count(standard_val)
        │                               | aggregate 5  | count(state)
        │                               | aggregate 6  | count(station_name)
        │                               | group by     | work_area_sn
        └── render                      |              |
             │                          | value        | value
             │                          | state        | state
             │                          | second_val   | second_val
             │                          | station_name | station_name
             │                          | work_area_sn | work_area_sn
             │                          | standard_val | standard_val
             └── hash-join              |              |
                  │                     | type         | inner
                  │                     | equality     | (expected_state) = (state)
                  ├── scan              |              |
                  │                     | table        | station_info@primary
                  │                     | spans        | FULL SCAN
                  │                     | filter       | expected_state IS NOT NULL
                  └── filter            |              |
                       │                | filter       | state IS NOT NULL
                       └── synchronizer |              |
                            └── ts scan |              |
                                        | ts-table     | firegases
                                        | access mode  | tableTableMeta
(33 rows)
> SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
  work_area_sn | avg  | avg  | sum  | count | count | count
---------------+------+------+------+-------+-------+--------
  NULL         |   15 |   10 |   15 |     1 |     2 |     2
  adr1         | 22.5 | 22.5 | 22.5 |     1 |     1 |     1
  adr3         |   15 |   35 |   15 |     1 |     1 |     1
(3 rows)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
      AND f.adr = s.work_area_sn
ORDER BY f."time", s.station_sn;
             tree             |     field      |                  description
------------------------------+----------------+------------------------------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time",+station_sn
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (expected_state, work_area_sn) = (state, adr)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
      AND f.adr = s.work_area_sn
ORDER BY f."time", s.station_sn;
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.second_val + 5 = s.standard_val
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
                  tree                  |    field     |         description
----------------------------------------+--------------+------------------------------
                                        | distributed  | true
                                        | vectorized   | false
  sort                                  |              |
   │                                    | order        | +work_area_sn
   └── group                            |              |
        │                               | aggregate 0  | work_area_sn
        │                               | aggregate 1  | avg(value)
        │                               | aggregate 2  | avg(standard_val)
        │                               | aggregate 3  | sum(second_val)
        │                               | aggregate 4  | count(standard_val)
        │                               | aggregate 5  | count(state)
        │                               | aggregate 6  | count(station_name)
        │                               | group by     | work_area_sn
        └── render                      |              |
             │                          | value        | value
             │                          | state        | state
             │                          | second_val   | second_val
             │                          | station_name | station_name
             │                          | work_area_sn | work_area_sn
             │                          | standard_val | standard_val
             └── hash-join              |              |
                  │                     | type         | inner
                  │                     | equality     | (column11) = (standard_val)
                  ├── render            |              |
                  │    │                | column11     | second_val + 5.0
                  │    │                | value        | value
                  │    │                | state        | state
                  │    │                | second_val   | second_val
                  │    └── synchronizer |              |
                  │         └── ts scan |              |
                  │                     | ts-table     | firegases
                  │                     | access mode  | tableTableMeta
                  └── scan              |              |
                                        | table        | station_info@primary
                                        | spans        | FULL SCAN
                                        | filter       | expected_state IS NOT NULL
(36 rows)
> SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.second_val + 5 = s.standard_val
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
  work_area_sn | avg | avg | sum | count | count | count
---------------+-----+-----+-----+-------+-------+--------
  adr3         |  30 |  35 |  30 |     1 |     0 |     1
(1 row)
> explain SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.second_val = s.standard_val and f.state = s.expected_state
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
                  tree                  |    field     |                     description
----------------------------------------+--------------+-------------------------------------------------------
                                        | distributed  | true
                                        | vectorized   | false
  group                                 |              |
   │                                    | aggregate 0  | work_area_sn
   │                                    | aggregate 1  | avg(value)
   │                                    | aggregate 2  | avg(standard_val)
   │                                    | aggregate 3  | sum(second_val)
   │                                    | aggregate 4  | count(standard_val)
   │                                    | aggregate 5  | count(state)
   │                                    | aggregate 6  | count(station_name)
   │                                    | group by     | work_area_sn
   │                                    | ordered      | +work_area_sn
   └── render                           |              |
        │                               | value        | value
        │                               | state        | state
        │                               | second_val   | second_val
        │                               | station_name | station_name
        │                               | work_area_sn | work_area_sn
        │                               | standard_val | standard_val
        └── sort                        |              |
             │                          | order        | +work_area_sn
             └── hash-join              |              |
                  │                     | type         | inner
                  │                     | equality     | (standard_val, expected_state) = (second_val, state)
                  ├── scan              |              |
                  │                     | table        | station_info@primary
                  │                     | spans        | FULL SCAN
                  │                     | filter       | expected_state IS NOT NULL
                  └── filter            |              |
                       │                | filter       | state IS NOT NULL
                       └── synchronizer |              |
                            └── ts scan |              |
                                        | ts-table     | firegases
                                        | access mode  | tableTableMeta
(34 rows)
> SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.second_val = s.standard_val and f.state = s.expected_state
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
  work_area_sn | avg  | avg  | sum  | count | count | count
---------------+------+------+------+-------+-------+--------
  adr1         | 22.5 | 22.5 | 22.5 |     1 |     1 |     1
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE s.expected_state is not NULL and f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.work_area_sn = ts.adr
ORDER BY ts."value";
                       tree                       |       field        |        description
--------------------------------------------------+--------------------+-----------------------------
                                                  | distributed        | true
                                                  | vectorized         | false
  render                                          |                    |
   │                                              | time               | "time"
   │                                              | value              | value
   │                                              | work_area_sn       | work_area_sn
   │                                              | avg                | avg
   │                                              | avg                | avg
   │                                              | sum                | sum
   │                                              | count              | count
   │                                              | count              | count
   │                                              | count              | count
   │                                              | adr                | adr
   │                                              | state              | state
   │                                              | second_val         | second_val
   └── sort                                       |                    |
        │                                         | order              | +value
        └── hash-join                             |                    |
             │                                    | type               | inner
             │                                    | equality           | (adr) = (work_area_sn)
             │                                    | right cols are key |
             ├── synchronizer                     |                    |
             │    └── ts scan                     |                    |
             │                                    | ts-table           | firegases
             │                                    | access mode        | tableTableMeta
             └── group                            |                    |
                  │                               | aggregate 0        | work_area_sn
                  │                               | aggregate 1        | avg(value)
                  │                               | aggregate 2        | avg(standard_val)
                  │                               | aggregate 3        | sum(second_val)
                  │                               | aggregate 4        | count(standard_val)
                  │                               | aggregate 5        | count(state)
                  │                               | aggregate 6        | count(station_name)
                  │                               | group by           | work_area_sn
                  └── render                      |                    |
                       │                          | value              | value
                       │                          | state              | state
                       │                          | second_val         | second_val
                       │                          | station_name       | station_name
                       │                          | work_area_sn       | work_area_sn
                       │                          | standard_val       | standard_val
                       └── hash-join              |                    |
                            │                     | type               | inner
                            │                     | equality           | (expected_state) = (state)
                            ├── scan              |                    |
                            │                     | table              | station_info@primary
                            │                     | spans              | FULL SCAN
                            │                     | filter             | expected_state IS NOT NULL
                            └── filter            |                    |
                                 │                | filter             | state IS NOT NULL
                                 └── synchronizer |                    |
                                      └── ts scan |                    |
                                                  | ts-table           | firegases
                                                  | access mode        | tableTableMeta
(54 rows)
> SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE s.expected_state is not NULL and f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.work_area_sn = ts.adr
ORDER BY ts."value";
            time            | value | work_area_sn | avg  | avg  | sum  | count | count | count | adr  | state  | second_val
----------------------------+-------+--------------+------+------+------+-------+-------+-------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | adr1         | 22.5 | 22.5 | 22.5 |     1 |     1 |     1 | adr1 | active |       22.5
  2024-09-01 10:10:00+00:00 |    30 | adr3         |   15 |   35 |   15 |     1 |     1 |     1 | adr3 | NULL   |         30
(2 rows)
> explain SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value") as value_avg,
      AVG(s.standard_val) as standard_avg,
      SUM(f.second_val) as second_avg,
      COUNT(s.standard_val) as standar_count,
      COUNT(f.state) as state_count,
      COUNT(s.station_name) as station_count
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.standard_avg= ts.second_val;
                  tree                  |     field     |        description
----------------------------------------+---------------+-----------------------------
                                        | distributed   | true
                                        | vectorized    | false
  render                                |               |
   │                                    | time          | "time"
   │                                    | value         | value
   │                                    | work_area_sn  | work_area_sn
   │                                    | value_avg     | avg
   │                                    | standard_avg  | avg
   │                                    | second_avg    | sum
   │                                    | standar_count | count
   │                                    | state_count   | count
   │                                    | station_count | count
   │                                    | adr           | adr
   │                                    | state         | state
   │                                    | second_val    | second_val
   └── hash-join                        |               |
        │                               | type          | inner
        │                               | equality      | (second_val) = (avg)
        ├── synchronizer                |               |
        │    └── ts scan                |               |
        │                               | ts-table      | firegases
        │                               | access mode   | tableTableMeta
        └── group                       |               |
             │                          | aggregate 0   | work_area_sn
             │                          | aggregate 1   | avg(value)
             │                          | aggregate 2   | avg(standard_val)
             │                          | aggregate 3   | sum(second_val)
             │                          | aggregate 4   | count(standard_val)
             │                          | aggregate 5   | count(state)
             │                          | aggregate 6   | count(station_name)
             │                          | group by      | work_area_sn
             └── render                 |               |
                  │                     | value         | value
                  │                     | state         | state
                  │                     | second_val    | second_val
                  │                     | station_name  | station_name
                  │                     | work_area_sn  | work_area_sn
                  │                     | standard_val  | standard_val
                  └── hash-join         |               |
                       │                | type          | inner
                       │                | equality      | (expected_state) = (state)
                       ├── scan         |               |
                       │                | table         | station_info@primary
                       │                | spans         | FULL SCAN
                       └── synchronizer |               |
                            └── ts scan |               |
                                        | ts-table      | firegases
                                        | access mode   | tableTableMeta
(48 rows)
> SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value") as value_avg,
      AVG(s.standard_val) as standard_avg,
      SUM(f.second_val) as second_avg,
      COUNT(s.standard_val) as standar_count,
      COUNT(f.state) as state_count,
      COUNT(s.station_name) as station_count
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.standard_avg= ts.second_val;
            time            | value | work_area_sn | value_avg | standard_avg | second_avg | standar_count | state_count | station_count | adr  | state  | second_val
----------------------------+-------+--------------+-----------+--------------+------------+---------------+-------------+---------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | adr1         |      22.5 |         22.5 |       22.5 |             1 |           1 |             1 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value") as value_avg,
      AVG(s.standard_val) as standard_avg,
      SUM(f.second_val) as second_avg,
      COUNT(s.standard_val) as standar_count,
      COUNT(f.state) as state_count,
      COUNT(s.station_name) as station_count
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.standard_avg + 5 = ts.second_val;
                     tree                    |     field     |        description
---------------------------------------------+---------------+-----------------------------
                                             | distributed   | true
                                             | vectorized    | false
  render                                     |               |
   │                                         | time          | "time"
   │                                         | value         | value
   │                                         | work_area_sn  | work_area_sn
   │                                         | value_avg     | avg
   │                                         | standard_avg  | avg
   │                                         | second_avg    | sum
   │                                         | standar_count | count
   │                                         | state_count   | count
   │                                         | station_count | count
   │                                         | adr           | adr
   │                                         | state         | state
   │                                         | second_val    | second_val
   └── hash-join                             |               |
        │                                    | type          | inner
        │                                    | equality      | (second_val) = (column22)
        ├── synchronizer                     |               |
        │    └── ts scan                     |               |
        │                                    | ts-table      | firegases
        │                                    | access mode   | tableTableMeta
        └── render                           |               |
             │                               | column22      | avg + 5.0
             │                               | work_area_sn  | work_area_sn
             │                               | avg           | avg
             │                               | avg           | avg
             │                               | sum           | sum
             │                               | count         | count
             │                               | count         | count
             │                               | count         | count
             └── group                       |               |
                  │                          | aggregate 0   | work_area_sn
                  │                          | aggregate 1   | avg(value)
                  │                          | aggregate 2   | avg(standard_val)
                  │                          | aggregate 3   | sum(second_val)
                  │                          | aggregate 4   | count(standard_val)
                  │                          | aggregate 5   | count(state)
                  │                          | aggregate 6   | count(station_name)
                  │                          | group by      | work_area_sn
                  └── render                 |               |
                       │                     | value         | value
                       │                     | state         | state
                       │                     | second_val    | second_val
                       │                     | station_name  | station_name
                       │                     | work_area_sn  | work_area_sn
                       │                     | standard_val  | standard_val
                       └── hash-join         |               |
                            │                | type          | inner
                            │                | equality      | (expected_state) = (state)
                            ├── scan         |               |
                            │                | table         | station_info@primary
                            │                | spans         | FULL SCAN
                            └── synchronizer |               |
                                 └── ts scan |               |
                                             | ts-table      | firegases
                                             | access mode   | tableTableMeta
(57 rows)
> SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value") as value_avg,
      AVG(s.standard_val) as standard_avg,
      SUM(f.second_val) as second_avg,
      COUNT(s.standard_val) as standar_count,
      COUNT(f.state) as state_count,
      COUNT(s.station_name) as station_count
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.standard_avg + 5 = ts.second_val;
            time            | value | work_area_sn | value_avg | standard_avg | second_avg | standar_count | state_count | station_count | adr  |  state  | second_val
----------------------------+-------+--------------+-----------+--------------+------------+---------------+-------------+---------------+------+---------+-------------
  2024-09-01 10:15:00+00:00 |    15 | NULL         |        15 |           10 |         15 |             1 |           2 |             2 | adr4 | pending |         15
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
    (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s,
        my_timeseries_db.firegases fire
    WHERE s.expected_state = fire.state
    GROUP BY expected_state) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
                  tree                  |       field        |                 description
----------------------------------------+--------------------+----------------------------------------------
                                        | distributed        | true
                                        | vectorized         | false
  render                                |                    |
   │                                    | time               | "time"
   │                                    | value              | value
   │                                    | expected_state     | expected_state
   │                                    | standard_avg       | avg
   │                                    | adr                | adr
   │                                    | state              | state
   │                                    | second_val         | second_val
   └── hash-join                        |                    |
        │                               | type               | inner
        │                               | equality           | (second_val, state) = (avg, expected_state)
        │                               | right cols are key |
        ├── synchronizer                |                    |
        │    └── ts scan                |                    |
        │                               | ts-table           | firegases
        │                               | access mode        | tableTableMeta
        └── group                       |                    |
             │                          | aggregate 0        | expected_state
             │                          | aggregate 1        | avg(standard_val)
             │                          | group by           | expected_state
             └── render                 |                    |
                  │                     | expected_state     | expected_state
                  │                     | standard_val       | standard_val
                  └── hash-join         |                    |
                       │                | type               | inner
                       │                | equality           | (expected_state) = (state)
                       ├── scan         |                    |
                       │                | table              | station_info@primary
                       │                | spans              | FULL SCAN
                       └── synchronizer |                    |
                            └── ts scan |                    |
                                        | ts-table           | firegases
                                        | access mode        | tableTableMeta
(35 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
    (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s,
        my_timeseries_db.firegases fire
    WHERE s.expected_state = fire.state
    GROUP BY expected_state) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
            time            | value | expected_state | standard_avg | adr  | state  | second_val
----------------------------+-------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
    ((SELECT expected_state, standard_val as standard_avg
    FROM my_relation_db.station_info)
    UNION (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s,
        my_timeseries_db.firegases fire
    WHERE s.expected_state = fire.state
    GROUP BY expected_state)) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
                     tree                    |       field       |                     description
---------------------------------------------+-------------------+-------------------------------------------------------
                                             | distributed       | true
                                             | vectorized        | false
  render                                     |                   |
   │                                         | time              | "time"
   │                                         | value             | value
   │                                         | expected_state    | expected_state
   │                                         | standard_avg      | standard_val
   │                                         | adr               | adr
   │                                         | state             | state
   │                                         | second_val        | second_val
   └── hash-join                             |                   |
        │                                    | type              | inner
        │                                    | equality          | (standard_val, expected_state) = (second_val, state)
        │                                    | left cols are key |
        ├── union                            |                   |
        │    ├── group                       |                   |
        │    │    │                          | aggregate 0       | expected_state
        │    │    │                          | aggregate 1       | avg(standard_val)
        │    │    │                          | group by          | expected_state
        │    │    └── render                 |                   |
        │    │         │                     | expected_state    | expected_state
        │    │         │                     | standard_val      | standard_val
        │    │         └── hash-join         |                   |
        │    │              │                | type              | inner
        │    │              │                | equality          | (expected_state) = (state)
        │    │              ├── scan         |                   |
        │    │              │                | table             | station_info@primary
        │    │              │                | spans             | FULL SCAN
        │    │              └── synchronizer |                   |
        │    │                   └── ts scan |                   |
        │    │                               | ts-table          | firegases
        │    │                               | access mode       | tableTableMeta
        │    └── scan                        |                   |
        │                                    | table             | station_info@primary
        │                                    | spans             | FULL SCAN
        └── synchronizer                     |                   |
             └── ts scan                     |                   |
                                             | ts-table          | firegases
                                             | access mode       | tableTableMeta
(39 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
    ((SELECT expected_state, standard_val as standard_avg
    FROM my_relation_db.station_info)
    UNION (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s,
        my_timeseries_db.firegases fire
    WHERE s.expected_state = fire.state
    GROUP BY expected_state)) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
            time            | value | expected_state | standard_avg | adr  | state  | second_val
----------------------------+-------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
    ((SELECT expected_state, standard_val as standard_avg
    FROM my_relation_db.station_info)
    UNION (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s
    RIGHT JOIN my_timeseries_db.firegases fire
    ON s.expected_state = fire.state
    GROUP BY expected_state)) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
                     tree                    |       field       |                     description
---------------------------------------------+-------------------+-------------------------------------------------------
                                             | distributed       | true
                                             | vectorized        | false
  render                                     |                   |
   │                                         | time              | "time"
   │                                         | value             | value
   │                                         | expected_state    | expected_state
   │                                         | standard_avg      | standard_val
   │                                         | adr               | adr
   │                                         | state             | state
   │                                         | second_val        | second_val
   └── hash-join                             |                   |
        │                                    | type              | inner
        │                                    | equality          | (standard_val, expected_state) = (second_val, state)
        │                                    | left cols are key |
        ├── union                            |                   |
        │    ├── group                       |                   |
        │    │    │                          | aggregate 0       | expected_state
        │    │    │                          | aggregate 1       | avg(standard_val)
        │    │    │                          | group by          | expected_state
        │    │    └── render                 |                   |
        │    │         │                     | expected_state    | expected_state
        │    │         │                     | standard_val      | standard_val
        │    │         └── hash-join         |                   |
        │    │              │                | type              | right outer
        │    │              │                | equality          | (expected_state) = (state)
        │    │              ├── scan         |                   |
        │    │              │                | table             | station_info@primary
        │    │              │                | spans             | FULL SCAN
        │    │              └── synchronizer |                   |
        │    │                   └── ts scan |                   |
        │    │                               | ts-table          | firegases
        │    │                               | access mode       | tableTableMeta
        │    └── scan                        |                   |
        │                                    | table             | station_info@primary
        │                                    | spans             | FULL SCAN
        └── synchronizer                     |                   |
             └── ts scan                     |                   |
                                             | ts-table          | firegases
                                             | access mode       | tableTableMeta
(39 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
    ((SELECT expected_state, standard_val as standard_avg
    FROM my_relation_db.station_info)
    UNION (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s
    RIGHT JOIN my_timeseries_db.firegases fire
    ON s.expected_state = fire.state
    GROUP BY expected_state)) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
            time            | value | expected_state | standard_avg | adr  | state  | second_val
----------------------------+-------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | active         |         22.5 | adr1 | active |       22.5
(1 row)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.int2_val = s.work_area_sn_int2
ORDER BY f."time";
             tree             |        field        |           description
------------------------------+---------------------+-----------------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (int2_val) = (work_area_sn_int2)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.int2_val = s.work_area_sn_int2
ORDER BY f."time";
            time            | second_val | station_sn | station_name | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr | state  | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+--------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+--------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:15:00+00:00 |         15 |          5 | Station Five |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   4 | active |       40 | NULL     |   40000 | NULL       |        15 |   NULL
(1 row)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.int4_val = s.work_area_sn_int4
ORDER BY f."time";
             tree             |        field        |           description
------------------------------+---------------------+-----------------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (int4_val) = (work_area_sn_int4)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.int4_val = s.work_area_sn_int4
ORDER BY f."time";
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state   | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+----------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:25:00+00:00 | NULL       |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   6 | inactive |       60 |     6000 |   60000 |       17.5 |      17.5 |  false
(2 rows)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.adr = s.station_sn
ORDER BY f."time";
             tree             |        field        |     description
------------------------------+---------------------+-----------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (adr) = (station_sn)
             │                | right cols are key  |
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(35 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.adr = s.station_sn
ORDER BY f."time";
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state   | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+----------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:00:00+00:00 |         25 |          1 | Station One   |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   1 | active   |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
  2024-09-01 10:05:00+00:00 | NULL       |          2 | Station Two   |                 2 | NULL              |              200 | inactive       |                  10 |                  5 |  false   |   2 | inactive |       20 |     2000 |   20000 |       18.5 | NULL      |  false
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:15:00+00:00 |         15 |          4 | Station Four  | NULL              | NULL              |            40000 | pending        | NULL                |                 15 |   NULL   |   4 | active   |       40 | NULL     |   40000 | NULL       |        15 |   NULL
  2024-09-01 10:20:00+00:00 | NULL       |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   5 | NULL     |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
  2024-09-01 10:25:00+00:00 | NULL       |          6 | Station Six   | NULL              | NULL              | NULL             | NULL           | NULL                | NULL               |  false   |   6 | inactive |       60 |     6000 |   60000 |       17.5 |      17.5 |  false
(6 rows)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.float4_val = s.standard_val_float4
ORDER BY f."time";
             tree             |        field        |             description
------------------------------+---------------------+---------------------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (float4_val) = (standard_val_float4)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.float4_val = s.standard_val_float4
ORDER BY f."time";
            time            | second_val | station_sn | station_name | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr | state  | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+--------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+--------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:00:00+00:00 |         25 |          1 | Station One  |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   1 | active |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
(1 row)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.float_val = s.standard_val_float
ORDER BY f."time";
             tree             |        field        |            description
------------------------------+---------------------+-------------------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (float_val) = (standard_val_float)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.float_val = s.standard_val_float
ORDER BY f."time";
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state  | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+---------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:15:00+00:00 |         15 |          4 | Station Four  | NULL              | NULL              |            40000 | pending        | NULL                |                 15 |   NULL   |   4 | active  |       40 | NULL     |   40000 | NULL       |        15 |   NULL
  2024-09-01 10:20:00+00:00 | NULL       |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   5 | NULL    |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
(3 rows)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f,
     my_relation_db_v2.station_info s
WHERE f.second_val IS NOT NULL
  AND s.standard_val_float IS NOT NULL
  AND f.second_val = s.standard_val_float
ORDER BY f."time";
                tree               |          field           |             description
-----------------------------------+--------------------------+--------------------------------------
                                   | distributed              | true
                                   | vectorized               | false
  render                           |                          |
   │                               | time                     | "time"
   │                               | second_val               | second_val
   │                               | station_sn               | station_sn
   │                               | station_name             | station_name
   │                               | work_area_sn_int2        | work_area_sn_int2
   │                               | work_area_sn_int4        | work_area_sn_int4
   │                               | work_area_sn_int         | work_area_sn_int
   │                               | expected_state           | expected_state
   │                               | standard_val_float4      | standard_val_float4
   │                               | standard_val_float       | standard_val_float
   │                               | bool_val                 | bool_val
   │                               | adr                      | adr
   │                               | state                    | state
   │                               | int2_val                 | int2_val
   │                               | int4_val                 | int4_val
   │                               | int_val                  | int_val
   │                               | float4_val               | float4_val
   │                               | float_val                | float_val
   │                               | bool_val                 | bool_val
   └── sort                        |                          |
        │                          | order                    | +"time"
        └── hash-join              |                          |
             │                     | type                     | inner
             │                     | equality                 | (standard_val_float) = (second_val)
             ├── scan              |                          |
             │                     | table                    | station_info@primary
             │                     | spans                    | FULL SCAN
             │                     | filter                   | standard_val_float IS NOT NULL
             └── filter            |                          |
                  │                | filter                   | second_val IS NOT NULL
                  └── synchronizer |                          |
                       └── ts scan |                          |
                                   | ts-table                 | firegases
                                   | access mode              | tableTableMeta
                                   | block filter[second_val] | NOT NULL
(38 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f,
     my_relation_db_v2.station_info s
WHERE f.second_val IS NOT NULL
  AND s.standard_val_float IS NOT NULL
  AND f.second_val = s.standard_val_float
ORDER BY f."time";
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state  | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+---------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:15:00+00:00 |         15 |          4 | Station Four  | NULL              | NULL              |            40000 | pending        | NULL                |                 15 |   NULL   |   4 | active  |       40 | NULL     |   40000 | NULL       |        15 |   NULL
(2 rows)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.bool_val = s.bool_val
ORDER BY f."time";
             tree             |        field        |       description
------------------------------+---------------------+--------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (bool_val) = (bool_val)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.bool_val = s.bool_val
ORDER BY f."time", s.station_sn, f.float_val, f.int_val, f.adr;
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state   | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+----------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:00:00+00:00 |         25 |          1 | Station One   |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   1 | active   |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
  2024-09-01 10:00:00+00:00 |         25 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   1 | active   |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
  2024-09-01 10:00:00+00:00 |         25 |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   1 | active   |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
  2024-09-01 10:05:00+00:00 | NULL       |          2 | Station Two   |                 2 | NULL              |              200 | inactive       |                  10 |                  5 |  false   |   2 | inactive |       20 |     2000 |   20000 |       18.5 | NULL      |  false
  2024-09-01 10:05:00+00:00 | NULL       |          6 | Station Six   | NULL              | NULL              | NULL             | NULL           | NULL                | NULL               |  false   |   2 | inactive |       20 |     2000 |   20000 |       18.5 | NULL      |  false
  2024-09-01 10:10:00+00:00 |         30 |          1 | Station One   |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:10:00+00:00 |         30 |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:20:00+00:00 | NULL       |          1 | Station One   |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   5 | NULL     |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
  2024-09-01 10:20:00+00:00 | NULL       |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   5 | NULL     |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
  2024-09-01 10:20:00+00:00 | NULL       |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   5 | NULL     |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
  2024-09-01 10:25:00+00:00 | NULL       |          2 | Station Two   |                 2 | NULL              |              200 | inactive       |                  10 |                  5 |  false   |   6 | inactive |       60 |     6000 |   60000 |       17.5 |      17.5 |  false
  2024-09-01 10:25:00+00:00 | NULL       |          6 | Station Six   | NULL              | NULL              | NULL             | NULL           | NULL                | NULL               |  false   |   6 | inactive |       60 |     6000 |   60000 |       17.5 |      17.5 |  false
(13 rows)
> set hash_scan_mode = 2;
SET
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
ORDER BY f."time", s.station_sn;
                tree               |     field      |        description
-----------------------------------+----------------+-----------------------------
                                   | distributed    | true
                                   | vectorized     | false
  render                           |                |
   │                               | time           | "time"
   │                               | value          | value
   │                               | station_sn     | station_sn
   │                               | station_name   | station_name
   │                               | work_area_sn   | work_area_sn
   │                               | expected_state | expected_state
   │                               | standard_val   | standard_val
   │                               | adr            | adr
   │                               | state          | state
   │                               | second_val     | second_val
   └── sort                        |                |
        │                          | order          | +"time",+station_sn
        └── hash-join              |                |
             │                     | type           | inner
             │                     | equality       | (expected_state) = (state)
             ├── scan              |                |
             │                     | table          | station_info@primary
             │                     | spans          | FULL SCAN
             │                     | filter         | expected_state IS NOT NULL
             └── filter            |                |
                  │                | filter         | state IS NOT NULL
                  └── synchronizer |                |
                       └── ts scan |                |
                                   | ts-table       | firegases
                                   | access mode    | tableTableMeta
(28 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
ORDER BY f."time", s.station_sn;
            time            | value | station_sn | station_name  | work_area_sn | expected_state | standard_val | adr  |  state   | second_val
----------------------------+-------+------------+---------------+--------------+----------------+--------------+------+----------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One   | adr1         | active         |         22.5 | adr1 | active   |       22.5
  2024-09-01 10:05:00+00:00 | NULL  | sn2        | Station Two   | NULL         | inactive       |           10 | adr2 | inactive | NULL
  2024-09-01 10:15:00+00:00 |    15 | sn3        | Station Three | adr3         | pending        |           35 | adr4 | pending  |         15
  2024-09-01 10:15:00+00:00 |    15 | sn4        | Station Four  | NULL         | pending        | NULL         | adr4 | pending  |         15
(4 rows)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
      AND f.adr = s.work_area_sn
ORDER BY f."time", s.station_sn;
             tree             |     field      |                  description
------------------------------+----------------+------------------------------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time",+station_sn
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (expected_state, work_area_sn) = (state, adr)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
      AND f.adr = s.work_area_sn
ORDER BY f."time", s.station_sn;
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.adr = s.station_sn
ORDER BY f."time";
             tree             |        field        |     description
------------------------------+---------------------+-----------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (adr) = (station_sn)
             │                | right cols are key  |
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(35 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.adr = s.station_sn
ORDER BY f."time";
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state   | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+----------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:00:00+00:00 |         25 |          1 | Station One   |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   1 | active   |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
  2024-09-01 10:05:00+00:00 | NULL       |          2 | Station Two   |                 2 | NULL              |              200 | inactive       |                  10 |                  5 |  false   |   2 | inactive |       20 |     2000 |   20000 |       18.5 | NULL      |  false
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:15:00+00:00 |         15 |          4 | Station Four  | NULL              | NULL              |            40000 | pending        | NULL                |                 15 |   NULL   |   4 | active   |       40 | NULL     |   40000 | NULL       |        15 |   NULL
  2024-09-01 10:20:00+00:00 | NULL       |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   5 | NULL     |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
  2024-09-01 10:25:00+00:00 | NULL       |          6 | Station Six   | NULL              | NULL              | NULL             | NULL           | NULL                | NULL               |  false   |   6 | inactive |       60 |     6000 |   60000 |       17.5 |      17.5 |  false
(6 rows)
> EXPLAIN SELECT *
FROM my_timeseries_db.firegases f, my_relation_db.station_info s
WHERE f.adr = s.work_area_sn
ORDER BY f."time";
             tree             |     field      |      description
------------------------------+----------------+-------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (work_area_sn) = (adr)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f, my_relation_db.station_info s
WHERE f.adr = s.work_area_sn
ORDER BY f."time";
            time            | value | station_sn | station_name  | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+---------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One   | adr1         | active         |         22.5 | adr1 | active |       22.5
  2024-09-01 10:10:00+00:00 |    30 | sn3        | Station Three | adr3         | pending        |           35 | adr3 | NULL   |         30
(2 rows)
> set hash_scan_mode = 3;
SET
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
ORDER BY f."time", s.station_sn;
                tree               |     field      |        description
-----------------------------------+----------------+-----------------------------
                                   | distributed    | true
                                   | vectorized     | false
  render                           |                |
   │                               | time           | "time"
   │                               | value          | value
   │                               | station_sn     | station_sn
   │                               | station_name   | station_name
   │                               | work_area_sn   | work_area_sn
   │                               | expected_state | expected_state
   │                               | standard_val   | standard_val
   │                               | adr            | adr
   │                               | state          | state
   │                               | second_val     | second_val
   └── sort                        |                |
        │                          | order          | +"time",+station_sn
        └── hash-join              |                |
             │                     | type           | inner
             │                     | equality       | (expected_state) = (state)
             ├── scan              |                |
             │                     | table          | station_info@primary
             │                     | spans          | FULL SCAN
             │                     | filter         | expected_state IS NOT NULL
             └── filter            |                |
                  │                | filter         | state IS NOT NULL
                  └── synchronizer |                |
                       └── ts scan |                |
                                   | ts-table       | firegases
                                   | access mode    | tableTableMeta
(28 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
ORDER BY f."time", s.station_sn;
            time            | value | station_sn | station_name  | work_area_sn | expected_state | standard_val | adr  |  state   | second_val
----------------------------+-------+------------+---------------+--------------+----------------+--------------+------+----------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One   | adr1         | active         |         22.5 | adr1 | active   |       22.5
  2024-09-01 10:05:00+00:00 | NULL  | sn2        | Station Two   | NULL         | inactive       |           10 | adr2 | inactive | NULL
  2024-09-01 10:15:00+00:00 |    15 | sn3        | Station Three | adr3         | pending        |           35 | adr4 | pending  |         15
  2024-09-01 10:15:00+00:00 |    15 | sn4        | Station Four  | NULL         | pending        | NULL         | adr4 | pending  |         15
(4 rows)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state != 'pending' and f.state = s.expected_state
ORDER BY f."time";
             tree             |     field      |         description
------------------------------+----------------+------------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (expected_state) = (state)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             │                | filter         | expected_state != 'pending'
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
                              | tag filter[0]  | state != 'pending'
(27 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state != 'pending' and f.state = s.expected_state
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  |  state   | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+----------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active   |       22.5
  2024-09-01 10:05:00+00:00 | NULL  | sn2        | Station Two  | NULL         | inactive       |           10 | adr2 | inactive | NULL
(2 rows)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
ORDER BY f."time", s.station_sn;
             tree             |     field      |        description
------------------------------+----------------+-----------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time",+station_sn
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (expected_state) = (state)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
ORDER BY f."time", s.station_sn;
            time            | value | station_sn | station_name  | work_area_sn | expected_state | standard_val | adr  |  state   | second_val
----------------------------+-------+------------+---------------+--------------+----------------+--------------+------+----------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One   | adr1         | active         |         22.5 | adr1 | active   |       22.5
  2024-09-01 10:05:00+00:00 | NULL  | sn2        | Station Two   | NULL         | inactive       |           10 | adr2 | inactive | NULL
  2024-09-01 10:15:00+00:00 |    15 | sn3        | Station Three | adr3         | pending        |           35 | adr4 | pending  |         15
  2024-09-01 10:15:00+00:00 |    15 | sn4        | Station Four  | NULL         | pending        | NULL         | adr4 | pending  |         15
(4 rows)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.standard_val is not NULL AND f."value" = s.standard_val
ORDER BY f."time";
             tree             |     field      |       description
------------------------------+----------------+---------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (value) = (standard_val)
             ├── synchronizer |                |
             │    └── ts scan |                |
             │                | ts-table       | firegases
             │                | access mode    | tableTableMeta
             └── scan         |                |
                              | table          | station_info@primary
                              | spans          | FULL SCAN
                              | filter         | standard_val IS NOT NULL
(26 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.standard_val is not NULL AND f."value" = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" is not NULL AND f."value" = s.standard_val
ORDER BY f."time";
                tree               |        field        |       description
-----------------------------------+---------------------+---------------------------
                                   | distributed         | true
                                   | vectorized          | false
  render                           |                     |
   │                               | time                | "time"
   │                               | value               | value
   │                               | station_sn          | station_sn
   │                               | station_name        | station_name
   │                               | work_area_sn        | work_area_sn
   │                               | expected_state      | expected_state
   │                               | standard_val        | standard_val
   │                               | adr                 | adr
   │                               | state               | state
   │                               | second_val          | second_val
   └── sort                        |                     |
        │                          | order               | +"time"
        └── hash-join              |                     |
             │                     | type                | inner
             │                     | equality            | (standard_val) = (value)
             ├── scan              |                     |
             │                     | table               | station_info@primary
             │                     | spans               | FULL SCAN
             └── filter            |                     |
                  │                | filter              | value IS NOT NULL
                  └── synchronizer |                     |
                       └── ts scan |                     |
                                   | ts-table            | firegases
                                   | access mode         | tableTableMeta
                                   | block filter[value] | NOT NULL
(28 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" is not NULL AND f."value" = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" = s.standard_val
ORDER BY f."time";
             tree             |     field      |       description
------------------------------+----------------+---------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (standard_val) = (value)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.standard_val is not NULL AND f.second_val = s.standard_val
ORDER BY f."time";
             tree             |     field      |          description
------------------------------+----------------+--------------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (second_val) = (standard_val)
             ├── synchronizer |                |
             │    └── ts scan |                |
             │                | ts-table       | firegases
             │                | access mode    | tableTableMeta
             └── scan         |                |
                              | table          | station_info@primary
                              | spans          | FULL SCAN
                              | filter         | standard_val IS NOT NULL
(26 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.standard_val is not NULL AND f.second_val = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" is not NULL AND f.second_val = s.standard_val
ORDER BY f."time";
                tree               |        field        |          description
-----------------------------------+---------------------+--------------------------------
                                   | distributed         | true
                                   | vectorized          | false
  render                           |                     |
   │                               | time                | "time"
   │                               | value               | value
   │                               | station_sn          | station_sn
   │                               | station_name        | station_name
   │                               | work_area_sn        | work_area_sn
   │                               | expected_state      | expected_state
   │                               | standard_val        | standard_val
   │                               | adr                 | adr
   │                               | state               | state
   │                               | second_val          | second_val
   └── sort                        |                     |
        │                          | order               | +"time"
        └── hash-join              |                     |
             │                     | type                | inner
             │                     | equality            | (standard_val) = (second_val)
             ├── scan              |                     |
             │                     | table               | station_info@primary
             │                     | spans               | FULL SCAN
             └── filter            |                     |
                  │                | filter              | value IS NOT NULL
                  └── synchronizer |                     |
                       └── ts scan |                     |
                                   | ts-table            | firegases
                                   | access mode         | tableTableMeta
                                   | block filter[value] | NOT NULL
(28 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f."value" is not NULL AND f.second_val = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.second_val = s.standard_val
ORDER BY f."time";
             tree             |     field      |          description
------------------------------+----------------+--------------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time"
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (standard_val) = (second_val)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.second_val = s.standard_val
ORDER BY f."time";
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
                  tree                  |    field     |        description
----------------------------------------+--------------+-----------------------------
                                        | distributed  | true
                                        | vectorized   | false
  sort                                  |              |
   │                                    | order        | +work_area_sn
   └── group                            |              |
        │                               | aggregate 0  | work_area_sn
        │                               | aggregate 1  | avg(value)
        │                               | aggregate 2  | avg(standard_val)
        │                               | aggregate 3  | sum(second_val)
        │                               | aggregate 4  | count(standard_val)
        │                               | aggregate 5  | count(state)
        │                               | aggregate 6  | count(station_name)
        │                               | group by     | work_area_sn
        └── render                      |              |
             │                          | value        | value
             │                          | state        | state
             │                          | second_val   | second_val
             │                          | station_name | station_name
             │                          | work_area_sn | work_area_sn
             │                          | standard_val | standard_val
             └── hash-join              |              |
                  │                     | type         | inner
                  │                     | equality     | (expected_state) = (state)
                  ├── scan              |              |
                  │                     | table        | station_info@primary
                  │                     | spans        | FULL SCAN
                  │                     | filter       | expected_state IS NOT NULL
                  └── filter            |              |
                       │                | filter       | state IS NOT NULL
                       └── synchronizer |              |
                            └── ts scan |              |
                                        | ts-table     | firegases
                                        | access mode  | tableTableMeta
(33 rows)
> SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.state = s.expected_state
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
  work_area_sn | avg  | avg  | sum  | count | count | count
---------------+------+------+------+-------+-------+--------
  NULL         |   15 |   10 |   15 |     1 |     2 |     2
  adr1         | 22.5 | 22.5 | 22.5 |     1 |     1 |     1
  adr3         |   15 |   35 |   15 |     1 |     1 |     1
(3 rows)
> explain SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
      AND f.adr = s.work_area_sn
ORDER BY f."time", s.station_sn;
             tree             |     field      |                  description
------------------------------+----------------+------------------------------------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | time           | "time"
   │                          | value          | value
   │                          | station_sn     | station_sn
   │                          | station_name   | station_name
   │                          | work_area_sn   | work_area_sn
   │                          | expected_state | expected_state
   │                          | standard_val   | standard_val
   │                          | adr            | adr
   │                          | state          | state
   │                          | second_val     | second_val
   └── sort                   |                |
        │                     | order          | +"time",+station_sn
        └── hash-join         |                |
             │                | type           | inner
             │                | equality       | (expected_state, work_area_sn) = (state, adr)
             ├── scan         |                |
             │                | table          | station_info@primary
             │                | spans          | FULL SCAN
             └── synchronizer |                |
                  └── ts scan |                |
                              | ts-table       | firegases
                              | access mode    | tableTableMeta
(25 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE f.state = s.expected_state
      AND f.adr = s.work_area_sn
ORDER BY f."time", s.station_sn;
            time            | value | station_sn | station_name | work_area_sn | expected_state | standard_val | adr  | state  | second_val
----------------------------+-------+------------+--------------+--------------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | sn1        | Station One  | adr1         | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.second_val + 5 = s.standard_val
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
                  tree                  |    field     |         description
----------------------------------------+--------------+------------------------------
                                        | distributed  | true
                                        | vectorized   | false
  sort                                  |              |
   │                                    | order        | +work_area_sn
   └── group                            |              |
        │                               | aggregate 0  | work_area_sn
        │                               | aggregate 1  | avg(value)
        │                               | aggregate 2  | avg(standard_val)
        │                               | aggregate 3  | sum(second_val)
        │                               | aggregate 4  | count(standard_val)
        │                               | aggregate 5  | count(state)
        │                               | aggregate 6  | count(station_name)
        │                               | group by     | work_area_sn
        └── render                      |              |
             │                          | value        | value
             │                          | state        | state
             │                          | second_val   | second_val
             │                          | station_name | station_name
             │                          | work_area_sn | work_area_sn
             │                          | standard_val | standard_val
             └── hash-join              |              |
                  │                     | type         | inner
                  │                     | equality     | (column11) = (standard_val)
                  ├── render            |              |
                  │    │                | column11     | second_val + 5.0
                  │    │                | value        | value
                  │    │                | state        | state
                  │    │                | second_val   | second_val
                  │    └── synchronizer |              |
                  │         └── ts scan |              |
                  │                     | ts-table     | firegases
                  │                     | access mode  | tableTableMeta
                  └── scan              |              |
                                        | table        | station_info@primary
                                        | spans        | FULL SCAN
                                        | filter       | expected_state IS NOT NULL
(36 rows)
> SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.second_val + 5 = s.standard_val
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
  work_area_sn | avg | avg | sum | count | count | count
---------------+-----+-----+-----+-------+-------+--------
  adr3         |  30 |  35 |  30 |     1 |     0 |     1
(1 row)
> explain SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.second_val = s.standard_val and f.state = s.expected_state
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
                  tree                  |    field     |                     description
----------------------------------------+--------------+-------------------------------------------------------
                                        | distributed  | true
                                        | vectorized   | false
  group                                 |              |
   │                                    | aggregate 0  | work_area_sn
   │                                    | aggregate 1  | avg(value)
   │                                    | aggregate 2  | avg(standard_val)
   │                                    | aggregate 3  | sum(second_val)
   │                                    | aggregate 4  | count(standard_val)
   │                                    | aggregate 5  | count(state)
   │                                    | aggregate 6  | count(station_name)
   │                                    | group by     | work_area_sn
   │                                    | ordered      | +work_area_sn
   └── render                           |              |
        │                               | value        | value
        │                               | state        | state
        │                               | second_val   | second_val
        │                               | station_name | station_name
        │                               | work_area_sn | work_area_sn
        │                               | standard_val | standard_val
        └── sort                        |              |
             │                          | order        | +work_area_sn
             └── hash-join              |              |
                  │                     | type         | inner
                  │                     | equality     | (standard_val, expected_state) = (second_val, state)
                  ├── scan              |              |
                  │                     | table        | station_info@primary
                  │                     | spans        | FULL SCAN
                  │                     | filter       | expected_state IS NOT NULL
                  └── filter            |              |
                       │                | filter       | state IS NOT NULL
                       └── synchronizer |              |
                            └── ts scan |              |
                                        | ts-table     | firegases
                                        | access mode  | tableTableMeta
(34 rows)
> SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
FROM my_timeseries_db.firegases f,
     my_relation_db.station_info s
WHERE s.expected_state is not NULL and f.second_val = s.standard_val and f.state = s.expected_state
GROUP BY s.work_area_sn
ORDER BY s.work_area_sn;
  work_area_sn | avg  | avg  | sum  | count | count | count
---------------+------+------+------+-------+-------+--------
  adr1         | 22.5 | 22.5 | 22.5 |     1 |     1 |     1
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE s.expected_state is not NULL and f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.work_area_sn = ts.adr
ORDER BY ts."value";
                       tree                       |       field        |        description
--------------------------------------------------+--------------------+-----------------------------
                                                  | distributed        | true
                                                  | vectorized         | false
  render                                          |                    |
   │                                              | time               | "time"
   │                                              | value              | value
   │                                              | work_area_sn       | work_area_sn
   │                                              | avg                | avg
   │                                              | avg                | avg
   │                                              | sum                | sum
   │                                              | count              | count
   │                                              | count              | count
   │                                              | count              | count
   │                                              | adr                | adr
   │                                              | state              | state
   │                                              | second_val         | second_val
   └── sort                                       |                    |
        │                                         | order              | +value
        └── hash-join                             |                    |
             │                                    | type               | inner
             │                                    | equality           | (adr) = (work_area_sn)
             │                                    | right cols are key |
             ├── synchronizer                     |                    |
             │    └── ts scan                     |                    |
             │                                    | ts-table           | firegases
             │                                    | access mode        | tableTableMeta
             └── group                            |                    |
                  │                               | aggregate 0        | work_area_sn
                  │                               | aggregate 1        | avg(value)
                  │                               | aggregate 2        | avg(standard_val)
                  │                               | aggregate 3        | sum(second_val)
                  │                               | aggregate 4        | count(standard_val)
                  │                               | aggregate 5        | count(state)
                  │                               | aggregate 6        | count(station_name)
                  │                               | group by           | work_area_sn
                  └── render                      |                    |
                       │                          | value              | value
                       │                          | state              | state
                       │                          | second_val         | second_val
                       │                          | station_name       | station_name
                       │                          | work_area_sn       | work_area_sn
                       │                          | standard_val       | standard_val
                       └── hash-join              |                    |
                            │                     | type               | inner
                            │                     | equality           | (expected_state) = (state)
                            ├── scan              |                    |
                            │                     | table              | station_info@primary
                            │                     | spans              | FULL SCAN
                            │                     | filter             | expected_state IS NOT NULL
                            └── filter            |                    |
                                 │                | filter             | state IS NOT NULL
                                 └── synchronizer |                    |
                                      └── ts scan |                    |
                                                  | ts-table           | firegases
                                                  | access mode        | tableTableMeta
(54 rows)
> SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value"),
      AVG(s.standard_val),
      SUM(f.second_val),
      COUNT(s.standard_val),
      COUNT(f.state),
      COUNT(s.station_name)
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE s.expected_state is not NULL and f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.work_area_sn = ts.adr
ORDER BY ts."value";
            time            | value | work_area_sn | avg  | avg  | sum  | count | count | count | adr  | state  | second_val
----------------------------+-------+--------------+------+------+------+-------+-------+-------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | adr1         | 22.5 | 22.5 | 22.5 |     1 |     1 |     1 | adr1 | active |       22.5
  2024-09-01 10:10:00+00:00 |    30 | adr3         |   15 |   35 |   15 |     1 |     1 |     1 | adr3 | NULL   |         30
(2 rows)
> explain SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value") as value_avg,
      AVG(s.standard_val) as standard_avg,
      SUM(f.second_val) as second_avg,
      COUNT(s.standard_val) as standar_count,
      COUNT(f.state) as state_count,
      COUNT(s.station_name) as station_count
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.standard_avg= ts.second_val;
                  tree                  |     field     |        description
----------------------------------------+---------------+-----------------------------
                                        | distributed   | true
                                        | vectorized    | false
  render                                |               |
   │                                    | time          | "time"
   │                                    | value         | value
   │                                    | work_area_sn  | work_area_sn
   │                                    | value_avg     | avg
   │                                    | standard_avg  | avg
   │                                    | second_avg    | sum
   │                                    | standar_count | count
   │                                    | state_count   | count
   │                                    | station_count | count
   │                                    | adr           | adr
   │                                    | state         | state
   │                                    | second_val    | second_val
   └── hash-join                        |               |
        │                               | type          | inner
        │                               | equality      | (second_val) = (avg)
        ├── synchronizer                |               |
        │    └── ts scan                |               |
        │                               | ts-table      | firegases
        │                               | access mode   | tableTableMeta
        └── group                       |               |
             │                          | aggregate 0   | work_area_sn
             │                          | aggregate 1   | avg(value)
             │                          | aggregate 2   | avg(standard_val)
             │                          | aggregate 3   | sum(second_val)
             │                          | aggregate 4   | count(standard_val)
             │                          | aggregate 5   | count(state)
             │                          | aggregate 6   | count(station_name)
             │                          | group by      | work_area_sn
             └── render                 |               |
                  │                     | value         | value
                  │                     | state         | state
                  │                     | second_val    | second_val
                  │                     | station_name  | station_name
                  │                     | work_area_sn  | work_area_sn
                  │                     | standard_val  | standard_val
                  └── hash-join         |               |
                       │                | type          | inner
                       │                | equality      | (expected_state) = (state)
                       ├── scan         |               |
                       │                | table         | station_info@primary
                       │                | spans         | FULL SCAN
                       └── synchronizer |               |
                            └── ts scan |               |
                                        | ts-table      | firegases
                                        | access mode   | tableTableMeta
(48 rows)
> SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value") as value_avg,
      AVG(s.standard_val) as standard_avg,
      SUM(f.second_val) as second_avg,
      COUNT(s.standard_val) as standar_count,
      COUNT(f.state) as state_count,
      COUNT(s.station_name) as station_count
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.standard_avg= ts.second_val;
            time            | value | work_area_sn | value_avg | standard_avg | second_avg | standar_count | state_count | station_count | adr  | state  | second_val
----------------------------+-------+--------------+-----------+--------------+------------+---------------+-------------+---------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | adr1         |      22.5 |         22.5 |       22.5 |             1 |           1 |             1 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value") as value_avg,
      AVG(s.standard_val) as standard_avg,
      SUM(f.second_val) as second_avg,
      COUNT(s.standard_val) as standar_count,
      COUNT(f.state) as state_count,
      COUNT(s.station_name) as station_count
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.standard_avg + 5 = ts.second_val;
                     tree                    |     field     |        description
---------------------------------------------+---------------+-----------------------------
                                             | distributed   | true
                                             | vectorized    | false
  render                                     |               |
   │                                         | time          | "time"
   │                                         | value         | value
   │                                         | work_area_sn  | work_area_sn
   │                                         | value_avg     | avg
   │                                         | standard_avg  | avg
   │                                         | second_avg    | sum
   │                                         | standar_count | count
   │                                         | state_count   | count
   │                                         | station_count | count
   │                                         | adr           | adr
   │                                         | state         | state
   │                                         | second_val    | second_val
   └── hash-join                             |               |
        │                                    | type          | inner
        │                                    | equality      | (second_val) = (column22)
        ├── synchronizer                     |               |
        │    └── ts scan                     |               |
        │                                    | ts-table      | firegases
        │                                    | access mode   | tableTableMeta
        └── render                           |               |
             │                               | column22      | avg + 5.0
             │                               | work_area_sn  | work_area_sn
             │                               | avg           | avg
             │                               | avg           | avg
             │                               | sum           | sum
             │                               | count         | count
             │                               | count         | count
             │                               | count         | count
             └── group                       |               |
                  │                          | aggregate 0   | work_area_sn
                  │                          | aggregate 1   | avg(value)
                  │                          | aggregate 2   | avg(standard_val)
                  │                          | aggregate 3   | sum(second_val)
                  │                          | aggregate 4   | count(standard_val)
                  │                          | aggregate 5   | count(state)
                  │                          | aggregate 6   | count(station_name)
                  │                          | group by      | work_area_sn
                  └── render                 |               |
                       │                     | value         | value
                       │                     | state         | state
                       │                     | second_val    | second_val
                       │                     | station_name  | station_name
                       │                     | work_area_sn  | work_area_sn
                       │                     | standard_val  | standard_val
                       └── hash-join         |               |
                            │                | type          | inner
                            │                | equality      | (expected_state) = (state)
                            ├── scan         |               |
                            │                | table         | station_info@primary
                            │                | spans         | FULL SCAN
                            └── synchronizer |               |
                                 └── ts scan |               |
                                             | ts-table      | firegases
                                             | access mode   | tableTableMeta
(57 rows)
> SELECT *
FROM my_timeseries_db.firegases ts,
    (SELECT s.work_area_sn,
      AVG(f."value") as value_avg,
      AVG(s.standard_val) as standard_avg,
      SUM(f.second_val) as second_avg,
      COUNT(s.standard_val) as standar_count,
      COUNT(f.state) as state_count,
      COUNT(s.station_name) as station_count
    FROM my_timeseries_db.firegases f,
      my_relation_db.station_info s
    WHERE f.state = s.expected_state
    GROUP BY s.work_area_sn) as t
WHERE t.standard_avg + 5 = ts.second_val;
            time            | value | work_area_sn | value_avg | standard_avg | second_avg | standar_count | state_count | station_count | adr  |  state  | second_val
----------------------------+-------+--------------+-----------+--------------+------------+---------------+-------------+---------------+------+---------+-------------
  2024-09-01 10:15:00+00:00 |    15 | NULL         |        15 |           10 |         15 |             1 |           2 |             2 | adr4 | pending |         15
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
    (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s,
        my_timeseries_db.firegases fire
    WHERE s.expected_state = fire.state
    GROUP BY expected_state) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
                  tree                  |       field        |                 description
----------------------------------------+--------------------+----------------------------------------------
                                        | distributed        | true
                                        | vectorized         | false
  render                                |                    |
   │                                    | time               | "time"
   │                                    | value              | value
   │                                    | expected_state     | expected_state
   │                                    | standard_avg       | avg
   │                                    | adr                | adr
   │                                    | state              | state
   │                                    | second_val         | second_val
   └── hash-join                        |                    |
        │                               | type               | inner
        │                               | equality           | (second_val, state) = (avg, expected_state)
        │                               | right cols are key |
        ├── synchronizer                |                    |
        │    └── ts scan                |                    |
        │                               | ts-table           | firegases
        │                               | access mode        | tableTableMeta
        └── group                       |                    |
             │                          | aggregate 0        | expected_state
             │                          | aggregate 1        | avg(standard_val)
             │                          | group by           | expected_state
             └── render                 |                    |
                  │                     | expected_state     | expected_state
                  │                     | standard_val       | standard_val
                  └── hash-join         |                    |
                       │                | type               | inner
                       │                | equality           | (expected_state) = (state)
                       ├── scan         |                    |
                       │                | table              | station_info@primary
                       │                | spans              | FULL SCAN
                       └── synchronizer |                    |
                            └── ts scan |                    |
                                        | ts-table           | firegases
                                        | access mode        | tableTableMeta
(35 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
    (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s,
        my_timeseries_db.firegases fire
    WHERE s.expected_state = fire.state
    GROUP BY expected_state) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
            time            | value | expected_state | standard_avg | adr  | state  | second_val
----------------------------+-------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
    ((SELECT expected_state, standard_val as standard_avg
    FROM my_relation_db.station_info)
    UNION (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s,
        my_timeseries_db.firegases fire
    WHERE s.expected_state = fire.state
    GROUP BY expected_state)) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
                     tree                    |       field       |                     description
---------------------------------------------+-------------------+-------------------------------------------------------
                                             | distributed       | true
                                             | vectorized        | false
  render                                     |                   |
   │                                         | time              | "time"
   │                                         | value             | value
   │                                         | expected_state    | expected_state
   │                                         | standard_avg      | standard_val
   │                                         | adr               | adr
   │                                         | state             | state
   │                                         | second_val        | second_val
   └── hash-join                             |                   |
        │                                    | type              | inner
        │                                    | equality          | (standard_val, expected_state) = (second_val, state)
        │                                    | left cols are key |
        ├── union                            |                   |
        │    ├── group                       |                   |
        │    │    │                          | aggregate 0       | expected_state
        │    │    │                          | aggregate 1       | avg(standard_val)
        │    │    │                          | group by          | expected_state
        │    │    └── render                 |                   |
        │    │         │                     | expected_state    | expected_state
        │    │         │                     | standard_val      | standard_val
        │    │         └── hash-join         |                   |
        │    │              │                | type              | inner
        │    │              │                | equality          | (expected_state) = (state)
        │    │              ├── scan         |                   |
        │    │              │                | table             | station_info@primary
        │    │              │                | spans             | FULL SCAN
        │    │              └── synchronizer |                   |
        │    │                   └── ts scan |                   |
        │    │                               | ts-table          | firegases
        │    │                               | access mode       | tableTableMeta
        │    └── scan                        |                   |
        │                                    | table             | station_info@primary
        │                                    | spans             | FULL SCAN
        └── synchronizer                     |                   |
             └── ts scan                     |                   |
                                             | ts-table          | firegases
                                             | access mode       | tableTableMeta
(39 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
    ((SELECT expected_state, standard_val as standard_avg
    FROM my_relation_db.station_info)
    UNION (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s,
        my_timeseries_db.firegases fire
    WHERE s.expected_state = fire.state
    GROUP BY expected_state)) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
            time            | value | expected_state | standard_avg | adr  | state  | second_val
----------------------------+-------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | active         |         22.5 | adr1 | active |       22.5
(1 row)
> explain SELECT *
FROM my_timeseries_db.firegases f,
    ((SELECT expected_state, standard_val as standard_avg
    FROM my_relation_db.station_info)
    UNION (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s
    RIGHT JOIN my_timeseries_db.firegases fire
    ON s.expected_state = fire.state
    GROUP BY expected_state)) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
                     tree                    |       field       |                     description
---------------------------------------------+-------------------+-------------------------------------------------------
                                             | distributed       | true
                                             | vectorized        | false
  render                                     |                   |
   │                                         | time              | "time"
   │                                         | value             | value
   │                                         | expected_state    | expected_state
   │                                         | standard_avg      | standard_val
   │                                         | adr               | adr
   │                                         | state             | state
   │                                         | second_val        | second_val
   └── hash-join                             |                   |
        │                                    | type              | inner
        │                                    | equality          | (standard_val, expected_state) = (second_val, state)
        │                                    | left cols are key |
        ├── union                            |                   |
        │    ├── group                       |                   |
        │    │    │                          | aggregate 0       | expected_state
        │    │    │                          | aggregate 1       | avg(standard_val)
        │    │    │                          | group by          | expected_state
        │    │    └── render                 |                   |
        │    │         │                     | expected_state    | expected_state
        │    │         │                     | standard_val      | standard_val
        │    │         └── hash-join         |                   |
        │    │              │                | type              | right outer
        │    │              │                | equality          | (expected_state) = (state)
        │    │              ├── scan         |                   |
        │    │              │                | table             | station_info@primary
        │    │              │                | spans             | FULL SCAN
        │    │              └── synchronizer |                   |
        │    │                   └── ts scan |                   |
        │    │                               | ts-table          | firegases
        │    │                               | access mode       | tableTableMeta
        │    └── scan                        |                   |
        │                                    | table             | station_info@primary
        │                                    | spans             | FULL SCAN
        └── synchronizer                     |                   |
             └── ts scan                     |                   |
                                             | ts-table          | firegases
                                             | access mode       | tableTableMeta
(39 rows)
> SELECT *
FROM my_timeseries_db.firegases f,
    ((SELECT expected_state, standard_val as standard_avg
    FROM my_relation_db.station_info)
    UNION (SELECT expected_state, AVG(standard_val) as standard_avg
    FROM my_relation_db.station_info s
    RIGHT JOIN my_timeseries_db.firegases fire
    ON s.expected_state = fire.state
    GROUP BY expected_state)) as r
WHERE f.second_val = r.standard_avg
    AND f.state = r.expected_state;
            time            | value | expected_state | standard_avg | adr  | state  | second_val
----------------------------+-------+----------------+--------------+------+--------+-------------
  2024-09-01 10:00:00+00:00 |  22.5 | active         |         22.5 | adr1 | active |       22.5
(1 row)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.int2_val = s.work_area_sn_int2
ORDER BY f."time";
             tree             |        field        |           description
------------------------------+---------------------+-----------------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (int2_val) = (work_area_sn_int2)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.int2_val = s.work_area_sn_int2
ORDER BY f."time";
            time            | second_val | station_sn | station_name | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr | state  | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+--------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+--------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:15:00+00:00 |         15 |          5 | Station Five |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   4 | active |       40 | NULL     |   40000 | NULL       |        15 |   NULL
(1 row)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.int4_val = s.work_area_sn_int4
ORDER BY f."time";
             tree             |        field        |           description
------------------------------+---------------------+-----------------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (int4_val) = (work_area_sn_int4)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.int4_val = s.work_area_sn_int4
ORDER BY f."time";
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state   | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+----------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:25:00+00:00 | NULL       |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   6 | inactive |       60 |     6000 |   60000 |       17.5 |      17.5 |  false
(2 rows)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.adr = s.station_sn
ORDER BY f."time";
             tree             |        field        |     description
------------------------------+---------------------+-----------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (adr) = (station_sn)
             │                | right cols are key  |
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(35 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.adr = s.station_sn
ORDER BY f."time";
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state   | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+----------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:00:00+00:00 |         25 |          1 | Station One   |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   1 | active   |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
  2024-09-01 10:05:00+00:00 | NULL       |          2 | Station Two   |                 2 | NULL              |              200 | inactive       |                  10 |                  5 |  false   |   2 | inactive |       20 |     2000 |   20000 |       18.5 | NULL      |  false
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:15:00+00:00 |         15 |          4 | Station Four  | NULL              | NULL              |            40000 | pending        | NULL                |                 15 |   NULL   |   4 | active   |       40 | NULL     |   40000 | NULL       |        15 |   NULL
  2024-09-01 10:20:00+00:00 | NULL       |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   5 | NULL     |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
  2024-09-01 10:25:00+00:00 | NULL       |          6 | Station Six   | NULL              | NULL              | NULL             | NULL           | NULL                | NULL               |  false   |   6 | inactive |       60 |     6000 |   60000 |       17.5 |      17.5 |  false
(6 rows)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.float4_val = s.standard_val_float4
ORDER BY f."time";
             tree             |        field        |             description
------------------------------+---------------------+---------------------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (float4_val) = (standard_val_float4)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.float4_val = s.standard_val_float4
ORDER BY f."time";
            time            | second_val | station_sn | station_name | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr | state  | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+--------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+--------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:00:00+00:00 |         25 |          1 | Station One  |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   1 | active |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
(1 row)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.float_val = s.standard_val_float
ORDER BY f."time";
             tree             |        field        |            description
------------------------------+---------------------+-------------------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (float_val) = (standard_val_float)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.float_val = s.standard_val_float
ORDER BY f."time";
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state  | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+---------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:15:00+00:00 |         15 |          4 | Station Four  | NULL              | NULL              |            40000 | pending        | NULL                |                 15 |   NULL   |   4 | active  |       40 | NULL     |   40000 | NULL       |        15 |   NULL
  2024-09-01 10:20:00+00:00 | NULL       |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   5 | NULL    |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
(3 rows)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f
JOIN my_relation_db_v2.station_info s ON f.second_val = s.standard_val_float
WHERE f.second_val IS NOT NULL AND s.standard_val_float IS NOT NULL
ORDER BY f."time";
                tree               |          field           |             description
-----------------------------------+--------------------------+--------------------------------------
                                   | distributed              | true
                                   | vectorized               | false
  render                           |                          |
   │                               | time                     | "time"
   │                               | second_val               | second_val
   │                               | station_sn               | station_sn
   │                               | station_name             | station_name
   │                               | work_area_sn_int2        | work_area_sn_int2
   │                               | work_area_sn_int4        | work_area_sn_int4
   │                               | work_area_sn_int         | work_area_sn_int
   │                               | expected_state           | expected_state
   │                               | standard_val_float4      | standard_val_float4
   │                               | standard_val_float       | standard_val_float
   │                               | bool_val                 | bool_val
   │                               | adr                      | adr
   │                               | state                    | state
   │                               | int2_val                 | int2_val
   │                               | int4_val                 | int4_val
   │                               | int_val                  | int_val
   │                               | float4_val               | float4_val
   │                               | float_val                | float_val
   │                               | bool_val                 | bool_val
   └── sort                        |                          |
        │                          | order                    | +"time"
        └── hash-join              |                          |
             │                     | type                     | inner
             │                     | equality                 | (standard_val_float) = (second_val)
             ├── scan              |                          |
             │                     | table                    | station_info@primary
             │                     | spans                    | FULL SCAN
             │                     | filter                   | standard_val_float IS NOT NULL
             └── filter            |                          |
                  │                | filter                   | second_val IS NOT NULL
                  └── synchronizer |                          |
                       └── ts scan |                          |
                                   | ts-table                 | firegases
                                   | access mode              | tableTableMeta
                                   | block filter[second_val] | NOT NULL
(38 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f
JOIN my_relation_db_v2.station_info s ON f.second_val = s.standard_val_float
WHERE f.second_val IS NOT NULL AND s.standard_val_float IS NOT NULL
ORDER BY f."time";
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state  | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+---------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:15:00+00:00 |         15 |          4 | Station Four  | NULL              | NULL              |            40000 | pending        | NULL                |                 15 |   NULL   |   4 | active  |       40 | NULL     |   40000 | NULL       |        15 |   NULL
(2 rows)
> EXPLAIN SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.bool_val = s.bool_val
ORDER BY f."time";
             tree             |        field        |       description
------------------------------+---------------------+--------------------------
                              | distributed         | true
                              | vectorized          | false
  render                      |                     |
   │                          | time                | "time"
   │                          | second_val          | second_val
   │                          | station_sn          | station_sn
   │                          | station_name        | station_name
   │                          | work_area_sn_int2   | work_area_sn_int2
   │                          | work_area_sn_int4   | work_area_sn_int4
   │                          | work_area_sn_int    | work_area_sn_int
   │                          | expected_state      | expected_state
   │                          | standard_val_float4 | standard_val_float4
   │                          | standard_val_float  | standard_val_float
   │                          | bool_val            | bool_val
   │                          | adr                 | adr
   │                          | state               | state
   │                          | int2_val            | int2_val
   │                          | int4_val            | int4_val
   │                          | int_val             | int_val
   │                          | float4_val          | float4_val
   │                          | float_val           | float_val
   │                          | bool_val            | bool_val
   └── sort                   |                     |
        │                     | order               | +"time"
        └── hash-join         |                     |
             │                | type                | inner
             │                | equality            | (bool_val) = (bool_val)
             ├── synchronizer |                     |
             │    └── ts scan |                     |
             │                | ts-table            | firegases
             │                | access mode         | tableTableMeta
             └── scan         |                     |
                              | table               | station_info@primary
                              | spans               | FULL SCAN
(34 rows)
> SELECT *
FROM my_timeseries_db_v2.firegases f, my_relation_db_v2.station_info s
WHERE f.bool_val = s.bool_val
ORDER BY f."time", s.station_sn, f.float_val, f.int_val, f.adr;
            time            | second_val | station_sn | station_name  | work_area_sn_int2 | work_area_sn_int4 | work_area_sn_int | expected_state | standard_val_float4 | standard_val_float | bool_val | adr |  state   | int2_val | int4_val | int_val | float4_val | float_val | bool_val
----------------------------+------------+------------+---------------+-------------------+-------------------+------------------+----------------+---------------------+--------------------+----------+-----+----------+----------+----------+---------+------------+-----------+-----------
  2024-09-01 10:00:00+00:00 |         25 |          1 | Station One   |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   1 | active   |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
  2024-09-01 10:00:00+00:00 |         25 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   1 | active   |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
  2024-09-01 10:00:00+00:00 |         25 |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   1 | active   |       10 |     1000 |   10000 |       22.5 |      22.5 |   true
  2024-09-01 10:05:00+00:00 | NULL       |          2 | Station Two   |                 2 | NULL              |              200 | inactive       |                  10 |                  5 |  false   |   2 | inactive |       20 |     2000 |   20000 |       18.5 | NULL      |  false
  2024-09-01 10:05:00+00:00 | NULL       |          6 | Station Six   | NULL              | NULL              | NULL             | NULL           | NULL                | NULL               |  false   |   2 | inactive |       20 |     2000 |   20000 |       18.5 | NULL      |  false
  2024-09-01 10:10:00+00:00 |         30 |          1 | Station One   |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:10:00+00:00 |         30 |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:10:00+00:00 |         30 |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   3 | pending  | NULL     |     3000 | NULL    |         30 |        30 |   true
  2024-09-01 10:20:00+00:00 | NULL       |          1 | Station One   |                 1 |                10 |            10000 | active         |                22.5 |                 20 |   true   |   5 | NULL     |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
  2024-09-01 10:20:00+00:00 | NULL       |          3 | Station Three | NULL              |              3000 | NULL             | pending        |                  35 |                 30 |   true   |   5 | NULL     |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
  2024-09-01 10:20:00+00:00 | NULL       |          5 | Station Five  |                40 |              6000 |              500 | NULL           |                15.5 |               12.5 |   true   |   5 | NULL     |       50 |     5000 | NULL    |       12.5 |      12.5 |   true
  2024-09-01 10:25:00+00:00 | NULL       |          2 | Station Two   |                 2 | NULL              |              200 | inactive       |                  10 |                  5 |  false   |   6 | inactive |       60 |     6000 |   60000 |       17.5 |      17.5 |  false
  2024-09-01 10:25:00+00:00 | NULL       |          6 | Station Six   | NULL              | NULL              | NULL             | NULL           | NULL                | NULL               |  false   |   6 | inactive |       60 |     6000 |   60000 |       17.5 |      17.5 |  false
(13 rows)
> set enable_multimodel=false;
SET
> set hash_scan_mode = 0;
SET
> DROP TABLE my_timeseries_db_v2.firegases;
DROP TABLE
> DROP TABLE my_relation_db_v2.station_info;
DROP TABLE
> DROP DATABASE my_timeseries_db_v2;
DROP DATABASE
> DROP DATABASE my_relation_db_v2;
DROP DATABASE
> DROP TABLE my_timeseries_db.firegases;
DROP TABLE
> DROP TABLE my_relation_db.station_info;
DROP TABLE
> DROP DATABASE my_timeseries_db;
DROP DATABASE
> DROP DATABASE my_relation_db;
DROP DATABASE
> delete  from system.table_statistics where name = '_stats_firegases' or name = '_stats_station_info' or name = '_stats_';
DELETE 29
> set cluster setting ts.sql.query_opt_mode = DEFAULT;
SET CLUSTER SETTING
> set cluster setting sql.stats.tag_automatic_collection.enabled = true;
SET CLUSTER SETTING
> set cluster setting sql.stats.automatic_collection.enabled = true;
SET CLUSTER SETTING
