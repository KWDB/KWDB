> DROP DATABASE IF EXISTS ts_db CASCADE;
DROP DATABASE
> CREATE TS DATABASE  ts_db;
CREATE TS DATABASE
> CREATE TABLE ts_db.st(k_timestamp  TIMESTAMP not null,ts TIMESTAMPTZ, e1 int) tags (code1 INT not null) primary tags(code1);
CREATE TABLE
> INSERT INTO ts_db.st values(100000,'2020-2-2 12:00:00.111+08:00',1, 1); -- 1970-01-01 08:01:40
INSERT 1
> INSERT INTO ts_db.st values(200000,'2020-2-2 11:01:10.222+08:00',1, 1); -- 1970-01-01 08:03:20
INSERT 1
> INSERT INTO ts_db.st values(300000,'2020-2-2 10:02:20.333+08:00',1, 1); -- 1970-01-01 08:05:00
INSERT 1
> INSERT INTO ts_db.st values(-400000,'1920-2-2 09:25:43.247+08:00',1, 1); -- 1970-01-01 08:05:00
INSERT 1
> INSERT INTO ts_db.st values(-500000,'1824-5-22 16:06:44.254+08:00',1, 1); -- 1970-01-01 08:05:00
INSERT 1
> set time zone 0;
SET
> SELECT k_timestamp+'10y',k_timestamp+'12mon',k_timestamp+'4w',k_timestamp+'32d',k_timestamp+'24h',k_timestamp+'60m',k_timestamp+'60s',k_timestamp+'1000ms',k_timestamp+'10y2mon3w5d10h20m12s600ms',k_timestamp+'10y12mon30w5d',k_timestamp+'-10y-12mon-30w-5d',k_timestamp+'10y12mon5d',k_timestamp+'10y12mon12h',k_timestamp+'10y12mon12m',k_timestamp+'10y12mon12s',k_timestamp+'10y12mon12ms',k_timestamp+'10h20m12s',k_timestamp+'10h20m12ms',k_timestamp+'-10h-20m-12ms',k_timestamp+'0m12ms',k_timestamp+'0h12ms',k_timestamp+'10y12ms',k_timestamp+'10y2mon12ms' FROM ts_db.st ORDER BY k_timestamp;
          ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |          ?column?           |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |           ?column?            |         ?column?          |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?
----------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+-----------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+-------------------------------+---------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+--------------------------------
  1979-12-31 23:51:40+00:00 | 1970-12-31 23:51:40+00:00 | 1970-01-28 23:51:40+00:00 | 1970-02-01 23:51:40+00:00 | 1970-01-01 23:51:40+00:00 | 1970-01-01 00:51:40+00:00 | 1969-12-31 23:52:40+00:00 | 1969-12-31 23:51:41+00:00 | 1980-03-27 10:11:52.6+00:00 | 1981-08-03 23:51:40+00:00 | 1958-05-30 23:51:40+00:00 | 1981-01-05 23:51:40+00:00 | 1981-01-01 11:51:40+00:00 | 1981-01-01 00:03:40+00:00 | 1980-12-31 23:51:52+00:00 | 1980-12-31 23:51:40.012+00:00 | 1970-01-01 10:11:52+00:00 | 1970-01-01 10:11:40.012+00:00 | 1969-12-31 13:31:39.988+00:00 | 1969-12-31 23:51:40.012+00:00 | 1969-12-31 23:51:40.012+00:00 | 1979-12-31 23:51:40.012+00:00 | 1980-02-29 23:51:40.012+00:00
  1979-12-31 23:53:20+00:00 | 1970-12-31 23:53:20+00:00 | 1970-01-28 23:53:20+00:00 | 1970-02-01 23:53:20+00:00 | 1970-01-01 23:53:20+00:00 | 1970-01-01 00:53:20+00:00 | 1969-12-31 23:54:20+00:00 | 1969-12-31 23:53:21+00:00 | 1980-03-27 10:13:32.6+00:00 | 1981-08-03 23:53:20+00:00 | 1958-05-30 23:53:20+00:00 | 1981-01-05 23:53:20+00:00 | 1981-01-01 11:53:20+00:00 | 1981-01-01 00:05:20+00:00 | 1980-12-31 23:53:32+00:00 | 1980-12-31 23:53:20.012+00:00 | 1970-01-01 10:13:32+00:00 | 1970-01-01 10:13:20.012+00:00 | 1969-12-31 13:33:19.988+00:00 | 1969-12-31 23:53:20.012+00:00 | 1969-12-31 23:53:20.012+00:00 | 1979-12-31 23:53:20.012+00:00 | 1980-02-29 23:53:20.012+00:00
  1980-01-01 00:01:40+00:00 | 1971-01-01 00:01:40+00:00 | 1970-01-29 00:01:40+00:00 | 1970-02-02 00:01:40+00:00 | 1970-01-02 00:01:40+00:00 | 1970-01-01 01:01:40+00:00 | 1970-01-01 00:02:40+00:00 | 1970-01-01 00:01:41+00:00 | 1980-03-27 10:21:52.6+00:00 | 1981-08-04 00:01:40+00:00 | 1958-05-31 00:01:40+00:00 | 1981-01-06 00:01:40+00:00 | 1981-01-01 12:01:40+00:00 | 1981-01-01 00:13:40+00:00 | 1981-01-01 00:01:52+00:00 | 1981-01-01 00:01:40.012+00:00 | 1970-01-01 10:21:52+00:00 | 1970-01-01 10:21:40.012+00:00 | 1969-12-31 13:41:39.988+00:00 | 1970-01-01 00:01:40.012+00:00 | 1970-01-01 00:01:40.012+00:00 | 1980-01-01 00:01:40.012+00:00 | 1980-03-01 00:01:40.012+00:00
  1980-01-01 00:03:20+00:00 | 1971-01-01 00:03:20+00:00 | 1970-01-29 00:03:20+00:00 | 1970-02-02 00:03:20+00:00 | 1970-01-02 00:03:20+00:00 | 1970-01-01 01:03:20+00:00 | 1970-01-01 00:04:20+00:00 | 1970-01-01 00:03:21+00:00 | 1980-03-27 10:23:32.6+00:00 | 1981-08-04 00:03:20+00:00 | 1958-05-31 00:03:20+00:00 | 1981-01-06 00:03:20+00:00 | 1981-01-01 12:03:20+00:00 | 1981-01-01 00:15:20+00:00 | 1981-01-01 00:03:32+00:00 | 1981-01-01 00:03:20.012+00:00 | 1970-01-01 10:23:32+00:00 | 1970-01-01 10:23:20.012+00:00 | 1969-12-31 13:43:19.988+00:00 | 1970-01-01 00:03:20.012+00:00 | 1970-01-01 00:03:20.012+00:00 | 1980-01-01 00:03:20.012+00:00 | 1980-03-01 00:03:20.012+00:00
  1980-01-01 00:05:00+00:00 | 1971-01-01 00:05:00+00:00 | 1970-01-29 00:05:00+00:00 | 1970-02-02 00:05:00+00:00 | 1970-01-02 00:05:00+00:00 | 1970-01-01 01:05:00+00:00 | 1970-01-01 00:06:00+00:00 | 1970-01-01 00:05:01+00:00 | 1980-03-27 10:25:12.6+00:00 | 1981-08-04 00:05:00+00:00 | 1958-05-31 00:05:00+00:00 | 1981-01-06 00:05:00+00:00 | 1981-01-01 12:05:00+00:00 | 1981-01-01 00:17:00+00:00 | 1981-01-01 00:05:12+00:00 | 1981-01-01 00:05:00.012+00:00 | 1970-01-01 10:25:12+00:00 | 1970-01-01 10:25:00.012+00:00 | 1969-12-31 13:44:59.988+00:00 | 1970-01-01 00:05:00.012+00:00 | 1970-01-01 00:05:00.012+00:00 | 1980-01-01 00:05:00.012+00:00 | 1980-03-01 00:05:00.012+00:00
(5 rows)
> SELECT k_timestamp-'10y',k_timestamp-'12mon',k_timestamp-'4w',k_timestamp-'32d',k_timestamp-'24h',k_timestamp-'60m',k_timestamp-'60s',k_timestamp-'1000ms',k_timestamp-'10y2mon3w5d10h20m12s600ms',k_timestamp-'10y12mon30w5d',k_timestamp-'-10y-12mon-30w-5d',k_timestamp-'10y12mon5d',k_timestamp-'10y12mon12h',k_timestamp-'10y12mon12m',k_timestamp-'10y12mon12s',k_timestamp-'10y12mon12ms',k_timestamp-'10h20m12s',k_timestamp-'10h20m12ms',k_timestamp-'-10h-20m-12ms',k_timestamp-'0m12ms',k_timestamp-'0h12ms',k_timestamp-'10y12ms',k_timestamp-'10y2mon12ms' FROM ts_db.st ORDER BY k_timestamp;
ERROR: unsupported binary operator: <timestamptz(3)> - <string>
SQLSTATE: 22023
> SELECT k_timestamp+10y, k_timestamp+12mon,k_timestamp+4w,k_timestamp+32d,k_timestamp+24h,k_timestamp+60m,k_timestamp+60s,k_timestamp+1000ms FROM ts_db.st ORDER BY k_timestamp;
          ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?
----------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+----------------------------
  1979-12-31 23:51:40+00:00 | 1970-12-31 23:51:40+00:00 | 1970-01-28 23:51:40+00:00 | 1970-02-01 23:51:40+00:00 | 1970-01-01 23:51:40+00:00 | 1970-01-01 00:51:40+00:00 | 1969-12-31 23:52:40+00:00 | 1969-12-31 23:51:41+00:00
  1979-12-31 23:53:20+00:00 | 1970-12-31 23:53:20+00:00 | 1970-01-28 23:53:20+00:00 | 1970-02-01 23:53:20+00:00 | 1970-01-01 23:53:20+00:00 | 1970-01-01 00:53:20+00:00 | 1969-12-31 23:54:20+00:00 | 1969-12-31 23:53:21+00:00
  1980-01-01 00:01:40+00:00 | 1971-01-01 00:01:40+00:00 | 1970-01-29 00:01:40+00:00 | 1970-02-02 00:01:40+00:00 | 1970-01-02 00:01:40+00:00 | 1970-01-01 01:01:40+00:00 | 1970-01-01 00:02:40+00:00 | 1970-01-01 00:01:41+00:00
  1980-01-01 00:03:20+00:00 | 1971-01-01 00:03:20+00:00 | 1970-01-29 00:03:20+00:00 | 1970-02-02 00:03:20+00:00 | 1970-01-02 00:03:20+00:00 | 1970-01-01 01:03:20+00:00 | 1970-01-01 00:04:20+00:00 | 1970-01-01 00:03:21+00:00
  1980-01-01 00:05:00+00:00 | 1971-01-01 00:05:00+00:00 | 1970-01-29 00:05:00+00:00 | 1970-02-02 00:05:00+00:00 | 1970-01-02 00:05:00+00:00 | 1970-01-01 01:05:00+00:00 | 1970-01-01 00:06:00+00:00 | 1970-01-01 00:05:01+00:00
(5 rows)
> SELECT k_timestamp-10y, k_timestamp-12mon,k_timestamp-4w,k_timestamp-32d,k_timestamp-24h,k_timestamp-60m,k_timestamp-60s,k_timestamp-1000ms FROM ts_db.st ORDER BY k_timestamp;
          ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?
----------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+----------------------------
  1959-12-31 23:51:40+00:00 | 1968-12-31 23:51:40+00:00 | 1969-12-03 23:51:40+00:00 | 1969-11-29 23:51:40+00:00 | 1969-12-30 23:51:40+00:00 | 1969-12-31 22:51:40+00:00 | 1969-12-31 23:50:40+00:00 | 1969-12-31 23:51:39+00:00
  1959-12-31 23:53:20+00:00 | 1968-12-31 23:53:20+00:00 | 1969-12-03 23:53:20+00:00 | 1969-11-29 23:53:20+00:00 | 1969-12-30 23:53:20+00:00 | 1969-12-31 22:53:20+00:00 | 1969-12-31 23:52:20+00:00 | 1969-12-31 23:53:19+00:00
  1960-01-01 00:01:40+00:00 | 1969-01-01 00:01:40+00:00 | 1969-12-04 00:01:40+00:00 | 1969-11-30 00:01:40+00:00 | 1969-12-31 00:01:40+00:00 | 1969-12-31 23:01:40+00:00 | 1970-01-01 00:00:40+00:00 | 1970-01-01 00:01:39+00:00
  1960-01-01 00:03:20+00:00 | 1969-01-01 00:03:20+00:00 | 1969-12-04 00:03:20+00:00 | 1969-11-30 00:03:20+00:00 | 1969-12-31 00:03:20+00:00 | 1969-12-31 23:03:20+00:00 | 1970-01-01 00:02:20+00:00 | 1970-01-01 00:03:19+00:00
  1960-01-01 00:05:00+00:00 | 1969-01-01 00:05:00+00:00 | 1969-12-04 00:05:00+00:00 | 1969-11-30 00:05:00+00:00 | 1969-12-31 00:05:00+00:00 | 1969-12-31 23:05:00+00:00 | 1970-01-01 00:04:00+00:00 | 1970-01-01 00:04:59+00:00
(5 rows)
> SELECT k_timestamp-(TIMESTAMP'2020-1-1 12:12:12.000'-TIMESTAMP'2019-1-1 12:12:12.000') FROM ts_db.st order by k_timestamp;
          ?column?
-----------------------------
  1968-12-31 23:51:40+00:00
  1968-12-31 23:53:20+00:00
  1969-01-01 00:01:40+00:00
  1969-01-01 00:03:20+00:00
  1969-01-01 00:05:00+00:00
(5 rows)
> SELECT k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'10y',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'12mon',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'4w',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'30d',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'24h',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'60m',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'60s',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'1000ms' FROM ts_db.st order by k_timestamp;
             ?column?             |            ?column?            |       ?column?        |       ?column?        |       ?column?        |       ?column?        |       ?column?        |       ?column?
----------------------------------+--------------------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+------------------------
  -10 years -18262 days -12:08:32 | -1 years -18262 days -12:08:32 | -18290 days -12:08:32 | -18292 days -12:08:32 | -18262 days -36:08:32 | -18262 days -13:08:32 | -18262 days -12:09:32 | -18262 days -12:08:33
  -10 years -18262 days -12:06:52 | -1 years -18262 days -12:06:52 | -18290 days -12:06:52 | -18292 days -12:06:52 | -18262 days -36:06:52 | -18262 days -13:06:52 | -18262 days -12:07:52 | -18262 days -12:06:53
  -10 years -18262 days -11:58:32 | -1 years -18262 days -11:58:32 | -18290 days -11:58:32 | -18292 days -11:58:32 | -18262 days -35:58:32 | -18262 days -12:58:32 | -18262 days -11:59:32 | -18262 days -11:58:33
  -10 years -18262 days -11:56:52 | -1 years -18262 days -11:56:52 | -18290 days -11:56:52 | -18292 days -11:56:52 | -18262 days -35:56:52 | -18262 days -12:56:52 | -18262 days -11:57:52 | -18262 days -11:56:53
  -10 years -18262 days -11:55:12 | -1 years -18262 days -11:55:12 | -18290 days -11:55:12 | -18292 days -11:55:12 | -18262 days -35:55:12 | -18262 days -12:55:12 | -18262 days -11:56:12 | -18262 days -11:55:13
(5 rows)
> SELECT first(k_timestamp+10y), first(k_timestamp+12mon),first(k_timestamp+4w),first(k_timestamp+32d),first(k_timestamp+24h),first(k_timestamp+60m),first(k_timestamp+60s),first(k_timestamp+1000ms) FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp;
ERROR: at or near "+": syntax error
SQLSTATE: 42601
DETAIL: source SQL:
SELECT first(k_timestamp+10y), first(k_timestamp+12mon),first(k_timestamp+4w),first(k_timestamp+32d),first(k_timestamp+24h),first(k_timestamp+60m),first(k_timestamp+60s),first(k_timestamp+1000ms) FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp
                        ^
HINT: try \hf first
> SELECT max(k_timestamp+10y), max(k_timestamp+12mon),max(k_timestamp+4w),max(k_timestamp+32d),max(k_timestamp+24h),max(k_timestamp+60m),max(k_timestamp+60s),max(k_timestamp+1000ms) FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp;
             max            |            max            |            max            |            max            |            max            |            max            |            max            |            max
----------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+----------------------------
  1979-12-31 23:51:40+00:00 | 1970-12-31 23:51:40+00:00 | 1970-01-28 23:51:40+00:00 | 1970-02-01 23:51:40+00:00 | 1970-01-01 23:51:40+00:00 | 1970-01-01 00:51:40+00:00 | 1969-12-31 23:52:40+00:00 | 1969-12-31 23:51:41+00:00
  1979-12-31 23:53:20+00:00 | 1970-12-31 23:53:20+00:00 | 1970-01-28 23:53:20+00:00 | 1970-02-01 23:53:20+00:00 | 1970-01-01 23:53:20+00:00 | 1970-01-01 00:53:20+00:00 | 1969-12-31 23:54:20+00:00 | 1969-12-31 23:53:21+00:00
  1980-01-01 00:01:40+00:00 | 1971-01-01 00:01:40+00:00 | 1970-01-29 00:01:40+00:00 | 1970-02-02 00:01:40+00:00 | 1970-01-02 00:01:40+00:00 | 1970-01-01 01:01:40+00:00 | 1970-01-01 00:02:40+00:00 | 1970-01-01 00:01:41+00:00
  1980-01-01 00:03:20+00:00 | 1971-01-01 00:03:20+00:00 | 1970-01-29 00:03:20+00:00 | 1970-02-02 00:03:20+00:00 | 1970-01-02 00:03:20+00:00 | 1970-01-01 01:03:20+00:00 | 1970-01-01 00:04:20+00:00 | 1970-01-01 00:03:21+00:00
  1980-01-01 00:05:00+00:00 | 1971-01-01 00:05:00+00:00 | 1970-01-29 00:05:00+00:00 | 1970-02-02 00:05:00+00:00 | 1970-01-02 00:05:00+00:00 | 1970-01-01 01:05:00+00:00 | 1970-01-01 00:06:00+00:00 | 1970-01-01 00:05:01+00:00
(5 rows)
> SELECT min(k_timestamp-10y), min(k_timestamp-12mon),min(k_timestamp-4w),min(k_timestamp-32d),min(k_timestamp-24h),min(k_timestamp-60m),min(k_timestamp-60s),min(k_timestamp-1000ms) FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp;
             min            |            min            |            min            |            min            |            min            |            min            |            min            |            min
----------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+----------------------------
  1959-12-31 23:51:40+00:00 | 1968-12-31 23:51:40+00:00 | 1969-12-03 23:51:40+00:00 | 1969-11-29 23:51:40+00:00 | 1969-12-30 23:51:40+00:00 | 1969-12-31 22:51:40+00:00 | 1969-12-31 23:50:40+00:00 | 1969-12-31 23:51:39+00:00
  1959-12-31 23:53:20+00:00 | 1968-12-31 23:53:20+00:00 | 1969-12-03 23:53:20+00:00 | 1969-11-29 23:53:20+00:00 | 1969-12-30 23:53:20+00:00 | 1969-12-31 22:53:20+00:00 | 1969-12-31 23:52:20+00:00 | 1969-12-31 23:53:19+00:00
  1960-01-01 00:01:40+00:00 | 1969-01-01 00:01:40+00:00 | 1969-12-04 00:01:40+00:00 | 1969-11-30 00:01:40+00:00 | 1969-12-31 00:01:40+00:00 | 1969-12-31 23:01:40+00:00 | 1970-01-01 00:00:40+00:00 | 1970-01-01 00:01:39+00:00
  1960-01-01 00:03:20+00:00 | 1969-01-01 00:03:20+00:00 | 1969-12-04 00:03:20+00:00 | 1969-11-30 00:03:20+00:00 | 1969-12-31 00:03:20+00:00 | 1969-12-31 23:03:20+00:00 | 1970-01-01 00:02:20+00:00 | 1970-01-01 00:03:19+00:00
  1960-01-01 00:05:00+00:00 | 1969-01-01 00:05:00+00:00 | 1969-12-04 00:05:00+00:00 | 1969-11-30 00:05:00+00:00 | 1969-12-31 00:05:00+00:00 | 1969-12-31 23:05:00+00:00 | 1970-01-01 00:04:00+00:00 | 1970-01-01 00:04:59+00:00
(5 rows)
> SELECT count(k_timestamp-10y), count(k_timestamp-12mon),count(k_timestamp-4w),count(k_timestamp-32d),count(k_timestamp-24h),count(k_timestamp-60m),count(k_timestamp-60s),count(k_timestamp-1000ms) FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp;
  count | count | count | count | count | count | count | count
--------+-------+-------+-------+-------+-------+-------+--------
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
(5 rows)
> SELECT max(k_timestamp-TIMESTAMPTZ'1970-1-1 01:00:12.000-05:00') FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp;
     max
-------------
  -06:08:32
  -06:06:52
  -05:58:32
  -05:56:52
  -05:55:12
(5 rows)
> SELECT count(k_timestamp-TIMESTAMP'1970-1-1 01:00:12.000-05:00') FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp;
  count
---------
      1
      1
      1
      1
      1
(5 rows)
> SELECT ts+'10y',ts+'12mon',ts+'4w',ts+'32d',ts+'24h',ts+'60m',ts+'60s',ts+'1000ms',ts+'10y2mon3w5d10h20m12s600ms',ts+'10y12mon30w5d',ts+'-10y-12mon-30w-5d',ts+'10y12mon5d',ts+'10y12mon12h',ts+'10y12mon12m',ts+'10y12mon12s',ts+'10y12mon12ms',ts+'10h20m12s',ts+'10h20m12ms',ts+'-10h-20m-12ms',ts+'0m12ms',ts+'0h12ms',ts+'10y12ms',ts+'10y2mon12ms' FROM ts_db.st ORDER BY ts;
            ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?
--------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+--------------------------------
  1834-05-22 08:06:44.254+00:00 | 1825-05-22 08:06:44.254+00:00 | 1824-06-19 08:06:44.254+00:00 | 1824-06-23 08:06:44.254+00:00 | 1824-05-23 08:06:44.254+00:00 | 1824-05-22 09:06:44.254+00:00 | 1824-05-22 08:07:44.254+00:00 | 1824-05-22 08:06:45.254+00:00 | 1834-08-17 18:26:56.854+00:00 | 1835-12-23 08:06:44.254+00:00 | 1812-10-19 08:06:44.254+00:00 | 1835-05-27 08:06:44.254+00:00 | 1835-05-22 20:06:44.254+00:00 | 1835-05-22 08:18:44.254+00:00 | 1835-05-22 08:06:56.254+00:00 | 1835-05-22 08:06:44.266+00:00 | 1824-05-22 18:26:56.254+00:00 | 1824-05-22 18:26:44.266+00:00 | 1824-05-21 21:46:44.242+00:00 | 1824-05-22 08:06:44.266+00:00 | 1824-05-22 08:06:44.266+00:00 | 1834-05-22 08:06:44.266+00:00 | 1834-07-22 08:06:44.266+00:00
  1930-02-02 01:25:43.247+00:00 | 1921-02-02 01:25:43.247+00:00 | 1920-03-01 01:25:43.247+00:00 | 1920-03-05 01:25:43.247+00:00 | 1920-02-03 01:25:43.247+00:00 | 1920-02-02 02:25:43.247+00:00 | 1920-02-02 01:26:43.247+00:00 | 1920-02-02 01:25:44.247+00:00 | 1930-04-28 11:45:55.847+00:00 | 1931-09-05 01:25:43.247+00:00 | 1908-07-02 01:25:43.247+00:00 | 1931-02-07 01:25:43.247+00:00 | 1931-02-02 13:25:43.247+00:00 | 1931-02-02 01:37:43.247+00:00 | 1931-02-02 01:25:55.247+00:00 | 1931-02-02 01:25:43.259+00:00 | 1920-02-02 11:45:55.247+00:00 | 1920-02-02 11:45:43.259+00:00 | 1920-02-01 15:05:43.235+00:00 | 1920-02-02 01:25:43.259+00:00 | 1920-02-02 01:25:43.259+00:00 | 1930-02-02 01:25:43.259+00:00 | 1930-04-02 01:25:43.259+00:00
  2030-02-02 02:02:20.333+00:00 | 2021-02-02 02:02:20.333+00:00 | 2020-03-01 02:02:20.333+00:00 | 2020-03-05 02:02:20.333+00:00 | 2020-02-03 02:02:20.333+00:00 | 2020-02-02 03:02:20.333+00:00 | 2020-02-02 02:03:20.333+00:00 | 2020-02-02 02:02:21.333+00:00 | 2030-04-28 12:22:32.933+00:00 | 2031-09-05 02:02:20.333+00:00 | 2008-07-02 02:02:20.333+00:00 | 2031-02-07 02:02:20.333+00:00 | 2031-02-02 14:02:20.333+00:00 | 2031-02-02 02:14:20.333+00:00 | 2031-02-02 02:02:32.333+00:00 | 2031-02-02 02:02:20.345+00:00 | 2020-02-02 12:22:32.333+00:00 | 2020-02-02 12:22:20.345+00:00 | 2020-02-01 15:42:20.321+00:00 | 2020-02-02 02:02:20.345+00:00 | 2020-02-02 02:02:20.345+00:00 | 2030-02-02 02:02:20.345+00:00 | 2030-04-02 02:02:20.345+00:00
  2030-02-02 03:01:10.222+00:00 | 2021-02-02 03:01:10.222+00:00 | 2020-03-01 03:01:10.222+00:00 | 2020-03-05 03:01:10.222+00:00 | 2020-02-03 03:01:10.222+00:00 | 2020-02-02 04:01:10.222+00:00 | 2020-02-02 03:02:10.222+00:00 | 2020-02-02 03:01:11.222+00:00 | 2030-04-28 13:21:22.822+00:00 | 2031-09-05 03:01:10.222+00:00 | 2008-07-02 03:01:10.222+00:00 | 2031-02-07 03:01:10.222+00:00 | 2031-02-02 15:01:10.222+00:00 | 2031-02-02 03:13:10.222+00:00 | 2031-02-02 03:01:22.222+00:00 | 2031-02-02 03:01:10.234+00:00 | 2020-02-02 13:21:22.222+00:00 | 2020-02-02 13:21:10.234+00:00 | 2020-02-01 16:41:10.21+00:00  | 2020-02-02 03:01:10.234+00:00 | 2020-02-02 03:01:10.234+00:00 | 2030-02-02 03:01:10.234+00:00 | 2030-04-02 03:01:10.234+00:00
  2030-02-02 04:00:00.111+00:00 | 2021-02-02 04:00:00.111+00:00 | 2020-03-01 04:00:00.111+00:00 | 2020-03-05 04:00:00.111+00:00 | 2020-02-03 04:00:00.111+00:00 | 2020-02-02 05:00:00.111+00:00 | 2020-02-02 04:01:00.111+00:00 | 2020-02-02 04:00:01.111+00:00 | 2030-04-28 14:20:12.711+00:00 | 2031-09-05 04:00:00.111+00:00 | 2008-07-02 04:00:00.111+00:00 | 2031-02-07 04:00:00.111+00:00 | 2031-02-02 16:00:00.111+00:00 | 2031-02-02 04:12:00.111+00:00 | 2031-02-02 04:00:12.111+00:00 | 2031-02-02 04:00:00.123+00:00 | 2020-02-02 14:20:12.111+00:00 | 2020-02-02 14:20:00.123+00:00 | 2020-02-01 17:40:00.099+00:00 | 2020-02-02 04:00:00.123+00:00 | 2020-02-02 04:00:00.123+00:00 | 2030-02-02 04:00:00.123+00:00 | 2030-04-02 04:00:00.123+00:00
(5 rows)
> SELECT ts-'10y',ts-'12mon',ts-'4w',ts-'32d',ts-'24h',ts-'60m',ts-'60s',ts-'1000ms',ts-'10y2mon3w5d10h20m12s600ms',ts-'10y12mon30w5d',ts-'-10y-12mon-30w-5d',ts-'10y12mon5d',ts-'10y12mon12h',ts-'10y12mon12m',ts-'10y12mon12s',ts-'10y12mon12ms',ts-'10h20m12s',ts-'10h20m12ms',ts-'-10h-20m-12ms',ts-'0m12ms',ts-'0h12ms',ts-'10y12ms',ts-'10y2mon12ms' FROM ts_db.st ORDER BY ts;
ERROR: unsupported binary operator: <timestamptz(3)> - <string>
SQLSTATE: 22023
> SELECT ts+10y, ts+12mon,ts+4w,ts+32d,ts+24h,ts+60m,ts+60s,ts+1000ms FROM ts_db.st ORDER BY ts;
            ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?
--------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+--------------------------------
  1834-05-22 08:06:44.254+00:00 | 1825-05-22 08:06:44.254+00:00 | 1824-06-19 08:06:44.254+00:00 | 1824-06-23 08:06:44.254+00:00 | 1824-05-23 08:06:44.254+00:00 | 1824-05-22 09:06:44.254+00:00 | 1824-05-22 08:07:44.254+00:00 | 1824-05-22 08:06:45.254+00:00
  1930-02-02 01:25:43.247+00:00 | 1921-02-02 01:25:43.247+00:00 | 1920-03-01 01:25:43.247+00:00 | 1920-03-05 01:25:43.247+00:00 | 1920-02-03 01:25:43.247+00:00 | 1920-02-02 02:25:43.247+00:00 | 1920-02-02 01:26:43.247+00:00 | 1920-02-02 01:25:44.247+00:00
  2030-02-02 02:02:20.333+00:00 | 2021-02-02 02:02:20.333+00:00 | 2020-03-01 02:02:20.333+00:00 | 2020-03-05 02:02:20.333+00:00 | 2020-02-03 02:02:20.333+00:00 | 2020-02-02 03:02:20.333+00:00 | 2020-02-02 02:03:20.333+00:00 | 2020-02-02 02:02:21.333+00:00
  2030-02-02 03:01:10.222+00:00 | 2021-02-02 03:01:10.222+00:00 | 2020-03-01 03:01:10.222+00:00 | 2020-03-05 03:01:10.222+00:00 | 2020-02-03 03:01:10.222+00:00 | 2020-02-02 04:01:10.222+00:00 | 2020-02-02 03:02:10.222+00:00 | 2020-02-02 03:01:11.222+00:00
  2030-02-02 04:00:00.111+00:00 | 2021-02-02 04:00:00.111+00:00 | 2020-03-01 04:00:00.111+00:00 | 2020-03-05 04:00:00.111+00:00 | 2020-02-03 04:00:00.111+00:00 | 2020-02-02 05:00:00.111+00:00 | 2020-02-02 04:01:00.111+00:00 | 2020-02-02 04:00:01.111+00:00
(5 rows)
> SELECT ts-10y, ts-12mon,ts-4w,ts-32d,ts-24h,ts-60m,ts-60s,ts-1000ms FROM ts_db.st ORDER BY ts;
            ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?
--------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+--------------------------------
  1814-05-22 08:06:44.254+00:00 | 1823-05-22 08:06:44.254+00:00 | 1824-04-24 08:06:44.254+00:00 | 1824-04-20 08:06:44.254+00:00 | 1824-05-21 08:06:44.254+00:00 | 1824-05-22 07:06:44.254+00:00 | 1824-05-22 08:05:44.254+00:00 | 1824-05-22 08:06:43.254+00:00
  1910-02-02 01:25:43.247+00:00 | 1919-02-02 01:25:43.247+00:00 | 1920-01-05 01:25:43.247+00:00 | 1920-01-01 01:25:43.247+00:00 | 1920-02-01 01:25:43.247+00:00 | 1920-02-02 00:25:43.247+00:00 | 1920-02-02 01:24:43.247+00:00 | 1920-02-02 01:25:42.247+00:00
  2010-02-02 02:02:20.333+00:00 | 2019-02-02 02:02:20.333+00:00 | 2020-01-05 02:02:20.333+00:00 | 2020-01-01 02:02:20.333+00:00 | 2020-02-01 02:02:20.333+00:00 | 2020-02-02 01:02:20.333+00:00 | 2020-02-02 02:01:20.333+00:00 | 2020-02-02 02:02:19.333+00:00
  2010-02-02 03:01:10.222+00:00 | 2019-02-02 03:01:10.222+00:00 | 2020-01-05 03:01:10.222+00:00 | 2020-01-01 03:01:10.222+00:00 | 2020-02-01 03:01:10.222+00:00 | 2020-02-02 02:01:10.222+00:00 | 2020-02-02 03:00:10.222+00:00 | 2020-02-02 03:01:09.222+00:00
  2010-02-02 04:00:00.111+00:00 | 2019-02-02 04:00:00.111+00:00 | 2020-01-05 04:00:00.111+00:00 | 2020-01-01 04:00:00.111+00:00 | 2020-02-01 04:00:00.111+00:00 | 2020-02-02 03:00:00.111+00:00 | 2020-02-02 03:59:00.111+00:00 | 2020-02-02 03:59:59.111+00:00
(5 rows)
> SELECT ts-(TIMESTAMP'2020-1-1 12:12:12.000'-TIMESTAMP'2019-1-1 12:12:12.000') FROM ts_db.st order by ts;
            ?column?
---------------------------------
  1823-05-23 08:06:44.254+00:00
  1919-02-02 01:25:43.247+00:00
  2019-02-02 02:02:20.333+00:00
  2019-02-02 03:01:10.222+00:00
  2019-02-02 04:00:00.111+00:00
(5 rows)
> SELECT ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'10y',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'12mon',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'4w',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'30d',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'24h',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'60m',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'60s',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'1000ms' FROM ts_db.st order by ts;
               ?column?               |              ?column?              |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?
--------------------------------------+------------------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+----------------------------
  -10 years -71446 days -03:53:27.746 | -1 years -71446 days -03:53:27.746 | -71474 days -03:53:27.746 | -71476 days -03:53:27.746 | -71446 days -27:53:27.746 | -71446 days -04:53:27.746 | -71446 days -03:54:27.746 | -71446 days -03:53:28.746
  -10 years -36493 days -10:34:28.753 | -1 years -36493 days -10:34:28.753 | -36521 days -10:34:28.753 | -36523 days -10:34:28.753 | -36493 days -34:34:28.753 | -36493 days -11:34:28.753 | -36493 days -10:35:28.753 | -36493 days -10:34:29.753
  -10 years 31 days +14:02:08.333     | -1 years 31 days +14:02:08.333     | 3 days 14:02:08.333       | 1 day 14:02:08.333        | 31 days -09:57:51.667     | 31 days 13:02:08.333      | 31 days 14:01:08.333      | 31 days 14:02:07.333
  -10 years 31 days +15:00:58.222     | -1 years 31 days +15:00:58.222     | 3 days 15:00:58.222       | 1 day 15:00:58.222        | 31 days -08:59:01.778     | 31 days 14:00:58.222      | 31 days 14:59:58.222      | 31 days 15:00:57.222
  -10 years 31 days +15:59:48.111     | -1 years 31 days +15:59:48.111     | 3 days 15:59:48.111       | 1 day 15:59:48.111        | 31 days -08:00:11.889     | 31 days 14:59:48.111      | 31 days 15:58:48.111      | 31 days 15:59:47.111
(5 rows)
> SELECT first(ts+10y), first(ts+12mon),first(ts+4w),first(ts+32d),first(ts+24h),first(ts+60m),first(ts+60s),first(ts+1000ms) FROM ts_db.st GROUP BY ts ORDER BY ts;
ERROR: at or near "+": syntax error
SQLSTATE: 42601
DETAIL: source SQL:
SELECT first(ts+10y), first(ts+12mon),first(ts+4w),first(ts+32d),first(ts+24h),first(ts+60m),first(ts+60s),first(ts+1000ms) FROM ts_db.st GROUP BY ts ORDER BY ts
               ^
HINT: try \hf first
> SELECT max(ts+10y), max(ts+12mon),max(ts+4w),max(ts+32d),max(ts+24h),max(ts+60m),max(ts+60s),max(ts+1000ms) FROM ts_db.st GROUP BY ts ORDER BY ts;
               max              |              max              |              max              |              max              |              max              |              max              |              max              |              max
--------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+--------------------------------
  1834-05-22 08:06:44.254+00:00 | 1825-05-22 08:06:44.254+00:00 | 1824-06-19 08:06:44.254+00:00 | 1824-06-23 08:06:44.254+00:00 | 1824-05-23 08:06:44.254+00:00 | 1824-05-22 09:06:44.254+00:00 | 1824-05-22 08:07:44.254+00:00 | 1824-05-22 08:06:45.254+00:00
  1930-02-02 01:25:43.247+00:00 | 1921-02-02 01:25:43.247+00:00 | 1920-03-01 01:25:43.247+00:00 | 1920-03-05 01:25:43.247+00:00 | 1920-02-03 01:25:43.247+00:00 | 1920-02-02 02:25:43.247+00:00 | 1920-02-02 01:26:43.247+00:00 | 1920-02-02 01:25:44.247+00:00
  2030-02-02 02:02:20.333+00:00 | 2021-02-02 02:02:20.333+00:00 | 2020-03-01 02:02:20.333+00:00 | 2020-03-05 02:02:20.333+00:00 | 2020-02-03 02:02:20.333+00:00 | 2020-02-02 03:02:20.333+00:00 | 2020-02-02 02:03:20.333+00:00 | 2020-02-02 02:02:21.333+00:00
  2030-02-02 03:01:10.222+00:00 | 2021-02-02 03:01:10.222+00:00 | 2020-03-01 03:01:10.222+00:00 | 2020-03-05 03:01:10.222+00:00 | 2020-02-03 03:01:10.222+00:00 | 2020-02-02 04:01:10.222+00:00 | 2020-02-02 03:02:10.222+00:00 | 2020-02-02 03:01:11.222+00:00
  2030-02-02 04:00:00.111+00:00 | 2021-02-02 04:00:00.111+00:00 | 2020-03-01 04:00:00.111+00:00 | 2020-03-05 04:00:00.111+00:00 | 2020-02-03 04:00:00.111+00:00 | 2020-02-02 05:00:00.111+00:00 | 2020-02-02 04:01:00.111+00:00 | 2020-02-02 04:00:01.111+00:00
(5 rows)
> SELECT min(ts-10y), min(ts-12mon),min(ts-4w),min(ts-32d),min(ts-24h),min(ts-60m),min(ts-60s),min(ts-1000ms) FROM ts_db.st GROUP BY ts ORDER BY ts;
               min              |              min              |              min              |              min              |              min              |              min              |              min              |              min
--------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+--------------------------------
  1814-05-22 08:06:44.254+00:00 | 1823-05-22 08:06:44.254+00:00 | 1824-04-24 08:06:44.254+00:00 | 1824-04-20 08:06:44.254+00:00 | 1824-05-21 08:06:44.254+00:00 | 1824-05-22 07:06:44.254+00:00 | 1824-05-22 08:05:44.254+00:00 | 1824-05-22 08:06:43.254+00:00
  1910-02-02 01:25:43.247+00:00 | 1919-02-02 01:25:43.247+00:00 | 1920-01-05 01:25:43.247+00:00 | 1920-01-01 01:25:43.247+00:00 | 1920-02-01 01:25:43.247+00:00 | 1920-02-02 00:25:43.247+00:00 | 1920-02-02 01:24:43.247+00:00 | 1920-02-02 01:25:42.247+00:00
  2010-02-02 02:02:20.333+00:00 | 2019-02-02 02:02:20.333+00:00 | 2020-01-05 02:02:20.333+00:00 | 2020-01-01 02:02:20.333+00:00 | 2020-02-01 02:02:20.333+00:00 | 2020-02-02 01:02:20.333+00:00 | 2020-02-02 02:01:20.333+00:00 | 2020-02-02 02:02:19.333+00:00
  2010-02-02 03:01:10.222+00:00 | 2019-02-02 03:01:10.222+00:00 | 2020-01-05 03:01:10.222+00:00 | 2020-01-01 03:01:10.222+00:00 | 2020-02-01 03:01:10.222+00:00 | 2020-02-02 02:01:10.222+00:00 | 2020-02-02 03:00:10.222+00:00 | 2020-02-02 03:01:09.222+00:00
  2010-02-02 04:00:00.111+00:00 | 2019-02-02 04:00:00.111+00:00 | 2020-01-05 04:00:00.111+00:00 | 2020-01-01 04:00:00.111+00:00 | 2020-02-01 04:00:00.111+00:00 | 2020-02-02 03:00:00.111+00:00 | 2020-02-02 03:59:00.111+00:00 | 2020-02-02 03:59:59.111+00:00
(5 rows)
> SELECT count(ts-10y), count(ts-12mon),count(ts-4w),count(ts-32d),count(ts-24h),count(ts-60m),count(ts-60s),count(ts-1000ms) FROM ts_db.st GROUP BY ts ORDER BY ts;
  count | count | count | count | count | count | count | count
--------+-------+-------+-------+-------+-------+-------+--------
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
(5 rows)
> SELECT max(ts-TIMESTAMPTZ'1970-1-1 01:00:12.000-05:00') FROM ts_db.st GROUP BY ts ORDER BY ts;
             max
-----------------------------
  -53183 days -21:53:27.746
  -18231 days -04:34:28.753
  18293 days 20:02:08.333
  18293 days 21:00:58.222
  18293 days 21:59:48.111
(5 rows)
> SELECT count(ts-TIMESTAMP'1970-1-1 01:00:12.000-05:00') FROM ts_db.st GROUP BY ts ORDER BY ts;
  count
---------
      1
      1
      1
      1
      1
(5 rows)
> SELECT ts - k_timestamp FROM ts_db.st WHERE ts - k_timestamp BETWEEN '-60y' AND '60y' ORDER BY k_timestamp;
          ?column?
-----------------------------
  -18230 days -22:27:36.753
  18294 days 03:58:20.111
  18294 days 02:57:50.222
  18294 days 01:57:20.333
(4 rows)
> SELECT (TIMESTAMP'1970-1-1 12:12:12.121'+99999y) FROM ts_db.st ORDER BY k_timestamp;
ERROR: Timestamp/TimestampTZ out of range
SQLSTATE: 22023
> SELECT (TIMESTAMP'1970-1-1 12:12:12.121'+'20y')::TIMESTAMP FROM ts_db.st ORDER BY k_timestamp;
            timestamp
---------------------------------
  1990-01-01 12:12:12.121+00:00
  1990-01-01 12:12:12.121+00:00
  1990-01-01 12:12:12.121+00:00
  1990-01-01 12:12:12.121+00:00
  1990-01-01 12:12:12.121+00:00
(5 rows)
> SELECT (TIMESTAMP'1970-1-1 12:12:12.121'-INTERVAL'99999years')::TIMESTAMP FROM ts_db.st ORDER BY k_timestamp;
ERROR: Timestamp/TimestampTZ out of range
SQLSTATE: 22023
> SELECT max(TIMESTAMP'1970-1-1 12:12:12.121'+'20y'),max(TIMESTAMP'1970-1-1 12:12:12.121'+'12mon'),max(TIMESTAMP'1970-1-1 12:12:12.121'+'8w') FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp;
               max              |              max              |              max
--------------------------------+-------------------------------+--------------------------------
  1990-01-01 12:12:12.121+00:00 | 1971-01-01 12:12:12.121+00:00 | 1970-02-26 12:12:12.121+00:00
  1990-01-01 12:12:12.121+00:00 | 1971-01-01 12:12:12.121+00:00 | 1970-02-26 12:12:12.121+00:00
  1990-01-01 12:12:12.121+00:00 | 1971-01-01 12:12:12.121+00:00 | 1970-02-26 12:12:12.121+00:00
  1990-01-01 12:12:12.121+00:00 | 1971-01-01 12:12:12.121+00:00 | 1970-02-26 12:12:12.121+00:00
  1990-01-01 12:12:12.121+00:00 | 1971-01-01 12:12:12.121+00:00 | 1970-02-26 12:12:12.121+00:00
(5 rows)
> set time zone 8;
SET
> SELECT (k_timestamp+'10y',k_timestamp+'12mon',k_timestamp+'4w',k_timestamp+'32d',k_timestamp+'24h',k_timestamp+'60m',k_timestamp+'60s',k_timestamp+'1000ms',k_timestamp+'10y2mon3w5d10h20m12s600ms',k_timestamp+'10y12mon30w5d',k_timestamp+'-10y-12mon-30w-5d',k_timestamp+'10y12mon5d',k_timestamp+'10y12mon12h',k_timestamp+'10y12mon12m',k_timestamp+'10y12mon12s',k_timestamp+'10y12mon12ms',k_timestamp+'10h20m12s',k_timestamp+'10h20m12ms',k_timestamp+'-10h-20m-12ms',k_timestamp+'0m12ms',k_timestamp+'0h12ms',k_timestamp+'10y12ms',k_timestamp+'10y2mon12ms' FROM ts_db.st ORDER BY k_timestamp;
ERROR: at or near "from": syntax error
SQLSTATE: 42601
DETAIL: source SQL:
SELECT (k_timestamp+'10y',k_timestamp+'12mon',k_timestamp+'4w',k_timestamp+'32d',k_timestamp+'24h',k_timestamp+'60m',k_timestamp+'60s',k_timestamp+'1000ms',k_timestamp+'10y2mon3w5d10h20m12s600ms',k_timestamp+'10y12mon30w5d',k_timestamp+'-10y-12mon-30w-5d',k_timestamp+'10y12mon5d',k_timestamp+'10y12mon12h',k_timestamp+'10y12mon12m',k_timestamp+'10y12mon12s',k_timestamp+'10y12mon12ms',k_timestamp+'10h20m12s',k_timestamp+'10h20m12ms',k_timestamp+'-10h-20m-12ms',k_timestamp+'0m12ms',k_timestamp+'0h12ms',k_timestamp+'10y12ms',k_timestamp+'10y2mon12ms' FROM ts_db.st ORDER BY k_timestamp
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
HINT: try \h SELECT
> SELECT (k_timestamp-'10y',k_timestamp-'12mon',k_timestamp-'4w',k_timestamp-'32d',k_timestamp-'24h',k_timestamp-'60m',k_timestamp-'60s',k_timestamp-'1000ms',k_timestamp-'10y2mon3w5d10h20m12s600ms',k_timestamp-'10y12mon30w5d',k_timestamp-'-10y-12mon-30w-5d',k_timestamp-'10y12mon5d',k_timestamp-'10y12mon12h',k_timestamp-'10y12mon12m',k_timestamp-'10y12mon12s',k_timestamp-'10y12mon12ms',k_timestamp-'10h20m12s',k_timestamp-'10h20m12ms',k_timestamp-'-10h-20m-12ms',k_timestamp-'0m12ms',k_timestamp-'0h12ms',k_timestamp-'10y12ms',k_timestamp-'10y2mon12ms' FROM ts_db.st ORDER BY k_timestamp;
ERROR: at or near "from": syntax error
SQLSTATE: 42601
DETAIL: source SQL:
SELECT (k_timestamp-'10y',k_timestamp-'12mon',k_timestamp-'4w',k_timestamp-'32d',k_timestamp-'24h',k_timestamp-'60m',k_timestamp-'60s',k_timestamp-'1000ms',k_timestamp-'10y2mon3w5d10h20m12s600ms',k_timestamp-'10y12mon30w5d',k_timestamp-'-10y-12mon-30w-5d',k_timestamp-'10y12mon5d',k_timestamp-'10y12mon12h',k_timestamp-'10y12mon12m',k_timestamp-'10y12mon12s',k_timestamp-'10y12mon12ms',k_timestamp-'10h20m12s',k_timestamp-'10h20m12ms',k_timestamp-'-10h-20m-12ms',k_timestamp-'0m12ms',k_timestamp-'0h12ms',k_timestamp-'10y12ms',k_timestamp-'10y2mon12ms' FROM ts_db.st ORDER BY k_timestamp
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
HINT: try \h SELECT
> SELECT k_timestamp+10y, k_timestamp+12mon,k_timestamp+4w,k_timestamp+32d,k_timestamp+24h,k_timestamp+60m,k_timestamp+60s,k_timestamp+1000ms FROM ts_db.st ORDER BY k_timestamp;
          ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?
----------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+----------------------------
  1980-01-01 07:51:40+08:00 | 1971-01-01 07:51:40+08:00 | 1970-01-29 07:51:40+08:00 | 1970-02-02 07:51:40+08:00 | 1970-01-02 07:51:40+08:00 | 1970-01-01 08:51:40+08:00 | 1970-01-01 07:52:40+08:00 | 1970-01-01 07:51:41+08:00
  1980-01-01 07:53:20+08:00 | 1971-01-01 07:53:20+08:00 | 1970-01-29 07:53:20+08:00 | 1970-02-02 07:53:20+08:00 | 1970-01-02 07:53:20+08:00 | 1970-01-01 08:53:20+08:00 | 1970-01-01 07:54:20+08:00 | 1970-01-01 07:53:21+08:00
  1980-01-01 08:01:40+08:00 | 1971-01-01 08:01:40+08:00 | 1970-01-29 08:01:40+08:00 | 1970-02-02 08:01:40+08:00 | 1970-01-02 08:01:40+08:00 | 1970-01-01 09:01:40+08:00 | 1970-01-01 08:02:40+08:00 | 1970-01-01 08:01:41+08:00
  1980-01-01 08:03:20+08:00 | 1971-01-01 08:03:20+08:00 | 1970-01-29 08:03:20+08:00 | 1970-02-02 08:03:20+08:00 | 1970-01-02 08:03:20+08:00 | 1970-01-01 09:03:20+08:00 | 1970-01-01 08:04:20+08:00 | 1970-01-01 08:03:21+08:00
  1980-01-01 08:05:00+08:00 | 1971-01-01 08:05:00+08:00 | 1970-01-29 08:05:00+08:00 | 1970-02-02 08:05:00+08:00 | 1970-01-02 08:05:00+08:00 | 1970-01-01 09:05:00+08:00 | 1970-01-01 08:06:00+08:00 | 1970-01-01 08:05:01+08:00
(5 rows)
> SELECT k_timestamp-10y, k_timestamp-12mon,k_timestamp-4w,k_timestamp-32d,k_timestamp-24h,k_timestamp-60m,k_timestamp-60s,k_timestamp-1000ms FROM ts_db.st ORDER BY k_timestamp;
          ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?
----------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+----------------------------
  1960-01-01 07:51:40+08:00 | 1969-01-01 07:51:40+08:00 | 1969-12-04 07:51:40+08:00 | 1969-11-30 07:51:40+08:00 | 1969-12-31 07:51:40+08:00 | 1970-01-01 06:51:40+08:00 | 1970-01-01 07:50:40+08:00 | 1970-01-01 07:51:39+08:00
  1960-01-01 07:53:20+08:00 | 1969-01-01 07:53:20+08:00 | 1969-12-04 07:53:20+08:00 | 1969-11-30 07:53:20+08:00 | 1969-12-31 07:53:20+08:00 | 1970-01-01 06:53:20+08:00 | 1970-01-01 07:52:20+08:00 | 1970-01-01 07:53:19+08:00
  1960-01-01 08:01:40+08:00 | 1969-01-01 08:01:40+08:00 | 1969-12-04 08:01:40+08:00 | 1969-11-30 08:01:40+08:00 | 1969-12-31 08:01:40+08:00 | 1970-01-01 07:01:40+08:00 | 1970-01-01 08:00:40+08:00 | 1970-01-01 08:01:39+08:00
  1960-01-01 08:03:20+08:00 | 1969-01-01 08:03:20+08:00 | 1969-12-04 08:03:20+08:00 | 1969-11-30 08:03:20+08:00 | 1969-12-31 08:03:20+08:00 | 1970-01-01 07:03:20+08:00 | 1970-01-01 08:02:20+08:00 | 1970-01-01 08:03:19+08:00
  1960-01-01 08:05:00+08:00 | 1969-01-01 08:05:00+08:00 | 1969-12-04 08:05:00+08:00 | 1969-11-30 08:05:00+08:00 | 1969-12-31 08:05:00+08:00 | 1970-01-01 07:05:00+08:00 | 1970-01-01 08:04:00+08:00 | 1970-01-01 08:04:59+08:00
(5 rows)
> SELECT k_timestamp-(TIMESTAMP'2020-1-1 12:12:12.000'-TIMESTAMP'2019-1-1 12:12:12.000') FROM ts_db.st order by k_timestamp;
          ?column?
-----------------------------
  1969-01-01 07:51:40+08:00
  1969-01-01 07:53:20+08:00
  1969-01-01 08:01:40+08:00
  1969-01-01 08:03:20+08:00
  1969-01-01 08:05:00+08:00
(5 rows)
> SELECT k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'10y',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'12mon',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'4w',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'30d',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'24h',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'60m',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'60s',k_timestamp-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'1000ms' FROM ts_db.st order by k_timestamp;
             ?column?             |            ?column?            |       ?column?        |       ?column?        |       ?column?        |       ?column?        |       ?column?        |       ?column?
----------------------------------+--------------------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+------------------------
  -10 years -18262 days -04:08:32 | -1 years -18262 days -04:08:32 | -18290 days -04:08:32 | -18292 days -04:08:32 | -18262 days -28:08:32 | -18262 days -05:08:32 | -18262 days -04:09:32 | -18262 days -04:08:33
  -10 years -18262 days -04:06:52 | -1 years -18262 days -04:06:52 | -18290 days -04:06:52 | -18292 days -04:06:52 | -18262 days -28:06:52 | -18262 days -05:06:52 | -18262 days -04:07:52 | -18262 days -04:06:53
  -10 years -18262 days -03:58:32 | -1 years -18262 days -03:58:32 | -18290 days -03:58:32 | -18292 days -03:58:32 | -18262 days -27:58:32 | -18262 days -04:58:32 | -18262 days -03:59:32 | -18262 days -03:58:33
  -10 years -18262 days -03:56:52 | -1 years -18262 days -03:56:52 | -18290 days -03:56:52 | -18292 days -03:56:52 | -18262 days -27:56:52 | -18262 days -04:56:52 | -18262 days -03:57:52 | -18262 days -03:56:53
  -10 years -18262 days -03:55:12 | -1 years -18262 days -03:55:12 | -18290 days -03:55:12 | -18292 days -03:55:12 | -18262 days -27:55:12 | -18262 days -04:55:12 | -18262 days -03:56:12 | -18262 days -03:55:13
(5 rows)
> SELECT first(k_timestamp+10y), first(k_timestamp+12mon),first(k_timestamp+4w),first(k_timestamp+32d),first(k_timestamp+24h),first(k_timestamp+60m),first(k_timestamp+60s),first(k_timestamp+1000ms) FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp;
ERROR: at or near "+": syntax error
SQLSTATE: 42601
DETAIL: source SQL:
SELECT first(k_timestamp+10y), first(k_timestamp+12mon),first(k_timestamp+4w),first(k_timestamp+32d),first(k_timestamp+24h),first(k_timestamp+60m),first(k_timestamp+60s),first(k_timestamp+1000ms) FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp
                        ^
HINT: try \hf first
> SELECT max(k_timestamp+10y), max(k_timestamp+12mon),max(k_timestamp+4w),max(k_timestamp+32d),max(k_timestamp+24h),max(k_timestamp+60m),max(k_timestamp+60s),max(k_timestamp+1000ms) FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp;
             max            |            max            |            max            |            max            |            max            |            max            |            max            |            max
----------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+----------------------------
  1980-01-01 07:51:40+08:00 | 1971-01-01 07:51:40+08:00 | 1970-01-29 07:51:40+08:00 | 1970-02-02 07:51:40+08:00 | 1970-01-02 07:51:40+08:00 | 1970-01-01 08:51:40+08:00 | 1970-01-01 07:52:40+08:00 | 1970-01-01 07:51:41+08:00
  1980-01-01 07:53:20+08:00 | 1971-01-01 07:53:20+08:00 | 1970-01-29 07:53:20+08:00 | 1970-02-02 07:53:20+08:00 | 1970-01-02 07:53:20+08:00 | 1970-01-01 08:53:20+08:00 | 1970-01-01 07:54:20+08:00 | 1970-01-01 07:53:21+08:00
  1980-01-01 08:01:40+08:00 | 1971-01-01 08:01:40+08:00 | 1970-01-29 08:01:40+08:00 | 1970-02-02 08:01:40+08:00 | 1970-01-02 08:01:40+08:00 | 1970-01-01 09:01:40+08:00 | 1970-01-01 08:02:40+08:00 | 1970-01-01 08:01:41+08:00
  1980-01-01 08:03:20+08:00 | 1971-01-01 08:03:20+08:00 | 1970-01-29 08:03:20+08:00 | 1970-02-02 08:03:20+08:00 | 1970-01-02 08:03:20+08:00 | 1970-01-01 09:03:20+08:00 | 1970-01-01 08:04:20+08:00 | 1970-01-01 08:03:21+08:00
  1980-01-01 08:05:00+08:00 | 1971-01-01 08:05:00+08:00 | 1970-01-29 08:05:00+08:00 | 1970-02-02 08:05:00+08:00 | 1970-01-02 08:05:00+08:00 | 1970-01-01 09:05:00+08:00 | 1970-01-01 08:06:00+08:00 | 1970-01-01 08:05:01+08:00
(5 rows)
> SELECT min(k_timestamp-10y), min(k_timestamp-12mon),min(k_timestamp-4w),min(k_timestamp-32d),min(k_timestamp-24h),min(k_timestamp-60m),min(k_timestamp-60s),min(k_timestamp-1000ms) FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp;
             min            |            min            |            min            |            min            |            min            |            min            |            min            |            min
----------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+----------------------------
  1960-01-01 07:51:40+08:00 | 1969-01-01 07:51:40+08:00 | 1969-12-04 07:51:40+08:00 | 1969-11-30 07:51:40+08:00 | 1969-12-31 07:51:40+08:00 | 1970-01-01 06:51:40+08:00 | 1970-01-01 07:50:40+08:00 | 1970-01-01 07:51:39+08:00
  1960-01-01 07:53:20+08:00 | 1969-01-01 07:53:20+08:00 | 1969-12-04 07:53:20+08:00 | 1969-11-30 07:53:20+08:00 | 1969-12-31 07:53:20+08:00 | 1970-01-01 06:53:20+08:00 | 1970-01-01 07:52:20+08:00 | 1970-01-01 07:53:19+08:00
  1960-01-01 08:01:40+08:00 | 1969-01-01 08:01:40+08:00 | 1969-12-04 08:01:40+08:00 | 1969-11-30 08:01:40+08:00 | 1969-12-31 08:01:40+08:00 | 1970-01-01 07:01:40+08:00 | 1970-01-01 08:00:40+08:00 | 1970-01-01 08:01:39+08:00
  1960-01-01 08:03:20+08:00 | 1969-01-01 08:03:20+08:00 | 1969-12-04 08:03:20+08:00 | 1969-11-30 08:03:20+08:00 | 1969-12-31 08:03:20+08:00 | 1970-01-01 07:03:20+08:00 | 1970-01-01 08:02:20+08:00 | 1970-01-01 08:03:19+08:00
  1960-01-01 08:05:00+08:00 | 1969-01-01 08:05:00+08:00 | 1969-12-04 08:05:00+08:00 | 1969-11-30 08:05:00+08:00 | 1969-12-31 08:05:00+08:00 | 1970-01-01 07:05:00+08:00 | 1970-01-01 08:04:00+08:00 | 1970-01-01 08:04:59+08:00
(5 rows)
> SELECT count(k_timestamp-10y), count(k_timestamp-12mon),count(k_timestamp-4w),count(k_timestamp-32d),count(k_timestamp-24h),count(k_timestamp-60m),count(k_timestamp-60s),count(k_timestamp-1000ms) FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp;
  count | count | count | count | count | count | count | count
--------+-------+-------+-------+-------+-------+-------+--------
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
(5 rows)
> SELECT max(k_timestamp-TIMESTAMPTZ'1970-1-1 01:00:12.000-05:00') FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp;
     max
-------------
  -06:08:32
  -06:06:52
  -05:58:32
  -05:56:52
  -05:55:12
(5 rows)
> SELECT count(k_timestamp-TIMESTAMP'1970-1-1 01:00:12.000-05:00') FROM ts_db.st GROUP BY k_timestamp ORDER BY k_timestamp;
  count
---------
      1
      1
      1
      1
      1
(5 rows)
> SELECT ts+'10y',ts+'12mon',ts+'4w',ts+'32d',ts+'24h',ts+'60m',ts+'60s',ts+'1000ms',ts+'10y2mon3w5d10h20m12s600ms',ts+'10y12mon30w5d',ts+'-10y-12mon-30w-5d',ts+'10y12mon5d',ts+'10y12mon12h',ts+'10y12mon12m',ts+'10y12mon12s',ts+'10y12mon12ms',ts+'10h20m12s',ts+'10h20m12ms',ts+'-10h-20m-12ms',ts+'0m12ms',ts+'0h12ms',ts+'10y12ms',ts+'10y2mon12ms' FROM ts_db.st ORDER BY ts;
            ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?
--------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+--------------------------------
  1834-05-22 16:06:44.254+08:00 | 1825-05-22 16:06:44.254+08:00 | 1824-06-19 16:06:44.254+08:00 | 1824-06-23 16:06:44.254+08:00 | 1824-05-23 16:06:44.254+08:00 | 1824-05-22 17:06:44.254+08:00 | 1824-05-22 16:07:44.254+08:00 | 1824-05-22 16:06:45.254+08:00 | 1834-08-18 02:26:56.854+08:00 | 1835-12-23 16:06:44.254+08:00 | 1812-10-19 16:06:44.254+08:00 | 1835-05-27 16:06:44.254+08:00 | 1835-05-23 04:06:44.254+08:00 | 1835-05-22 16:18:44.254+08:00 | 1835-05-22 16:06:56.254+08:00 | 1835-05-22 16:06:44.266+08:00 | 1824-05-23 02:26:56.254+08:00 | 1824-05-23 02:26:44.266+08:00 | 1824-05-22 05:46:44.242+08:00 | 1824-05-22 16:06:44.266+08:00 | 1824-05-22 16:06:44.266+08:00 | 1834-05-22 16:06:44.266+08:00 | 1834-07-22 16:06:44.266+08:00
  1930-02-02 09:25:43.247+08:00 | 1921-02-02 09:25:43.247+08:00 | 1920-03-01 09:25:43.247+08:00 | 1920-03-05 09:25:43.247+08:00 | 1920-02-03 09:25:43.247+08:00 | 1920-02-02 10:25:43.247+08:00 | 1920-02-02 09:26:43.247+08:00 | 1920-02-02 09:25:44.247+08:00 | 1930-04-28 19:45:55.847+08:00 | 1931-09-05 09:25:43.247+08:00 | 1908-07-02 09:25:43.247+08:00 | 1931-02-07 09:25:43.247+08:00 | 1931-02-02 21:25:43.247+08:00 | 1931-02-02 09:37:43.247+08:00 | 1931-02-02 09:25:55.247+08:00 | 1931-02-02 09:25:43.259+08:00 | 1920-02-02 19:45:55.247+08:00 | 1920-02-02 19:45:43.259+08:00 | 1920-02-01 23:05:43.235+08:00 | 1920-02-02 09:25:43.259+08:00 | 1920-02-02 09:25:43.259+08:00 | 1930-02-02 09:25:43.259+08:00 | 1930-04-02 09:25:43.259+08:00
  2030-02-02 10:02:20.333+08:00 | 2021-02-02 10:02:20.333+08:00 | 2020-03-01 10:02:20.333+08:00 | 2020-03-05 10:02:20.333+08:00 | 2020-02-03 10:02:20.333+08:00 | 2020-02-02 11:02:20.333+08:00 | 2020-02-02 10:03:20.333+08:00 | 2020-02-02 10:02:21.333+08:00 | 2030-04-28 20:22:32.933+08:00 | 2031-09-05 10:02:20.333+08:00 | 2008-07-02 10:02:20.333+08:00 | 2031-02-07 10:02:20.333+08:00 | 2031-02-02 22:02:20.333+08:00 | 2031-02-02 10:14:20.333+08:00 | 2031-02-02 10:02:32.333+08:00 | 2031-02-02 10:02:20.345+08:00 | 2020-02-02 20:22:32.333+08:00 | 2020-02-02 20:22:20.345+08:00 | 2020-02-01 23:42:20.321+08:00 | 2020-02-02 10:02:20.345+08:00 | 2020-02-02 10:02:20.345+08:00 | 2030-02-02 10:02:20.345+08:00 | 2030-04-02 10:02:20.345+08:00
  2030-02-02 11:01:10.222+08:00 | 2021-02-02 11:01:10.222+08:00 | 2020-03-01 11:01:10.222+08:00 | 2020-03-05 11:01:10.222+08:00 | 2020-02-03 11:01:10.222+08:00 | 2020-02-02 12:01:10.222+08:00 | 2020-02-02 11:02:10.222+08:00 | 2020-02-02 11:01:11.222+08:00 | 2030-04-28 21:21:22.822+08:00 | 2031-09-05 11:01:10.222+08:00 | 2008-07-02 11:01:10.222+08:00 | 2031-02-07 11:01:10.222+08:00 | 2031-02-02 23:01:10.222+08:00 | 2031-02-02 11:13:10.222+08:00 | 2031-02-02 11:01:22.222+08:00 | 2031-02-02 11:01:10.234+08:00 | 2020-02-02 21:21:22.222+08:00 | 2020-02-02 21:21:10.234+08:00 | 2020-02-02 00:41:10.21+08:00  | 2020-02-02 11:01:10.234+08:00 | 2020-02-02 11:01:10.234+08:00 | 2030-02-02 11:01:10.234+08:00 | 2030-04-02 11:01:10.234+08:00
  2030-02-02 12:00:00.111+08:00 | 2021-02-02 12:00:00.111+08:00 | 2020-03-01 12:00:00.111+08:00 | 2020-03-05 12:00:00.111+08:00 | 2020-02-03 12:00:00.111+08:00 | 2020-02-02 13:00:00.111+08:00 | 2020-02-02 12:01:00.111+08:00 | 2020-02-02 12:00:01.111+08:00 | 2030-04-28 22:20:12.711+08:00 | 2031-09-05 12:00:00.111+08:00 | 2008-07-02 12:00:00.111+08:00 | 2031-02-07 12:00:00.111+08:00 | 2031-02-03 00:00:00.111+08:00 | 2031-02-02 12:12:00.111+08:00 | 2031-02-02 12:00:12.111+08:00 | 2031-02-02 12:00:00.123+08:00 | 2020-02-02 22:20:12.111+08:00 | 2020-02-02 22:20:00.123+08:00 | 2020-02-02 01:40:00.099+08:00 | 2020-02-02 12:00:00.123+08:00 | 2020-02-02 12:00:00.123+08:00 | 2030-02-02 12:00:00.123+08:00 | 2030-04-02 12:00:00.123+08:00
(5 rows)
> SELECT ts-'10y',ts-'12mon',ts-'4w',ts-'32d',ts-'24h',ts-'60m',ts-'60s',ts-'1000ms',ts-'10y2mon3w5d10h20m12s600ms',ts-'10y12mon30w5d',ts-'-10y-12mon-30w-5d',ts-'10y12mon5d',ts-'10y12mon12h',ts-'10y12mon12m',ts-'10y12mon12s',ts-'10y12mon12ms',ts-'10h20m12s',ts-'10h20m12ms',ts-'-10h-20m-12ms',ts-'0m12ms',ts-'0h12ms',ts-'10y12ms',ts-'10y2mon12ms' FROM ts_db.st ORDER BY ts;
ERROR: unsupported binary operator: <timestamptz(3)> - <string>
SQLSTATE: 22023
> SELECT ts+10y, ts+12mon,ts+4w,ts+32d,ts+24h,ts+60m,ts+60s,ts+1000ms FROM ts_db.st ORDER BY ts;
            ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?
--------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+--------------------------------
  1834-05-22 16:06:44.254+08:00 | 1825-05-22 16:06:44.254+08:00 | 1824-06-19 16:06:44.254+08:00 | 1824-06-23 16:06:44.254+08:00 | 1824-05-23 16:06:44.254+08:00 | 1824-05-22 17:06:44.254+08:00 | 1824-05-22 16:07:44.254+08:00 | 1824-05-22 16:06:45.254+08:00
  1930-02-02 09:25:43.247+08:00 | 1921-02-02 09:25:43.247+08:00 | 1920-03-01 09:25:43.247+08:00 | 1920-03-05 09:25:43.247+08:00 | 1920-02-03 09:25:43.247+08:00 | 1920-02-02 10:25:43.247+08:00 | 1920-02-02 09:26:43.247+08:00 | 1920-02-02 09:25:44.247+08:00
  2030-02-02 10:02:20.333+08:00 | 2021-02-02 10:02:20.333+08:00 | 2020-03-01 10:02:20.333+08:00 | 2020-03-05 10:02:20.333+08:00 | 2020-02-03 10:02:20.333+08:00 | 2020-02-02 11:02:20.333+08:00 | 2020-02-02 10:03:20.333+08:00 | 2020-02-02 10:02:21.333+08:00
  2030-02-02 11:01:10.222+08:00 | 2021-02-02 11:01:10.222+08:00 | 2020-03-01 11:01:10.222+08:00 | 2020-03-05 11:01:10.222+08:00 | 2020-02-03 11:01:10.222+08:00 | 2020-02-02 12:01:10.222+08:00 | 2020-02-02 11:02:10.222+08:00 | 2020-02-02 11:01:11.222+08:00
  2030-02-02 12:00:00.111+08:00 | 2021-02-02 12:00:00.111+08:00 | 2020-03-01 12:00:00.111+08:00 | 2020-03-05 12:00:00.111+08:00 | 2020-02-03 12:00:00.111+08:00 | 2020-02-02 13:00:00.111+08:00 | 2020-02-02 12:01:00.111+08:00 | 2020-02-02 12:00:01.111+08:00
(5 rows)
> SELECT ts-10y, ts-12mon,ts-4w,ts-32d,ts-24h,ts-60m,ts-60s,ts-1000ms FROM ts_db.st ORDER BY ts;
            ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?            |           ?column?
--------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+--------------------------------
  1814-05-22 16:06:44.254+08:00 | 1823-05-22 16:06:44.254+08:00 | 1824-04-24 16:06:44.254+08:00 | 1824-04-20 16:06:44.254+08:00 | 1824-05-21 16:06:44.254+08:00 | 1824-05-22 15:06:44.254+08:00 | 1824-05-22 16:05:44.254+08:00 | 1824-05-22 16:06:43.254+08:00
  1910-02-02 09:25:43.247+08:00 | 1919-02-02 09:25:43.247+08:00 | 1920-01-05 09:25:43.247+08:00 | 1920-01-01 09:25:43.247+08:00 | 1920-02-01 09:25:43.247+08:00 | 1920-02-02 08:25:43.247+08:00 | 1920-02-02 09:24:43.247+08:00 | 1920-02-02 09:25:42.247+08:00
  2010-02-02 10:02:20.333+08:00 | 2019-02-02 10:02:20.333+08:00 | 2020-01-05 10:02:20.333+08:00 | 2020-01-01 10:02:20.333+08:00 | 2020-02-01 10:02:20.333+08:00 | 2020-02-02 09:02:20.333+08:00 | 2020-02-02 10:01:20.333+08:00 | 2020-02-02 10:02:19.333+08:00
  2010-02-02 11:01:10.222+08:00 | 2019-02-02 11:01:10.222+08:00 | 2020-01-05 11:01:10.222+08:00 | 2020-01-01 11:01:10.222+08:00 | 2020-02-01 11:01:10.222+08:00 | 2020-02-02 10:01:10.222+08:00 | 2020-02-02 11:00:10.222+08:00 | 2020-02-02 11:01:09.222+08:00
  2010-02-02 12:00:00.111+08:00 | 2019-02-02 12:00:00.111+08:00 | 2020-01-05 12:00:00.111+08:00 | 2020-01-01 12:00:00.111+08:00 | 2020-02-01 12:00:00.111+08:00 | 2020-02-02 11:00:00.111+08:00 | 2020-02-02 11:59:00.111+08:00 | 2020-02-02 11:59:59.111+08:00
(5 rows)
> SELECT ts-(TIMESTAMP'2020-1-1 12:12:12.000'-TIMESTAMP'2019-1-1 12:12:12.000') FROM ts_db.st order by ts;
            ?column?
---------------------------------
  1823-05-23 16:06:44.254+08:00
  1919-02-02 09:25:43.247+08:00
  2019-02-02 10:02:20.333+08:00
  2019-02-02 11:01:10.222+08:00
  2019-02-02 12:00:00.111+08:00
(5 rows)
> SELECT ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'10y',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'12mon',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'4w',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'30d',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'24h',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'60m',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'60s',ts-TIMESTAMP'2020-1-1 12:00:12.000'-INTERVAL'1000ms' FROM ts_db.st order by ts;
               ?column?               |              ?column?              |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?          |         ?column?
--------------------------------------+------------------------------------+---------------------------+---------------------------+---------------------------+---------------------------+---------------------------+----------------------------
  -10 years -71445 days -19:53:27.746 | -1 years -71445 days -19:53:27.746 | -71473 days -19:53:27.746 | -71475 days -19:53:27.746 | -71445 days -43:53:27.746 | -71445 days -20:53:27.746 | -71445 days -19:54:27.746 | -71445 days -19:53:28.746
  -10 years -36493 days -02:34:28.753 | -1 years -36493 days -02:34:28.753 | -36521 days -02:34:28.753 | -36523 days -02:34:28.753 | -36493 days -26:34:28.753 | -36493 days -03:34:28.753 | -36493 days -02:35:28.753 | -36493 days -02:34:29.753
  -10 years 31 days +22:02:08.333     | -1 years 31 days +22:02:08.333     | 3 days 22:02:08.333       | 1 day 22:02:08.333        | 31 days -01:57:51.667     | 31 days 21:02:08.333      | 31 days 22:01:08.333      | 31 days 22:02:07.333
  -10 years 31 days +23:00:58.222     | -1 years 31 days +23:00:58.222     | 3 days 23:00:58.222       | 1 day 23:00:58.222        | 31 days -00:59:01.778     | 31 days 22:00:58.222      | 31 days 22:59:58.222      | 31 days 23:00:57.222
  -10 years 31 days +23:59:48.111     | -1 years 31 days +23:59:48.111     | 3 days 23:59:48.111       | 1 day 23:59:48.111        | 31 days -00:00:11.889     | 31 days 22:59:48.111      | 31 days 23:58:48.111      | 31 days 23:59:47.111
(5 rows)
> SELECT first(ts+10y), first(ts+12mon),first(ts+4w),first(ts+32d),first(ts+24h),first(ts+60m),first(ts+60s),first(ts+1000ms) FROM ts_db.st GROUP BY ts ORDER BY ts;
ERROR: at or near "+": syntax error
SQLSTATE: 42601
DETAIL: source SQL:
SELECT first(ts+10y), first(ts+12mon),first(ts+4w),first(ts+32d),first(ts+24h),first(ts+60m),first(ts+60s),first(ts+1000ms) FROM ts_db.st GROUP BY ts ORDER BY ts
               ^
HINT: try \hf first
> SELECT max(ts+10y), max(ts+12mon),max(ts+4w),max(ts+32d),max(ts+24h),max(ts+60m),max(ts+60s),max(ts+1000ms) FROM ts_db.st GROUP BY ts ORDER BY ts;
               max              |              max              |              max              |              max              |              max              |              max              |              max              |              max
--------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+--------------------------------
  1834-05-22 16:06:44.254+08:00 | 1825-05-22 16:06:44.254+08:00 | 1824-06-19 16:06:44.254+08:00 | 1824-06-23 16:06:44.254+08:00 | 1824-05-23 16:06:44.254+08:00 | 1824-05-22 17:06:44.254+08:00 | 1824-05-22 16:07:44.254+08:00 | 1824-05-22 16:06:45.254+08:00
  1930-02-02 09:25:43.247+08:00 | 1921-02-02 09:25:43.247+08:00 | 1920-03-01 09:25:43.247+08:00 | 1920-03-05 09:25:43.247+08:00 | 1920-02-03 09:25:43.247+08:00 | 1920-02-02 10:25:43.247+08:00 | 1920-02-02 09:26:43.247+08:00 | 1920-02-02 09:25:44.247+08:00
  2030-02-02 10:02:20.333+08:00 | 2021-02-02 10:02:20.333+08:00 | 2020-03-01 10:02:20.333+08:00 | 2020-03-05 10:02:20.333+08:00 | 2020-02-03 10:02:20.333+08:00 | 2020-02-02 11:02:20.333+08:00 | 2020-02-02 10:03:20.333+08:00 | 2020-02-02 10:02:21.333+08:00
  2030-02-02 11:01:10.222+08:00 | 2021-02-02 11:01:10.222+08:00 | 2020-03-01 11:01:10.222+08:00 | 2020-03-05 11:01:10.222+08:00 | 2020-02-03 11:01:10.222+08:00 | 2020-02-02 12:01:10.222+08:00 | 2020-02-02 11:02:10.222+08:00 | 2020-02-02 11:01:11.222+08:00
  2030-02-02 12:00:00.111+08:00 | 2021-02-02 12:00:00.111+08:00 | 2020-03-01 12:00:00.111+08:00 | 2020-03-05 12:00:00.111+08:00 | 2020-02-03 12:00:00.111+08:00 | 2020-02-02 13:00:00.111+08:00 | 2020-02-02 12:01:00.111+08:00 | 2020-02-02 12:00:01.111+08:00
(5 rows)
> SELECT min(ts-10y), min(ts-12mon),min(ts-4w),min(ts-32d),min(ts-24h),min(ts-60m),min(ts-60s),min(ts-1000ms) FROM ts_db.st GROUP BY ts ORDER BY ts;
               min              |              min              |              min              |              min              |              min              |              min              |              min              |              min
--------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+-------------------------------+--------------------------------
  1814-05-22 16:06:44.254+08:00 | 1823-05-22 16:06:44.254+08:00 | 1824-04-24 16:06:44.254+08:00 | 1824-04-20 16:06:44.254+08:00 | 1824-05-21 16:06:44.254+08:00 | 1824-05-22 15:06:44.254+08:00 | 1824-05-22 16:05:44.254+08:00 | 1824-05-22 16:06:43.254+08:00
  1910-02-02 09:25:43.247+08:00 | 1919-02-02 09:25:43.247+08:00 | 1920-01-05 09:25:43.247+08:00 | 1920-01-01 09:25:43.247+08:00 | 1920-02-01 09:25:43.247+08:00 | 1920-02-02 08:25:43.247+08:00 | 1920-02-02 09:24:43.247+08:00 | 1920-02-02 09:25:42.247+08:00
  2010-02-02 10:02:20.333+08:00 | 2019-02-02 10:02:20.333+08:00 | 2020-01-05 10:02:20.333+08:00 | 2020-01-01 10:02:20.333+08:00 | 2020-02-01 10:02:20.333+08:00 | 2020-02-02 09:02:20.333+08:00 | 2020-02-02 10:01:20.333+08:00 | 2020-02-02 10:02:19.333+08:00
  2010-02-02 11:01:10.222+08:00 | 2019-02-02 11:01:10.222+08:00 | 2020-01-05 11:01:10.222+08:00 | 2020-01-01 11:01:10.222+08:00 | 2020-02-01 11:01:10.222+08:00 | 2020-02-02 10:01:10.222+08:00 | 2020-02-02 11:00:10.222+08:00 | 2020-02-02 11:01:09.222+08:00
  2010-02-02 12:00:00.111+08:00 | 2019-02-02 12:00:00.111+08:00 | 2020-01-05 12:00:00.111+08:00 | 2020-01-01 12:00:00.111+08:00 | 2020-02-01 12:00:00.111+08:00 | 2020-02-02 11:00:00.111+08:00 | 2020-02-02 11:59:00.111+08:00 | 2020-02-02 11:59:59.111+08:00
(5 rows)
> SELECT count(ts-10y), count(ts-12mon),count(ts-4w),count(ts-32d),count(ts-24h),count(ts-60m),count(ts-60s),count(ts-1000ms) FROM ts_db.st GROUP BY ts ORDER BY ts;
  count | count | count | count | count | count | count | count
--------+-------+-------+-------+-------+-------+-------+--------
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
      1 |     1 |     1 |     1 |     1 |     1 |     1 |     1
(5 rows)
> SELECT max(ts-TIMESTAMPTZ'1970-1-1 01:00:12.000-05:00') FROM ts_db.st GROUP BY ts ORDER BY ts;
             max
-----------------------------
  -53183 days -21:53:27.746
  -18231 days -04:34:28.753
  18293 days 20:02:08.333
  18293 days 21:00:58.222
  18293 days 21:59:48.111
(5 rows)
> SELECT count(ts-TIMESTAMP'1970-1-1 01:00:12.000-05:00') FROM ts_db.st GROUP BY ts ORDER BY ts;
  count
---------
      1
      1
      1
      1
      1
(5 rows)
> DROP DATABASE ts_db;
DROP DATABASE
> SELECT timestamp'2970-01-01 00:00:00' - timestamp'2000-01-01 00:00:00' ;
             ?column?
----------------------------------
  106751 days 23:47:16.854775807
(1 row)
> SELECT '0000-01-01 00:00:00+00:00'::timestamptz - '2020-01-01 12:00:00+00:00'::timestamptz;
              ?column?
------------------------------------
  -106751 days -23:47:16.854775808
(1 row)
> set time zone -15;
ERROR: invalid value for parameter "timezone": "fixed offset:-54000 (-15)"
SQLSTATE: 22023
DETAIL: could not parse -15 as time zone
> set time zone 'a';
ERROR: invalid value for parameter "timezone": "'a'"
SQLSTATE: 22023
DETAIL: cannot find time zone "a": could not parse "a" as time zone
> set time zone 15;
ERROR: invalid value for parameter "timezone": "fixed offset:54000 (15)"
SQLSTATE: 22023
DETAIL: could not parse 15 as time zone
> set time zone -13;
ERROR: invalid value for parameter "timezone": "fixed offset:-46800 (-13)"
SQLSTATE: 22023
DETAIL: could not parse -13 as time zone
> set time zone -1.5;
ERROR: invalid value for parameter "timezone": "fixed offset:-5400 (-1.5)"
SQLSTATE: 22023
DETAIL: could not parse -1.5 as time zone
> set time zone -12;
SET
> set time zone 14;
SET
> set time zone 0;
SET
