> SET extra_float_digits = 0;
SET
> CREATE DATABASE rdb;
CREATE DATABASE
> CREATE TABLE rdb.DeviceModel (
    ModelID int PRIMARY KEY,
    TypeID int,
    ModelName varchar(100),
    TypeName varchar(100)
);
CREATE TABLE
> INSERT INTO rdb.DeviceModel (modelID, TypeID, ModelName,TypeName)
SELECT x,1,'电表模型' || x::string, '电表'
FROM generate_series(1,5) AS t(x);
INSERT 5
> INSERT INTO rdb.DeviceModel (modelID, TypeID, ModelName,TypeName)
SELECT x,2,'变压器模型' || x::string, '变压器'
FROM generate_series(6,10) AS t(x);
INSERT 5
> CREATE TABLE rdb.Device (
    deviceID INT PRIMARY KEY,
    modelID INT,
    installDate DATE,
    location VARCHAR(255),
    FOREIGN KEY (modelID) REFERENCES rdb.DeviceModel(modelID)
);
CREATE TABLE
> INSERT into rdb.Device values(001,1,'2023-07-01','area1');
INSERT 1
> INSERT into rdb.Device values(002,2,'2023-07-01','area2');
INSERT 1
> INSERT into rdb.Device values(003,3,'2023-07-01','area3');
INSERT 1
> INSERT into rdb.Device values(004,4,'2023-07-02','area1');
INSERT 1
> INSERT into rdb.Device values(005,5,'2023-07-04','area1');
INSERT 1
> INSERT into rdb.Device values(006,1,'2023-07-03','area2');
INSERT 1
> INSERT into rdb.Device values(007,2,'2023-07-02','area2');
INSERT 1
> INSERT into rdb.Device values(008,3,'2023-07-04','area3');
INSERT 1
> INSERT into rdb.Device values(009,4,'2023-07-02','area3');
INSERT 1
> INSERT into rdb.Device values(010,5,'2023-07-04','area2');
INSERT 1
> INSERT into rdb.Device values(011,6,'2023-07-01','area2');
INSERT 1
> INSERT into rdb.Device values(012,7,'2023-07-03','area1');
INSERT 1
> INSERT into rdb.Device values(013,8,'2023-07-04','area1');
INSERT 1
> INSERT into rdb.Device values(014,9,'2023-07-02','area2');
INSERT 1
> INSERT into rdb.Device values(015,10,'2023-07-01','area1');
INSERT 1
> INSERT into rdb.Device values(016,6,'2023-07-04','area3');
INSERT 1
> INSERT into rdb.Device values(017,7,'2023-07-03','area1');
INSERT 1
> INSERT into rdb.Device values(018,8,'2023-07-02','area2');
INSERT 1
> INSERT into rdb.Device values(019,9,'2023-07-01','area2');
INSERT 1
> INSERT into rdb.Device values(020,10,'2023-07-04','area1');
INSERT 1
> INSERT into rdb.Device values(021,10,'2023-07-04','area1');
INSERT 1
> create ts DATABASE tsdb;
CREATE TS DATABASE
> CREATE TABLE tsdb.MonitoringCenter (
    ts TIMESTAMP not NULL,
    deviceID INT,
    status INT
)tags (location varchar(64) not null,type varchar(64)) primary tags(location);
CREATE TABLE
> INSERT INTO tsdb.monitoringcenter VALUES ('2023-07-07 23:23:16.210909', 18, 0,'beijing','监控中心');
INSERT 1
> INSERT INTO tsdb.monitoringcenter VALUES ('2023-07-08 04:41:43.513525', 7, -1,'beijing','监控中心');
INSERT 1
> INSERT INTO tsdb.monitoringcenter VALUES ('2023-07-08 14:55:50.421123', 14, 0,'beijing','监控中心');
INSERT 1
> INSERT INTO tsdb.monitoringcenter VALUES ('2023-07-10 00:01:06.132851', 16, -1,'beijing','监控中心');
INSERT 1
> INSERT INTO tsdb.monitoringcenter VALUES ('2023-07-10 04:20:04.337247', 2, 0,'beijing','监控中心');
INSERT 1
> CREATE TABLE tsdb.MeterSuper (
    ts TIMESTAMP not NULL,
    current FLOAT, voltage FLOAT,
    frequency FLOAT ) TAGS (deviceID INT not null,modelId INT not null) primary tags(deviceID,modelId);
CREATE TABLE
> CREATE TABLE tsdb.TransformerSuper (
    ts TIMESTAMP not null ,
    current FLOAT,
    voltage FLOAT,
    frequency FLOAT,
    temperature FLOAT ) TAGS (deviceID INT not null,modelId INT not null) primary tags(deviceID,modelId);
CREATE TABLE
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 05:17:11.598796', 51.3657007868602, 168.1231095847923, 21.94992075582192,001,1);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 16:27:56.456342', 11.3623350383022, 152.52975579257537, 18.31554798487886,001,1);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 18:34:48.360415', 83.4972620588160, 109.48159492640826, 27.324761198065488,001,1);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 19:30:26.451473', 69.6333622281017, 238.1795385905312, 58.909419370691154,001,1);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 02:03:34.87516',  92.1571660223094, 37.317325295080366, 58.7212739638845,001,1);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 04:37:27.129072', 93.3225547467301, 66.65767426868712, 43.90722480110654,001,1);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 04:04:07.143652', 99.4678675025397, 13.025241892819679, 45.782854067873444,001,1);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-08 00:08:14.696399', 28.5696601355255, 140.69022448554762, 16.06097913378548,002,2);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 18:39:30.438076', 4.7143663137418, 73.30383143387422, 8.275714924556183,002,2);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 17:57:30.224437', 12.2075528531539, 129.54033282326606, 18.713733420164118,002,2);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 00:56:27.711008', 26.9682940704655, 221.25241776908553, 22.858753844306392,002,2);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 00:56:07.349385', 77.9899693670714, 193.14937841571833, 15.152851726883938,002,2);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 01:24:52.378961', 11.1845391378352, 39.46096627287062, 0.602579310396294,002,2);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-07 16:13:06.335841', 88.2676084108624, 151.86403428980412, 26.351079855814277,003,3);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-07 16:36:31.394578', 89.7564312801932, 150.9286388179774, 9.724153215641849,003,3);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-08 20:51:54.681879', 5.1943308789773, 63.650041383934024, 52.24253064057123,003,3);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 06:03:05.814713', 19.1017958876088, 115.68571470613875, 1.1906406929428215,003,3);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 18:29:18.422884', 83.6478628663485, 89.68909745421143, 37.59765999821056,003,3);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 03:45:32.968117', 92.1492678972427, 122.08378457767054, 27.42228598926843,003,3);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 05:33:16.169119', 42.5942338040329, 208.61578791825679, 42.02357324911631,003,3);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-08 06:14:37.170895', 64.7608834949323, 11.403069794532996, 6.998607666354104,004,4);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 08:51:17.852436', 86.6408620731391, 144.60721697795435, 50.97251993132019,004,4);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 02:55:40.980745', 50.3771483027861, 161.3108226729517, 57.6755664361319,004,4);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 05:48:09.816847', 70.4166998637219, 38.34458962405762, 16.85200336410034,004,4);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 15:08:47.661363', 38.3605591260021, 154.90060510274617, 47.726143882005516,005,5);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 22:48:17.624277', 55.5757147937953, 105.9471767852645, 29.46434611962374,005,5);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-08 04:18:54.2371',   38.7726102322915, 44.452551510062506, 37.929835054357994,006,1);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-08 23:01:41.986756', 8.0020595087802, 124.82361593824209, 53.82099555672923,006,1);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 22:23:27.094211', 21.2326354535832, 160.2957184770051, 46.04126608033752,006,1);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 00:48:26.702666', 27.4444017465370, 236.3482428866169, 14.455974850198032,006,1);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-08 09:56:25.220454', 32.2432444339341, 177.58638349576614, 3.3144646052362248,007,2);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 07:30:23.077706', 32.5922311651652, 168.70620355188322, 50.64488151265422,007,2);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 23:26:27.903319', 2.5362712857187, 184.42840348813348, 19.7483576372737,007,2);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 06:19:18.907957', 15.9094854493545, 178.5245342931026, 36.93833227226165,007,2);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 20:59:09.024885', 43.7369827209636, 68.60881166210703, 59.894456926545985,008,3);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 06:08:56.78358',  51.4086117972453, 177.3481559228597, 3.010382558704663,008,3);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 05:09:17.234702', 97.2639127907299, 23.33762706075646, 56.938319161331634,008,3);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-05 21:59:04.181575', 1.4552285651376, 113.32679246559366, 30.435887186907138,009,4);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-08 20:39:44.320729', 66.3840449793426, 182.2320607559655, 19.644153989567172,009,4);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 01:08:32.321363', 65.8289096339743, 195.69145838606715, 25.57179586013561,009,4);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 02:36:56.580835', 58.7603069416189, 159.2415972911047, 41.203189272752496,009,4);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 03:13:15.191151', 51.3779408142966, 205.9240838657982, 18.087854549500975,009,4);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-07 17:20:49.140594', 30.1632209734123, 172.39333958402796, 5.5044138372612395,010,5);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 08:29:58.162785', 79.6054423091845, 231.30201854016406, 4.597319670141218,010,5);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-09 11:58:38.783278', 35.0903702996475, 42.154668081937245, 54.7685818789391,010,5);
INSERT 1
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-10 02:25:17.443994', 27.6364208231029, 154.3673060297445, 26.535563164735407,010,5);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 11:02:45.648432', 62.07842324087949, 90.32647676303242, 5.2488945576412505, 14.258898967639908,011,6);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 15:28:55.104231', 17.06637837986058, 142.44160208902713, 34.591380565349894, 21.119144923832494,011,6);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 04:58:21.719843', 92.25295471123367, 7.462731969278593, 50.92098064216266, 34.36563673165921,011,6);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-06 13:07:03.931919', 65.48081994336954, 188.2567527939338, 36.3655120695077, 3.4270151228768952,012,7);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 01:06:58.703196', 55.34867698580612, 72.40931028350673, 53.71553807319458, 3.7044275575844665,012,7);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 15:52:46.964902', 17.312386131568047, 195.57991222777645, 49.669131142369736, 10.483555552490174,012,7);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 21:43:54.889776', 85.58101910367206, 43.27803927302, 56.33795256303635, 38.31035323909134,012,7);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 04:08:50.57425', 17.398723556827278, 153.22633009602612, 11.45598498035433, 22.81971080834012,012,7);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-04 23:31:56.375171', 52.66458023829017, 90.29668184077906, 59.79066216659831, 29.722281663583914,013,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-07 08:03:17.177078', 43.96180865146384, 154.08019995405937, 18.43868808781785, 19.90639126594772,013,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-07 22:21:08.138838', 99.02138838252128, 223.71390545879052, 20.056195602708726, 15.238958313498614,013,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-08 16:59:52.728693', 60.54882232393375, 205.1858911185957, 19.85350199922358, 4.2600144450656785,013,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 20:33:49.564525', 15.245646381004008, 118.97958802680506, 5.033308167484023, 5.173988849891913,013,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 21:39:27.497345', 5.298795986209015, 163.30937120600368, 6.26727010942794, 7.4077283998133225,013,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 21:51:01.906044', 1.4700570958964931, 61.281910675128586, 20.885973192990406, 36.19385306158179,013,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 23:24:07.371084', 77.87625532148503, 112.8121161342392, 29.57175230887806, 3.7888085173906916,013,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 00:43:24.784041', 17.944334196761247, 62.09330906849601, 12.67792894618296, 16.370919752266246,013,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-08 00:12:44.891526', 29.141342330967035, 210.57264099760317, 55.87475999983724, 0.8872604651996596,014,9);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-08 17:02:57.967638', 55.861789989643995, 49.21382837566824, 10.050729726989687, 27.853727800951305,014,9);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-08 21:35:55.53145', 4.419608514891493, 128.98575536071803, 40.54320515432444, 35.673271601207546,014,9);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 12:59:55.047625', 10.658966522300162, 34.36371792002092, 36.054631460578506, 0.8882621813293667,014,9);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 12:53:43.162267', 0.832251979106502, 210.96849156906188, 7.079982839455994, 20.594480582398234,014,9);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 12:39:09.233924', 93.55229687398712, 221.38709657104926, 5.651785607203621, 30.081871012820898,014,9);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 01:32:00.465653', 56.33623462371027, 197.8153665633306, 0.12888790457715515, 19.984287824026694,014,9);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 00:59:30.129295', 40.284123214722456, 95.55812731279872, 30.168265976603976, 28.379620596021056,014,9);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-08 21:00:47.29422', 32.90240154925641, 7.325592204106499, 10.417407156383973, 8.326718062503033,015,10);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 21:14:38.358985', 66.9504922275415, 31.954296677230047, 52.917001772298136, 16.144134625639452,015,10);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 04:50:14.701774', 51.74081587970605, 225.54199375949992, 33.6010026825349, 9.984459670006203,015,10);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 06:17:09.386495', 82.79836774723499, 74.3088997740017, 14.858983253662146, 16.935362895877404,015,10);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-08 16:14:12.921932', 36.09092394088478, 108.39520722419337, 25.335029508743503, 38.21809137759246,016,6);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 00:30:42.935178', 20.78304951765162, 215.61307198766684, 54.555908978046546, 4.02753975120433,016,6);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 19:41:34.607783', 35.83891266157195, 123.09969886987602, 3.8893447610068677, 19.25033076157277,016,6);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 03:04:43.064627', 25.060728129290055, 168.2589500097859, 38.01445660686667, 12.739341182518302,016,6);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 03:06:00.512731', 50.771485089709145, 144.99413205257952, 58.65062395303319, 5.220398496930159,016,6);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 05:38:07.210942', 11.986872694219386, 120.1265712304425, 43.56598628018105, 16.070285819936743,016,6);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-05 19:06:03.818329', 24.987985173545724, 72.9023828811242, 16.973064797835633, 36.293677843691654,017,7);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-07 15:25:08.655828', 80.70288139874826, 226.76149960639748, 22.536435359695517, 17.602529048121482,017,7);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 16:03:27.033861', 87.27905262816087, 206.0703472669354, 19.650004737152145, 23.924112292515645,017,7);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 19:28:09.125524', 91.5020840605461, 220.6248576001525, 22.413093079713846, 31.84150123087136,017,7);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 19:16:34.71569', 79.06313290189892, 236.1186641981095, 11.429809386155725, 1.0275678498294383,017,7);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 19:19:38.862837', 3.273131553499198, 70.03972367014512, 58.98496325869537, 37.186032602606076,017,7);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 19:19:44.244468', 37.8918817740594, 161.35502082836354, 58.180074981489085, 14.735220601556307,017,7);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-07 23:53:58.049632', 25.080051494014555, 131.9743131559457, 34.81001821039513, 29.42230105166729,018,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 11:04:00.447746', 85.23375508716988, 19.436503499836135, 37.700593790189956, 8.991060302139147,018,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 20:05:51.09422', 88.20280845651922, 97.64938995519202, 38.45793498252661, 20.427684033114843,018,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 21:14:41.547481', 53.912778954858354, 108.51135844595831, 39.49629354672162, 12.141814707802041,018,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 00:31:23.234403', 91.83096434802565, 98.20607678802872, 8.917065537194588, 14.635690609361092,018,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 01:53:16.059696', 90.7270041420773, 47.37665748498699, 58.14147201029144, 21.628951126758835,018,8);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 23:54:00.036213', 91.90978517570159, 89.82349051872717, 9.816515594798574, 28.385429384530454,019,9);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 06:06:57.554089', 73.23775705733766, 233.65862651811682, 18.125960923250233, 15.367487286523698,019,9);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-07 01:58:30.973539', 22.71351816345728, 20.663093027703496, 50.3940697076095, 15.98260864725475,020,10);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-07 16:34:00.391646', 45.23884339183191, 99.00457899838102, 56.80338537583516, 8.004371769193597,020,10);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-09 16:03:06.617241', 31.504070234340986, 127.98633740808924, 8.428259533187799, 37.91307500839949,020,10);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 06:16:57.57278', 19.012564333445425, 200.65811585260263, 7.407489418857125, 1.784382784184828,020,10);
INSERT 1
> INSERT INTO tsdb.TransformerSuper VALUES ('2023-07-10 05:32:26.735818', 34.23666579094089, 136.83684208696292, 42.117931529613344, 14.656870311446397,020,10);
INSERT 1
> SELECT COUNT(*) from tsdb.MeterSuper;
  count
---------
     46
(1 row)
> SELECT COUNT(*) from tsdb.TransformerSuper;
  count
---------
     55
(1 row)
> SELECT d.deviceID, d.installDate, ms.voltage
FROM rdb.Device AS d
INNER JOIN tsdb.MeterSuper AS ms ON d.deviceID = ms.deviceID
WHERE ms.ts = (SELECT MAX(ts) FROM tsdb.MeterSuper WHERE deviceID = d.deviceID)
ORDER BY d.deviceID;
  deviceid |        installdate        |     voltage
-----------+---------------------------+-------------------
         1 | 2023-07-01 00:00:00+00:00 | 66.6576742686871
         2 | 2023-07-01 00:00:00+00:00 | 39.4609662728706
         3 | 2023-07-01 00:00:00+00:00 | 208.615787918257
         4 | 2023-07-02 00:00:00+00:00 | 38.3445896240576
         5 | 2023-07-04 00:00:00+00:00 | 105.947176785265
         6 | 2023-07-03 00:00:00+00:00 | 236.348242886617
         7 | 2023-07-02 00:00:00+00:00 | 178.524534293103
         8 | 2023-07-04 00:00:00+00:00 |  177.34815592286
         9 | 2023-07-02 00:00:00+00:00 | 205.924083865798
        10 | 2023-07-04 00:00:00+00:00 | 154.367306029744
(10 rows)
> SELECT d.deviceID, dm.TypeName, dm.ModelName
FROM rdb.Device AS d
INNER JOIN rdb.DeviceModel AS dm ON d.modelID = dm.modelID
INNER JOIN tsdb.MonitoringCenter AS mc ON d.deviceID = mc.deviceID
WHERE mc.status = -1
ORDER BY d.deviceID;
  deviceid | typename |  modelname
-----------+----------+--------------
         7 | 电表     | 电表模型2
        16 | 变压器   | 变压器模型6
(2 rows)
> SELECT d.location, ts.temperature
FROM rdb.Device AS d
INNER JOIN tsdb.TransformerSuper AS ts ON d.deviceID = ts.deviceID
WHERE ts.ts = (SELECT MAX(ts) FROM tsdb.TransformerSuper WHERE deviceID = d.deviceID)
ORDER BY d.deviceID;
  location |   temperature
-----------+-------------------
  area2    | 34.3656367316592
  area1    | 22.8197108083401
  area1    | 16.3709197522662
  area2    | 19.9842878240267
  area1    | 16.9353628958774
  area3    | 16.0702858199367
  area1    | 31.8415012308714
  area2    | 21.6289511267588
  area2    | 15.3674872865237
  area1    | 1.78438278418483
(10 rows)
> SELECT d.deviceID, dm.ModelName, ms.current
FROM rdb.Device AS d
INNER JOIN rdb.DeviceModel AS dm ON d.modelID = dm.modelID
INNER JOIN tsdb.MeterSuper AS ms ON d.deviceID = ms.deviceID
WHERE ms.ts = (SELECT MAX(ts) FROM tsdb.MeterSuper WHERE deviceID = d.deviceID)
ORDER BY d.deviceID;
  deviceid | modelname |     current
-----------+-----------+-------------------
         1 | 电表模型1 | 93.3225547467301
         2 | 电表模型2 | 11.1845391378352
         3 | 电表模型3 | 42.5942338040329
         4 | 电表模型4 | 70.4166998637219
         5 | 电表模型5 | 55.5757147937953
         6 | 电表模型1 |  27.444401746537
         7 | 电表模型2 | 15.9094854493545
         8 | 电表模型3 | 51.4086117972453
         9 | 电表模型4 | 51.3779408142966
        10 | 电表模型5 | 27.6364208231029
(10 rows)
> SELECT d.deviceID, dm.ModelName, mc.status
FROM rdb.Device AS d
LEFT JOIN rdb.DeviceModel AS dm ON d.modelID = dm.modelID
LEFT JOIN tsdb.MonitoringCenter AS mc ON d.deviceID = mc.deviceID
WHERE mc.ts = (SELECT MAX(ts) FROM tsdb.MonitoringCenter WHERE deviceID = d.deviceID)
ORDER BY d.deviceID;
  deviceid |  modelname  | status
-----------+-------------+---------
         2 | 电表模型2   |      0
         7 | 电表模型2   |     -1
        14 | 变压器模型9 |      0
        16 | 变压器模型6 |     -1
        18 | 变压器模型8 |      0
(5 rows)
> SELECT d.deviceID, dm.ModelName, ms.voltage
FROM rdb.DeviceModel AS dm
LEFT JOIN rdb.Device AS d ON dm.modelID = d.modelID
LEFT JOIN tsdb.MeterSuper AS ms ON d.deviceID = ms.deviceID
WHERE ms.ts = (SELECT MAX(ts) FROM tsdb.MeterSuper WHERE deviceID = d.deviceID)
ORDER BY d.deviceID;
  deviceid | modelname |     voltage
-----------+-----------+-------------------
         1 | 电表模型1 | 66.6576742686871
         2 | 电表模型2 | 39.4609662728706
         3 | 电表模型3 | 208.615787918257
         4 | 电表模型4 | 38.3445896240576
         5 | 电表模型5 | 105.947176785265
         6 | 电表模型1 | 236.348242886617
         7 | 电表模型2 | 178.524534293103
         8 | 电表模型3 |  177.34815592286
         9 | 电表模型4 | 205.924083865798
        10 | 电表模型5 | 154.367306029744
(10 rows)
> SELECT d.deviceID, d.location, ts.temperature
FROM rdb.Device AS d
LEFT JOIN tsdb.TransformerSuper AS ts ON d.deviceID = ts.deviceID
WHERE ts.ts = (SELECT MAX(ts) FROM tsdb.TransformerSuper WHERE deviceID = d.deviceID)
ORDER BY d.deviceID;
  deviceid | location |   temperature
-----------+----------+-------------------
        11 | area2    | 34.3656367316592
        12 | area1    | 22.8197108083401
        13 | area1    | 16.3709197522662
        14 | area2    | 19.9842878240267
        15 | area1    | 16.9353628958774
        16 | area3    | 16.0702858199367
        17 | area1    | 31.8415012308714
        18 | area2    | 21.6289511267588
        19 | area2    | 15.3674872865237
        20 | area1    | 1.78438278418483
(10 rows)
> SELECT d.deviceID, dm.ModelName, ms.current
FROM rdb.DeviceModel AS dm
LEFT JOIN rdb.Device AS d ON dm.modelID = d.modelID
LEFT JOIN tsdb.MeterSuper AS ms ON d.deviceID = ms.deviceID
WHERE ms.ts = (SELECT MAX(ts) FROM tsdb.MeterSuper WHERE deviceID = d.deviceID)
ORDER BY d.deviceID;
  deviceid | modelname |     current
-----------+-----------+-------------------
         1 | 电表模型1 | 93.3225547467301
         2 | 电表模型2 | 11.1845391378352
         3 | 电表模型3 | 42.5942338040329
         4 | 电表模型4 | 70.4166998637219
         5 | 电表模型5 | 55.5757147937953
         6 | 电表模型1 |  27.444401746537
         7 | 电表模型2 | 15.9094854493545
         8 | 电表模型3 | 51.4086117972453
         9 | 电表模型4 | 51.3779408142966
        10 | 电表模型5 | 27.6364208231029
(10 rows)
> SELECT d.deviceID, mc.status, dm.ModelName
FROM rdb.DeviceModel AS dm
RIGHT JOIN rdb.Device AS d ON dm.modelID = d.modelID
RIGHT JOIN tsdb.MonitoringCenter AS mc ON d.deviceID = mc.deviceID
ORDER BY d.deviceID, mc.status, dm.ModelName;
  deviceid | status |  modelname
-----------+--------+--------------
         2 |      0 | 电表模型2
         7 |     -1 | 电表模型2
        14 |      0 | 变压器模型9
        16 |     -1 | 变压器模型6
        18 |      0 | 变压器模型8
(5 rows)
> SELECT d.deviceID, ms.voltage, d.installDate
FROM rdb.Device AS d
RIGHT JOIN tsdb.MeterSuper AS ms ON d.deviceID = ms.deviceID
ORDER BY d.deviceID, ms.voltage, d.installDate;
  deviceid |     voltage      |        installdate
-----------+------------------+----------------------------
         1 | 13.0252418928197 | 2023-07-01 00:00:00+00:00
         1 | 37.3173252950804 | 2023-07-01 00:00:00+00:00
         1 | 66.6576742686871 | 2023-07-01 00:00:00+00:00
         1 | 109.481594926408 | 2023-07-01 00:00:00+00:00
         1 | 152.529755792575 | 2023-07-01 00:00:00+00:00
         1 | 168.123109584792 | 2023-07-01 00:00:00+00:00
         1 | 238.179538590531 | 2023-07-01 00:00:00+00:00
         2 | 39.4609662728706 | 2023-07-01 00:00:00+00:00
         2 | 73.3038314338742 | 2023-07-01 00:00:00+00:00
         2 | 129.540332823266 | 2023-07-01 00:00:00+00:00
         2 | 140.690224485548 | 2023-07-01 00:00:00+00:00
         2 | 193.149378415718 | 2023-07-01 00:00:00+00:00
         2 | 221.252417769086 | 2023-07-01 00:00:00+00:00
         3 |  63.650041383934 | 2023-07-01 00:00:00+00:00
         3 | 89.6890974542114 | 2023-07-01 00:00:00+00:00
         3 | 115.685714706139 | 2023-07-01 00:00:00+00:00
         3 | 122.083784577671 | 2023-07-01 00:00:00+00:00
         3 | 150.928638817977 | 2023-07-01 00:00:00+00:00
         3 | 151.864034289804 | 2023-07-01 00:00:00+00:00
         3 | 208.615787918257 | 2023-07-01 00:00:00+00:00
         4 |  11.403069794533 | 2023-07-02 00:00:00+00:00
         4 | 38.3445896240576 | 2023-07-02 00:00:00+00:00
         4 | 144.607216977954 | 2023-07-02 00:00:00+00:00
         4 | 161.310822672952 | 2023-07-02 00:00:00+00:00
         5 | 105.947176785265 | 2023-07-04 00:00:00+00:00
         5 | 154.900605102746 | 2023-07-04 00:00:00+00:00
         6 | 44.4525515100625 | 2023-07-03 00:00:00+00:00
         6 | 124.823615938242 | 2023-07-03 00:00:00+00:00
         6 | 160.295718477005 | 2023-07-03 00:00:00+00:00
         6 | 236.348242886617 | 2023-07-03 00:00:00+00:00
         7 | 168.706203551883 | 2023-07-02 00:00:00+00:00
         7 | 177.586383495766 | 2023-07-02 00:00:00+00:00
         7 | 178.524534293103 | 2023-07-02 00:00:00+00:00
         7 | 184.428403488133 | 2023-07-02 00:00:00+00:00
         8 | 23.3376270607565 | 2023-07-04 00:00:00+00:00
         8 |  68.608811662107 | 2023-07-04 00:00:00+00:00
         8 |  177.34815592286 | 2023-07-04 00:00:00+00:00
         9 | 113.326792465594 | 2023-07-02 00:00:00+00:00
         9 | 159.241597291105 | 2023-07-02 00:00:00+00:00
         9 | 182.232060755966 | 2023-07-02 00:00:00+00:00
         9 | 195.691458386067 | 2023-07-02 00:00:00+00:00
         9 | 205.924083865798 | 2023-07-02 00:00:00+00:00
        10 | 42.1546680819372 | 2023-07-04 00:00:00+00:00
        10 | 154.367306029744 | 2023-07-04 00:00:00+00:00
        10 | 172.393339584028 | 2023-07-04 00:00:00+00:00
        10 | 231.302018540164 | 2023-07-04 00:00:00+00:00
(46 rows)
> SELECT d.deviceID, ts.temperature, d.location
FROM rdb.Device AS d
RIGHT JOIN tsdb.TransformerSuper AS ts ON d.deviceID = ts.deviceID
ORDER BY d.deviceID, ts.temperature, d.location;
  deviceid |    temperature    | location
-----------+-------------------+-----------
        11 |  14.2588989676399 | area2
        11 |  21.1191449238325 | area2
        11 |  34.3656367316592 | area2
        12 |   3.4270151228769 | area1
        12 |  3.70442755758447 | area1
        12 |  10.4835555524902 | area1
        12 |  22.8197108083401 | area1
        12 |  38.3103532390913 | area1
        13 |  3.78880851739069 | area1
        13 |  4.26001444506568 | area1
        13 |  5.17398884989191 | area1
        13 |  7.40772839981332 | area1
        13 |  15.2389583134986 | area1
        13 |  16.3709197522662 | area1
        13 |  19.9063912659477 | area1
        13 |  29.7222816635839 | area1
        13 |  36.1938530615818 | area1
        14 |  0.88726046519966 | area2
        14 | 0.888262181329367 | area2
        14 |  19.9842878240267 | area2
        14 |  20.5944805823982 | area2
        14 |  27.8537278009513 | area2
        14 |  28.3796205960211 | area2
        14 |  30.0818710128209 | area2
        14 |  35.6732716012075 | area2
        15 |  8.32671806250303 | area1
        15 |   9.9844596700062 | area1
        15 |  16.1441346256395 | area1
        15 |  16.9353628958774 | area1
        16 |  4.02753975120433 | area3
        16 |  5.22039849693016 | area3
        16 |  12.7393411825183 | area3
        16 |  16.0702858199367 | area3
        16 |  19.2503307615728 | area3
        16 |  38.2180913775925 | area3
        17 |  1.02756784982944 | area1
        17 |  14.7352206015563 | area1
        17 |  17.6025290481215 | area1
        17 |  23.9241122925156 | area1
        17 |  31.8415012308714 | area1
        17 |  36.2936778436917 | area1
        17 |  37.1860326026061 | area1
        18 |  8.99106030213915 | area2
        18 |   12.141814707802 | area2
        18 |  14.6356906093611 | area2
        18 |  20.4276840331148 | area2
        18 |  21.6289511267588 | area2
        18 |  29.4223010516673 | area2
        19 |  15.3674872865237 | area2
        19 |  28.3854293845305 | area2
        20 |  1.78438278418483 | area1
        20 |   8.0043717691936 | area1
        20 |  14.6568703114464 | area1
        20 |  15.9826086472548 | area1
        20 |  37.9130750083995 | area1
(55 rows)
> SELECT d.deviceID, ms.current, dm.ModelName
FROM rdb.DeviceModel AS dm
RIGHT JOIN rdb.Device AS d ON dm.modelID = d.modelID
RIGHT JOIN tsdb.MeterSuper AS ms ON d.deviceID = ms.deviceID
ORDER BY d.deviceID, ms.current, dm.ModelName;
  deviceid |     current      | modelname
-----------+------------------+------------
         1 | 11.3623350383022 | 电表模型1
         1 | 51.3657007868602 | 电表模型1
         1 | 69.6333622281017 | 电表模型1
         1 |  83.497262058816 | 电表模型1
         1 | 92.1571660223094 | 电表模型1
         1 | 93.3225547467301 | 电表模型1
         1 | 99.4678675025397 | 电表模型1
         2 |  4.7143663137418 | 电表模型2
         2 | 11.1845391378352 | 电表模型2
         2 | 12.2075528531539 | 电表模型2
         2 | 26.9682940704655 | 电表模型2
         2 | 28.5696601355255 | 电表模型2
         2 | 77.9899693670714 | 电表模型2
         3 |  5.1943308789773 | 电表模型3
         3 | 19.1017958876088 | 电表模型3
         3 | 42.5942338040329 | 电表模型3
         3 | 83.6478628663485 | 电表模型3
         3 | 88.2676084108624 | 电表模型3
         3 | 89.7564312801932 | 电表模型3
         3 | 92.1492678972427 | 电表模型3
         4 | 50.3771483027861 | 电表模型4
         4 | 64.7608834949323 | 电表模型4
         4 | 70.4166998637219 | 电表模型4
         4 | 86.6408620731391 | 电表模型4
         5 | 38.3605591260021 | 电表模型5
         5 | 55.5757147937953 | 电表模型5
         6 |  8.0020595087802 | 电表模型1
         6 | 21.2326354535832 | 电表模型1
         6 |  27.444401746537 | 电表模型1
         6 | 38.7726102322915 | 电表模型1
         7 |  2.5362712857187 | 电表模型2
         7 | 15.9094854493545 | 电表模型2
         7 | 32.2432444339341 | 电表模型2
         7 | 32.5922311651652 | 电表模型2
         8 | 43.7369827209636 | 电表模型3
         8 | 51.4086117972453 | 电表模型3
         8 | 97.2639127907299 | 电表模型3
         9 |  1.4552285651376 | 电表模型4
         9 | 51.3779408142966 | 电表模型4
         9 | 58.7603069416189 | 电表模型4
         9 | 65.8289096339743 | 电表模型4
         9 | 66.3840449793426 | 电表模型4
        10 | 27.6364208231029 | 电表模型5
        10 | 30.1632209734123 | 电表模型5
        10 | 35.0903702996475 | 电表模型5
        10 | 79.6054423091845 | 电表模型5
(46 rows)
> SELECT d.deviceID, mc.status, dm.ModelName
FROM rdb.DeviceModel AS dm
FULL JOIN rdb.Device AS d ON dm.modelID = d.modelID
FULL JOIN tsdb.MonitoringCenter AS mc ON d.deviceID = mc.deviceID
ORDER BY d.deviceID, mc.status, dm.ModelName;
  deviceid | status |  modelname
-----------+--------+---------------
         1 | NULL   | 电表模型1
         2 |      0 | 电表模型2
         3 | NULL   | 电表模型3
         4 | NULL   | 电表模型4
         5 | NULL   | 电表模型5
         6 | NULL   | 电表模型1
         7 |     -1 | 电表模型2
         8 | NULL   | 电表模型3
         9 | NULL   | 电表模型4
        10 | NULL   | 电表模型5
        11 | NULL   | 变压器模型6
        12 | NULL   | 变压器模型7
        13 | NULL   | 变压器模型8
        14 |      0 | 变压器模型9
        15 | NULL   | 变压器模型10
        16 |     -1 | 变压器模型6
        17 | NULL   | 变压器模型7
        18 |      0 | 变压器模型8
        19 | NULL   | 变压器模型9
        20 | NULL   | 变压器模型10
        21 | NULL   | 变压器模型10
(21 rows)
> SELECT d.deviceID, ms.voltage, d.installDate
FROM rdb.Device AS d
FULL JOIN tsdb.MeterSuper AS ms ON d.deviceID = ms.deviceID
ORDER BY d.deviceID, ms.voltage, d.installDate;
  deviceid |     voltage      |        installdate
-----------+------------------+----------------------------
         1 | 13.0252418928197 | 2023-07-01 00:00:00+00:00
         1 | 37.3173252950804 | 2023-07-01 00:00:00+00:00
         1 | 66.6576742686871 | 2023-07-01 00:00:00+00:00
         1 | 109.481594926408 | 2023-07-01 00:00:00+00:00
         1 | 152.529755792575 | 2023-07-01 00:00:00+00:00
         1 | 168.123109584792 | 2023-07-01 00:00:00+00:00
         1 | 238.179538590531 | 2023-07-01 00:00:00+00:00
         2 | 39.4609662728706 | 2023-07-01 00:00:00+00:00
         2 | 73.3038314338742 | 2023-07-01 00:00:00+00:00
         2 | 129.540332823266 | 2023-07-01 00:00:00+00:00
         2 | 140.690224485548 | 2023-07-01 00:00:00+00:00
         2 | 193.149378415718 | 2023-07-01 00:00:00+00:00
         2 | 221.252417769086 | 2023-07-01 00:00:00+00:00
         3 |  63.650041383934 | 2023-07-01 00:00:00+00:00
         3 | 89.6890974542114 | 2023-07-01 00:00:00+00:00
         3 | 115.685714706139 | 2023-07-01 00:00:00+00:00
         3 | 122.083784577671 | 2023-07-01 00:00:00+00:00
         3 | 150.928638817977 | 2023-07-01 00:00:00+00:00
         3 | 151.864034289804 | 2023-07-01 00:00:00+00:00
         3 | 208.615787918257 | 2023-07-01 00:00:00+00:00
         4 |  11.403069794533 | 2023-07-02 00:00:00+00:00
         4 | 38.3445896240576 | 2023-07-02 00:00:00+00:00
         4 | 144.607216977954 | 2023-07-02 00:00:00+00:00
         4 | 161.310822672952 | 2023-07-02 00:00:00+00:00
         5 | 105.947176785265 | 2023-07-04 00:00:00+00:00
         5 | 154.900605102746 | 2023-07-04 00:00:00+00:00
         6 | 44.4525515100625 | 2023-07-03 00:00:00+00:00
         6 | 124.823615938242 | 2023-07-03 00:00:00+00:00
         6 | 160.295718477005 | 2023-07-03 00:00:00+00:00
         6 | 236.348242886617 | 2023-07-03 00:00:00+00:00
         7 | 168.706203551883 | 2023-07-02 00:00:00+00:00
         7 | 177.586383495766 | 2023-07-02 00:00:00+00:00
         7 | 178.524534293103 | 2023-07-02 00:00:00+00:00
         7 | 184.428403488133 | 2023-07-02 00:00:00+00:00
         8 | 23.3376270607565 | 2023-07-04 00:00:00+00:00
         8 |  68.608811662107 | 2023-07-04 00:00:00+00:00
         8 |  177.34815592286 | 2023-07-04 00:00:00+00:00
         9 | 113.326792465594 | 2023-07-02 00:00:00+00:00
         9 | 159.241597291105 | 2023-07-02 00:00:00+00:00
         9 | 182.232060755966 | 2023-07-02 00:00:00+00:00
         9 | 195.691458386067 | 2023-07-02 00:00:00+00:00
         9 | 205.924083865798 | 2023-07-02 00:00:00+00:00
        10 | 42.1546680819372 | 2023-07-04 00:00:00+00:00
        10 | 154.367306029744 | 2023-07-04 00:00:00+00:00
        10 | 172.393339584028 | 2023-07-04 00:00:00+00:00
        10 | 231.302018540164 | 2023-07-04 00:00:00+00:00
        11 | NULL             | 2023-07-01 00:00:00+00:00
        12 | NULL             | 2023-07-03 00:00:00+00:00
        13 | NULL             | 2023-07-04 00:00:00+00:00
        14 | NULL             | 2023-07-02 00:00:00+00:00
        15 | NULL             | 2023-07-01 00:00:00+00:00
        16 | NULL             | 2023-07-04 00:00:00+00:00
        17 | NULL             | 2023-07-03 00:00:00+00:00
        18 | NULL             | 2023-07-02 00:00:00+00:00
        19 | NULL             | 2023-07-01 00:00:00+00:00
        20 | NULL             | 2023-07-04 00:00:00+00:00
        21 | NULL             | 2023-07-04 00:00:00+00:00
(57 rows)
> SELECT d.deviceID, ts.temperature, d.location
FROM rdb.Device AS d
FULL JOIN tsdb.TransformerSuper AS ts ON d.deviceID = ts.deviceID
ORDER BY d.deviceID, ts.temperature, d.location;
  deviceid |    temperature    | location
-----------+-------------------+-----------
         1 | NULL              | area1
         2 | NULL              | area2
         3 | NULL              | area3
         4 | NULL              | area1
         5 | NULL              | area1
         6 | NULL              | area2
         7 | NULL              | area2
         8 | NULL              | area3
         9 | NULL              | area3
        10 | NULL              | area2
        11 |  14.2588989676399 | area2
        11 |  21.1191449238325 | area2
        11 |  34.3656367316592 | area2
        12 |   3.4270151228769 | area1
        12 |  3.70442755758447 | area1
        12 |  10.4835555524902 | area1
        12 |  22.8197108083401 | area1
        12 |  38.3103532390913 | area1
        13 |  3.78880851739069 | area1
        13 |  4.26001444506568 | area1
        13 |  5.17398884989191 | area1
        13 |  7.40772839981332 | area1
        13 |  15.2389583134986 | area1
        13 |  16.3709197522662 | area1
        13 |  19.9063912659477 | area1
        13 |  29.7222816635839 | area1
        13 |  36.1938530615818 | area1
        14 |  0.88726046519966 | area2
        14 | 0.888262181329367 | area2
        14 |  19.9842878240267 | area2
        14 |  20.5944805823982 | area2
        14 |  27.8537278009513 | area2
        14 |  28.3796205960211 | area2
        14 |  30.0818710128209 | area2
        14 |  35.6732716012075 | area2
        15 |  8.32671806250303 | area1
        15 |   9.9844596700062 | area1
        15 |  16.1441346256395 | area1
        15 |  16.9353628958774 | area1
        16 |  4.02753975120433 | area3
        16 |  5.22039849693016 | area3
        16 |  12.7393411825183 | area3
        16 |  16.0702858199367 | area3
        16 |  19.2503307615728 | area3
        16 |  38.2180913775925 | area3
        17 |  1.02756784982944 | area1
        17 |  14.7352206015563 | area1
        17 |  17.6025290481215 | area1
        17 |  23.9241122925156 | area1
        17 |  31.8415012308714 | area1
        17 |  36.2936778436917 | area1
        17 |  37.1860326026061 | area1
        18 |  8.99106030213915 | area2
        18 |   12.141814707802 | area2
        18 |  14.6356906093611 | area2
        18 |  20.4276840331148 | area2
        18 |  21.6289511267588 | area2
        18 |  29.4223010516673 | area2
        19 |  15.3674872865237 | area2
        19 |  28.3854293845305 | area2
        20 |  1.78438278418483 | area1
        20 |   8.0043717691936 | area1
        20 |  14.6568703114464 | area1
        20 |  15.9826086472548 | area1
        20 |  37.9130750083995 | area1
        21 | NULL              | area1
(66 rows)
> SELECT d.deviceID, ms.current, dm.ModelName
FROM rdb.DeviceModel AS dm
FULL JOIN rdb.Device AS d ON dm.modelID = d.modelID
FULL JOIN tsdb.MeterSuper AS ms ON d.deviceID = ms.deviceID
ORDER BY d.deviceID, ms.current, dm.ModelName;
  deviceid |     current      |  modelname
-----------+------------------+---------------
         1 | 11.3623350383022 | 电表模型1
         1 | 51.3657007868602 | 电表模型1
         1 | 69.6333622281017 | 电表模型1
         1 |  83.497262058816 | 电表模型1
         1 | 92.1571660223094 | 电表模型1
         1 | 93.3225547467301 | 电表模型1
         1 | 99.4678675025397 | 电表模型1
         2 |  4.7143663137418 | 电表模型2
         2 | 11.1845391378352 | 电表模型2
         2 | 12.2075528531539 | 电表模型2
         2 | 26.9682940704655 | 电表模型2
         2 | 28.5696601355255 | 电表模型2
         2 | 77.9899693670714 | 电表模型2
         3 |  5.1943308789773 | 电表模型3
         3 | 19.1017958876088 | 电表模型3
         3 | 42.5942338040329 | 电表模型3
         3 | 83.6478628663485 | 电表模型3
         3 | 88.2676084108624 | 电表模型3
         3 | 89.7564312801932 | 电表模型3
         3 | 92.1492678972427 | 电表模型3
         4 | 50.3771483027861 | 电表模型4
         4 | 64.7608834949323 | 电表模型4
         4 | 70.4166998637219 | 电表模型4
         4 | 86.6408620731391 | 电表模型4
         5 | 38.3605591260021 | 电表模型5
         5 | 55.5757147937953 | 电表模型5
         6 |  8.0020595087802 | 电表模型1
         6 | 21.2326354535832 | 电表模型1
         6 |  27.444401746537 | 电表模型1
         6 | 38.7726102322915 | 电表模型1
         7 |  2.5362712857187 | 电表模型2
         7 | 15.9094854493545 | 电表模型2
         7 | 32.2432444339341 | 电表模型2
         7 | 32.5922311651652 | 电表模型2
         8 | 43.7369827209636 | 电表模型3
         8 | 51.4086117972453 | 电表模型3
         8 | 97.2639127907299 | 电表模型3
         9 |  1.4552285651376 | 电表模型4
         9 | 51.3779408142966 | 电表模型4
         9 | 58.7603069416189 | 电表模型4
         9 | 65.8289096339743 | 电表模型4
         9 | 66.3840449793426 | 电表模型4
        10 | 27.6364208231029 | 电表模型5
        10 | 30.1632209734123 | 电表模型5
        10 | 35.0903702996475 | 电表模型5
        10 | 79.6054423091845 | 电表模型5
        11 | NULL             | 变压器模型6
        12 | NULL             | 变压器模型7
        13 | NULL             | 变压器模型8
        14 | NULL             | 变压器模型9
        15 | NULL             | 变压器模型10
        16 | NULL             | 变压器模型6
        17 | NULL             | 变压器模型7
        18 | NULL             | 变压器模型8
        19 | NULL             | 变压器模型9
        20 | NULL             | 变压器模型10
        21 | NULL             | 变压器模型10
(57 rows)
> SELECT ModelName,
       (SELECT COUNT(*) FROM rdb.Device WHERE modelID = dm.modelID) AS DeviceCount
FROM rdb.DeviceModel AS dm ORDER by ModelName;
   modelname   | devicecount
---------------+--------------
  变压器模型10 |           3
  变压器模型6  |           2
  变压器模型7  |           2
  变压器模型8  |           2
  变压器模型9  |           2
  电表模型1    |           2
  电表模型2    |           2
  电表模型3    |           2
  电表模型4    |           2
  电表模型5    |           2
(10 rows)
> SELECT ModelName,
       (SELECT MAX(installDate) FROM rdb.Device WHERE modelID = dm.modelID) AS LatestInstallDate
FROM rdb.DeviceModel AS dm ORDER by ModelName;
   modelname   |     latestinstalldate
---------------+----------------------------
  变压器模型10 | 2023-07-04 00:00:00+00:00
  变压器模型6  | 2023-07-04 00:00:00+00:00
  变压器模型7  | 2023-07-03 00:00:00+00:00
  变压器模型8  | 2023-07-04 00:00:00+00:00
  变压器模型9  | 2023-07-02 00:00:00+00:00
  电表模型1    | 2023-07-03 00:00:00+00:00
  电表模型2    | 2023-07-02 00:00:00+00:00
  电表模型3    | 2023-07-04 00:00:00+00:00
  电表模型4    | 2023-07-02 00:00:00+00:00
  电表模型5    | 2023-07-04 00:00:00+00:00
(10 rows)
> SELECT d.deviceID,
       (SELECT MAX(current) FROM tsdb.MeterSuper WHERE deviceID = d.deviceID) AS LatestCurrent
FROM rdb.Device AS d ORDER by d.deviceID;
  deviceid |  latestcurrent
-----------+-------------------
         1 | 99.4678675025397
         2 | 77.9899693670714
         3 | 92.1492678972427
         4 | 86.6408620731391
         5 | 55.5757147937953
         6 | 38.7726102322915
         7 | 32.5922311651652
         8 | 97.2639127907299
         9 | 66.3840449793426
        10 | 79.6054423091845
        11 | NULL
        12 | NULL
        13 | NULL
        14 | NULL
        15 | NULL
        16 | NULL
        17 | NULL
        18 | NULL
        19 | NULL
        20 | NULL
        21 | NULL
(21 rows)
> SELECT d.deviceID,
       (SELECT MAX(voltage) FROM tsdb.MeterSuper WHERE deviceID = d.deviceID) AS LatestVoltage
FROM rdb.Device AS d ORDER by d.deviceID;
  deviceid |  latestvoltage
-----------+-------------------
         1 | 238.179538590531
         2 | 221.252417769086
         3 | 208.615787918257
         4 | 161.310822672952
         5 | 154.900605102746
         6 | 236.348242886617
         7 | 184.428403488133
         8 |  177.34815592286
         9 | 205.924083865798
        10 | 231.302018540164
        11 | NULL
        12 | NULL
        13 | NULL
        14 | NULL
        15 | NULL
        16 | NULL
        17 | NULL
        18 | NULL
        19 | NULL
        20 | NULL
        21 | NULL
(21 rows)
> SELECT d.deviceID,
       (SELECT MAX(frequency) FROM tsdb.MeterSuper WHERE deviceID = d.deviceID) AS LatestFrequency
FROM rdb.Device AS d ORDER by d.deviceID;
  deviceid | latestfrequency
-----------+-------------------
         1 | 58.9094193706912
         2 | 22.8587538443064
         3 | 52.2425306405712
         4 | 57.6755664361319
         5 | 47.7261438820055
         6 | 53.8209955567292
         7 | 50.6448815126542
         8 |  59.894456926546
         9 | 41.2031892727525
        10 | 54.7685818789391
        11 | NULL
        12 | NULL
        13 | NULL
        14 | NULL
        15 | NULL
        16 | NULL
        17 | NULL
        18 | NULL
        19 | NULL
        20 | NULL
        21 | NULL
(21 rows)
> SELECT d.deviceID,
       (SELECT MAX(status) FROM tsdb.MonitoringCenter WHERE deviceID = d.deviceID) AS LatestStatus
FROM rdb.Device AS d ORDER by d.deviceID;
  deviceid | lateststatus
-----------+---------------
         1 | NULL
         2 |            0
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 |           -1
         8 | NULL
         9 | NULL
        10 | NULL
        11 | NULL
        12 | NULL
        13 | NULL
        14 |            0
        15 | NULL
        16 |           -1
        17 | NULL
        18 |            0
        19 | NULL
        20 | NULL
        21 | NULL
(21 rows)
> SELECT d.deviceID,
       (SELECT MAX(temperature) FROM tsdb.TransformerSuper WHERE deviceID = d.deviceID) AS LatestTemperature
FROM rdb.Device AS d ORDER by d.deviceID;
  deviceid | latesttemperature
-----------+--------------------
         1 | NULL
         2 | NULL
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 | NULL
         8 | NULL
         9 | NULL
        10 | NULL
        11 |  34.3656367316592
        12 |  38.3103532390913
        13 |  36.1938530615818
        14 |  35.6732716012075
        15 |  16.9353628958774
        16 |  38.2180913775925
        17 |  37.1860326026061
        18 |  29.4223010516673
        19 |  28.3854293845305
        20 |  37.9130750083995
        21 | NULL
(21 rows)
> SELECT ModelName,
       (SELECT AVG(current) FROM tsdb.MeterSuper WHERE deviceID IN 
            (SELECT deviceID FROM rdb.Device WHERE modelID = dm.modelID)) AS AvgCurrent
FROM rdb.DeviceModel AS dm ORDER by ModelName;
   modelname   |    avgcurrent
---------------+-------------------
  变压器模型10 | NULL
  变压器模型6  | NULL
  变压器模型7  | NULL
  变压器模型8  | NULL
  变压器模型9  | NULL
  电表模型1    | 54.2052686658956
  电表模型2    | 24.4915614211966
  电表模型3    | 61.3121038334205
  电表模型4    | 57.3335582965499
  电表模型5    | 44.4052880541908
(10 rows)
> SELECT ModelName,
       (SELECT AVG(voltage) FROM tsdb.MeterSuper WHERE deviceID IN 
            (SELECT deviceID FROM rdb.Device WHERE modelID = dm.modelID)) AS AvgVoltage
FROM rdb.DeviceModel AS dm ORDER by ModelName;
   modelname   |    avgvoltage
---------------+-------------------
  变压器模型10 | NULL
  变压器模型6  | NULL
  变压器模型7  | NULL
  变压器模型8  | NULL
  变压器模型9  | NULL
  电表模型1    | 122.839488105711
  电表模型2    | 150.664267602925
  电表模型3    | 117.181169379372
  电表模型4    | 134.675743537114
  电表模型5    | 143.510852353981
(10 rows)
> SELECT ModelName,
       (SELECT AVG(frequency) FROM tsdb.MeterSuper WHERE deviceID IN 
            (SELECT deviceID FROM rdb.Device WHERE modelID = dm.modelID)) AS AvgFrequency
FROM rdb.DeviceModel AS dm ORDER by ModelName;
   modelname   |   avgfrequency
---------------+-------------------
  变压器模型10 | NULL
  变压器模型6  | NULL
  变压器模型7  | NULL
  变压器模型8  | NULL
  变压器模型9  | NULL
  电表模型1    | 38.8326430621768
  电表模型2    | 19.2310648387518
  电表模型3    | 31.6395082288148
  电表模型4    | 29.7157309174189
  电表模型5    | 28.0993947587844
(10 rows)
> SELECT * FROM rdb.Device
WHERE deviceID IN (
    SELECT deviceID FROM tsdb.MonitoringCenter 
    WHERE ts BETWEEN '2023-07-02' AND '2023-07-05'
) ORDER by deviceID,modelID,installDate,location;
  deviceid | modelid | installdate | location
-----------+---------+-------------+-----------
(0 rows)
> SELECT * FROM rdb.Device
WHERE deviceID IN (
    SELECT deviceID FROM tsdb.MeterSuper 
    WHERE current > 10
) ORDER by deviceID,modelID,installDate,location;
  deviceid | modelid |        installdate        | location
-----------+---------+---------------------------+-----------
         1 |       1 | 2023-07-01 00:00:00+00:00 | area1
         2 |       2 | 2023-07-01 00:00:00+00:00 | area2
         3 |       3 | 2023-07-01 00:00:00+00:00 | area3
         4 |       4 | 2023-07-02 00:00:00+00:00 | area1
         5 |       5 | 2023-07-04 00:00:00+00:00 | area1
         6 |       1 | 2023-07-03 00:00:00+00:00 | area2
         7 |       2 | 2023-07-02 00:00:00+00:00 | area2
         8 |       3 | 2023-07-04 00:00:00+00:00 | area3
         9 |       4 | 2023-07-02 00:00:00+00:00 | area3
        10 |       5 | 2023-07-04 00:00:00+00:00 | area2
(10 rows)
> SELECT * FROM tsdb.MonitoringCenter
WHERE deviceID IN (
    SELECT deviceID FROM rdb.Device 
    WHERE modelID = 1
) ORDER by deviceID,status,ts;
  ts | deviceid | status | location | type
-----+----------+--------+----------+-------
(0 rows)
> SELECT * FROM rdb.Device
WHERE deviceID IN (
    SELECT deviceID FROM tsdb.MonitoringCenter 
    WHERE status = -1
) ORDER by deviceID,modelID,installDate,location;
  deviceid | modelid |        installdate        | location
-----------+---------+---------------------------+-----------
         7 |       2 | 2023-07-02 00:00:00+00:00 | area2
        16 |       6 | 2023-07-04 00:00:00+00:00 | area3
(2 rows)
> SELECT * FROM rdb.Device
WHERE deviceID IN (
    SELECT deviceID FROM tsdb.TransformerSuper 
    WHERE voltage > 110
) ORDER by deviceID,modelID,installDate,location;
  deviceid | modelid |        installdate        | location
-----------+---------+---------------------------+-----------
        11 |       6 | 2023-07-01 00:00:00+00:00 | area2
        12 |       7 | 2023-07-03 00:00:00+00:00 | area1
        13 |       8 | 2023-07-04 00:00:00+00:00 | area1
        14 |       9 | 2023-07-02 00:00:00+00:00 | area2
        15 |      10 | 2023-07-01 00:00:00+00:00 | area1
        16 |       6 | 2023-07-04 00:00:00+00:00 | area3
        17 |       7 | 2023-07-03 00:00:00+00:00 | area1
        18 |       8 | 2023-07-02 00:00:00+00:00 | area2
        19 |       9 | 2023-07-01 00:00:00+00:00 | area2
        20 |      10 | 2023-07-04 00:00:00+00:00 | area1
(10 rows)
> SELECT * FROM tsdb.MonitoringCenter
WHERE deviceID IN (
    SELECT deviceID FROM rdb.Device 
    WHERE installDate BETWEEN '2023-07-01' AND '2023-07-05'
) ORDER by deviceID,status,ts;
               ts               | deviceid | status | location |   type
--------------------------------+----------+--------+----------+-----------
  2023-07-10 04:20:04.337+00:00 |        2 |      0 | beijing  | 监控中心
  2023-07-08 04:41:43.514+00:00 |        7 |     -1 | beijing  | 监控中心
  2023-07-08 14:55:50.421+00:00 |       14 |      0 | beijing  | 监控中心
  2023-07-10 00:01:06.133+00:00 |       16 |     -1 | beijing  | 监控中心
  2023-07-07 23:23:16.211+00:00 |       18 |      0 | beijing  | 监控中心
(5 rows)
> SELECT * FROM tsdb.MonitoringCenter
WHERE deviceID IN (
    SELECT deviceID FROM rdb.Device 
    WHERE location = 'area1'
)ORDER by deviceID,status,ts;
  ts | deviceid | status | location | type
-----+----------+--------+----------+-------
(0 rows)
> SELECT * FROM rdb.Device
WHERE deviceID IN (
    SELECT deviceID FROM tsdb.MonitoringCenter 
    WHERE status = -1
) AND location = 'area1' ORDER by deviceID,modelID,installDate,location;
  deviceid | modelid | installdate | location
-----------+---------+-------------+-----------
(0 rows)
> SELECT * FROM rdb.Device
WHERE deviceID IN (
    SELECT deviceID FROM tsdb.MeterSuper 
    WHERE voltage > 110 AND ts BETWEEN '2023-07-02' AND '2023-07-07'
) ORDER by deviceID,modelID,installDate,location;
  deviceid | modelid |        installdate        | location
-----------+---------+---------------------------+-----------
         9 |       4 | 2023-07-02 00:00:00+00:00 | area3
(1 row)
> SELECT * FROM tsdb.MonitoringCenter
WHERE deviceID IN (
    SELECT deviceID FROM rdb.Device 
    WHERE modelID IN (
        SELECT modelID FROM rdb.DeviceModel
        WHERE TypeName = '电表'
    ) AND location = 'area1'
)ORDER by deviceID,status,ts;
  ts | deviceid | status | location | type
-----+----------+--------+----------+-------
(0 rows)
> SELECT rdb.Device.deviceID, AVG(tsdb.MeterSuper.current) AS avg_current
FROM rdb.Device, tsdb.MeterSuper
WHERE rdb.Device.deviceID = tsdb.MeterSuper.deviceID
GROUP BY rdb.Device.deviceID
HAVING AVG(tsdb.MeterSuper.current) > 
  (SELECT AVG(current) FROM tsdb.MeterSuper)
ORDER BY rdb.Device.deviceID;
  deviceid |   avg_current
-----------+-------------------
         1 | 71.5437497690942
         3 | 60.1016472893237
         4 | 68.0488984336449
         8 | 64.1365024363129
         9 |  48.761286186874
(5 rows)
> SELECT rdb.Device.deviceID, AVG(tsdb.MeterSuper.voltage) AS avg_voltage
FROM rdb.Device, tsdb.MeterSuper
WHERE rdb.Device.deviceID = tsdb.MeterSuper.deviceID
GROUP BY rdb.Device.deviceID
HAVING AVG(tsdb.MeterSuper.voltage) < 
  (SELECT AVG(voltage) FROM tsdb.MeterSuper)
ORDER BY rdb.Device.deviceID;
  deviceid |   avg_voltage
-----------+-------------------
         1 | 112.187748621556
         3 | 128.931014163999
         4 | 88.9164247673742
         5 | 130.423890944005
         8 | 89.7648648819077
(5 rows)
> SELECT rdb.Device.deviceID, AVG(tsdb.MeterSuper.frequency) AS avg_frequency
FROM rdb.Device, tsdb.MeterSuper
WHERE rdb.Device.deviceID = tsdb.MeterSuper.deviceID
GROUP BY rdb.Device.deviceID
HAVING AVG(tsdb.MeterSuper.frequency) > 
  (SELECT AVG(frequency) FROM tsdb.MeterSuper)
ORDER BY rdb.Device.deviceID;
  deviceid |  avg_frequency
-----------+-------------------
         1 |  39.273000306046
         4 | 33.1246743494766
         5 | 38.5952450008146
         6 | 38.0620178854057
         8 | 39.9477195488608
(5 rows)
> SELECT rdb.Device.deviceID, MAX(tsdb.TransformerSuper.temperature) AS max_temperature
FROM rdb.Device, tsdb.TransformerSuper
WHERE rdb.Device.deviceID = tsdb.TransformerSuper.deviceID
GROUP BY rdb.Device.deviceID
HAVING MAX(tsdb.TransformerSuper.temperature) < 
  (SELECT MAX(temperature) FROM tsdb.TransformerSuper)
ORDER BY rdb.Device.deviceID;
  deviceid | max_temperature
-----------+-------------------
        11 | 34.3656367316592
        13 | 36.1938530615818
        14 | 35.6732716012075
        15 | 16.9353628958774
        16 | 38.2180913775925
        17 | 37.1860326026061
        18 | 29.4223010516673
        19 | 28.3854293845305
        20 | 37.9130750083995
(9 rows)
> SELECT rdb.Device.deviceID, MIN(tsdb.TransformerSuper.temperature) AS min_temperature
FROM rdb.Device, tsdb.TransformerSuper
WHERE rdb.Device.deviceID = tsdb.TransformerSuper.deviceID
GROUP BY rdb.Device.deviceID
HAVING MIN(tsdb.TransformerSuper.temperature) > 
  (SELECT MIN(temperature) FROM tsdb.TransformerSuper)
ORDER BY rdb.Device.deviceID;
  deviceid | min_temperature
-----------+-------------------
        11 | 14.2588989676399
        12 |  3.4270151228769
        13 | 3.78880851739069
        15 | 8.32671806250303
        16 | 4.02753975120433
        17 | 1.02756784982944
        18 | 8.99106030213915
        19 | 15.3674872865237
        20 | 1.78438278418483
(9 rows)
> SELECT m.ts, AVG(m.current) AS avg_current
FROM tsdb.MeterSuper as m, rdb.Device
WHERE m.deviceID=3 and m.modelID=3 and rdb.Device.deviceID = 3 AND rdb.Device.modelID = 3
GROUP BY m.ts
HAVING AVG(m.current) >
  (SELECT AVG(current) FROM tsdb.MeterSuper)
ORDER BY m.ts;
               ts               |   avg_current
--------------------------------+-------------------
  2023-07-07 16:13:06.336+00:00 | 88.2676084108624
  2023-07-07 16:36:31.395+00:00 | 89.7564312801932
  2023-07-09 18:29:18.423+00:00 | 83.6478628663485
  2023-07-10 03:45:32.968+00:00 | 92.1492678972427
(4 rows)
> SELECT m.ts, MAX(m.voltage) AS max_voltage
FROM tsdb.MeterSuper as m, rdb.Device
WHERE m.deviceID=2 and m.modelID=2 and rdb.Device.deviceID = 2 AND rdb.Device.modelID = 2
GROUP BY m.ts
HAVING MAX(m.voltage) <
  (SELECT MAX(voltage) FROM tsdb.MeterSuper)
ORDER BY m.ts;
               ts               |   max_voltage
--------------------------------+-------------------
  2023-07-08 00:08:14.696+00:00 | 140.690224485548
  2023-07-09 17:57:30.224+00:00 | 129.540332823266
  2023-07-09 18:39:30.438+00:00 | 73.3038314338742
  2023-07-10 00:56:07.349+00:00 | 193.149378415718
  2023-07-10 00:56:27.711+00:00 | 221.252417769086
  2023-07-10 01:24:52.379+00:00 | 39.4609662728706
(6 rows)
> SELECT t.ts, MIN(t.frequency) AS min_frequency
FROM tsdb.TransformerSuper as t, rdb.Device
WHERE t.deviceID=17 and t.modelID=7 and rdb.Device.deviceID = 7 AND rdb.Device.modelID = 7
GROUP BY t.ts
HAVING MIN(t.frequency) >
  (SELECT MIN(frequency) FROM tsdb.TransformerSuper)
ORDER BY t.ts;
  ts | min_frequency
-----+----------------
(0 rows)
> SELECT t.ts, AVG(t.temperature) AS avg_temperature
FROM tsdb.TransformerSuper as t, rdb.Device
WHERE t.deviceID=18 and t.modelID=8 and rdb.Device.deviceID = 8 AND rdb.Device.modelID = 8
GROUP BY t.ts
HAVING AVG(t.temperature) <
  (SELECT AVG(temperature) FROM tsdb.TransformerSuper)
ORDER BY t.ts;
  ts | avg_temperature
-----+------------------
(0 rows)
> SELECT t.ts, MAX(t.current) AS max_current
FROM tsdb.TransformerSuper as t, rdb.Device
WHERE t.deviceID=20 and t.modelID=10 and rdb.Device.deviceID = 10 AND rdb.Device.modelID = 10
GROUP BY t.ts
HAVING MAX(t.current) >
  (SELECT MAX(current)

 FROM tsdb.TransformerSuper)
ORDER BY t.ts;
  ts | max_current
-----+--------------
(0 rows)
> SELECT dm.TypeName
FROM rdb.DeviceModel dm
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MeterSuper ms
    WHERE ms.deviceID = dm.modelID
) order by typename;
  typename
------------
  变压器
  变压器
  变压器
  变压器
  变压器
  电表
  电表
  电表
  电表
  电表
(10 rows)
> SELECT d.location
FROM rdb.Device d
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
    AND mc.status = -1
) ORDER by d.location;
  location
------------
  area2
  area3
(2 rows)
> SELECT dm.TypeName, d.location
FROM rdb.DeviceModel dm
JOIN rdb.Device d ON dm.ModelID = d.modelID
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MeterSuper ms
    WHERE ms.deviceID = d.deviceID
    AND ms.current > 100
);
  typename | location
-----------+-----------
(0 rows)
> SELECT ms.deviceID, ms.ts
FROM tsdb.MeterSuper ms
WHERE EXISTS (
    SELECT 1
    FROM rdb.Device d
    WHERE d.deviceID = ms.deviceID
    AND d.installDate = ms.ts::date
) ORDER by ts;
  deviceid | ts
-----------+-----
(0 rows)
> SELECT dm.TypeName, ts.temperature
FROM rdb.DeviceModel dm
JOIN tsdb.TransformerSuper ts ON dm.ModelID = ts.modelId
WHERE EXISTS (
    SELECT 1
    FROM rdb.Device d
    WHERE d.modelID = dm.ModelID
    AND d.deviceID = ts.deviceID
) ORDER by dm.TypeName, ts.temperature;
  typename |    temperature
-----------+--------------------
  变压器   |  0.88726046519966
  变压器   | 0.888262181329367
  变压器   |  1.02756784982944
  变压器   |  1.78438278418483
  变压器   |   3.4270151228769
  变压器   |  3.70442755758447
  变压器   |  3.78880851739069
  变压器   |  4.02753975120433
  变压器   |  4.26001444506568
  变压器   |  5.17398884989191
  变压器   |  5.22039849693016
  变压器   |  7.40772839981332
  变压器   |   8.0043717691936
  变压器   |  8.32671806250303
  变压器   |  8.99106030213915
  变压器   |   9.9844596700062
  变压器   |  10.4835555524902
  变压器   |   12.141814707802
  变压器   |  12.7393411825183
  变压器   |  14.2588989676399
  变压器   |  14.6356906093611
  变压器   |  14.6568703114464
  变压器   |  14.7352206015563
  变压器   |  15.2389583134986
  变压器   |  15.3674872865237
  变压器   |  15.9826086472548
  变压器   |  16.0702858199367
  变压器   |  16.1441346256395
  变压器   |  16.3709197522662
  变压器   |  16.9353628958774
  变压器   |  17.6025290481215
  变压器   |  19.2503307615728
  变压器   |  19.9063912659477
  变压器   |  19.9842878240267
  变压器   |  20.4276840331148
  变压器   |  20.5944805823982
  变压器   |  21.1191449238325
  变压器   |  21.6289511267588
  变压器   |  22.8197108083401
  变压器   |  23.9241122925156
  变压器   |  27.8537278009513
  变压器   |  28.3796205960211
  变压器   |  28.3854293845305
  变压器   |  29.4223010516673
  变压器   |  29.7222816635839
  变压器   |  30.0818710128209
  变压器   |  31.8415012308714
  变压器   |  34.3656367316592
  变压器   |  35.6732716012075
  变压器   |  36.1938530615818
  变压器   |  36.2936778436917
  变压器   |  37.1860326026061
  变压器   |  37.9130750083995
  变压器   |  38.2180913775925
  变压器   |  38.3103532390913
(55 rows)
> SELECT dm.TypeName
FROM rdb.DeviceModel dm
JOIN rdb.Device d ON dm.ModelID = d.modelID
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MeterSuper ms
    WHERE ms.deviceID = d.deviceID
    AND ms.voltage > 200
);
  typename
------------
  电表
  电表
  电表
  电表
  电表
  电表
(6 rows)
> SELECT dm.TypeName, ts.frequency
FROM rdb.DeviceModel dm
JOIN tsdb.TransformerSuper ts ON dm.ModelID = ts.modelId
WHERE EXISTS (
    SELECT 1
    FROM rdb.Device d
    WHERE
 d.modelID = dm.ModelID
    AND d.deviceID = ts.deviceID
) ORDER by dm.TypeName, ts.frequency;
  typename |     frequency
-----------+--------------------
  变压器   | 0.128887904577155
  变压器   |  3.88934476100687
  变压器   |  5.03330816748402
  变压器   |  5.24889455764125
  变压器   |  5.65178560720362
  变压器   |  6.26727010942794
  变压器   |  7.07998283945599
  变压器   |  7.40748941885712
  变压器   |   8.4282595331878
  变压器   |  8.91706553719459
  变压器   |  9.81651559479857
  变压器   |  10.0507297269897
  变压器   |   10.417407156384
  变压器   |  11.4298093861557
  变压器   |  11.4559849803543
  变压器   |   12.677928946183
  变压器   |  14.8589832536621
  变压器   |  16.9730647978356
  变压器   |  18.1259609232502
  变压器   |  18.4386880878179
  变压器   |  19.6500047371521
  变压器   |  19.8535019992236
  变压器   |  20.0561956027087
  变压器   |  20.8859731929904
  变压器   |  22.4130930797138
  变压器   |  22.5364353596955
  变压器   |  25.3350295087435
  变压器   |  29.5717523088781
  变压器   |   30.168265976604
  变压器   |  33.6010026825349
  变压器   |  34.5913805653499
  变压器   |  34.8100182103951
  变压器   |  36.0546314605785
  变压器   |  36.3655120695077
  变压器   |    37.70059379019
  变压器   |  38.0144566068667
  变压器   |  38.4579349825266
  变压器   |  39.4962935467216
  变压器   |  40.5432051543244
  变压器   |  42.1179315296133
  变压器   |  43.5659862801811
  变压器   |  49.6691311423697
  变压器   |  50.3940697076095
  变压器   |  50.9209806421627
  变压器   |  52.9170017722981
  变压器   |  53.7155380731946
  变压器   |  54.5559089780465
  变压器   |  55.8747599998372
  变压器   |  56.3379525630364
  变压器   |  56.8033853758352
  变压器   |  58.1414720102914
  变压器   |  58.1800749814891
  变压器   |  58.6506239530332
  变压器   |  58.9849632586954
  变压器   |  59.7906621665983
(55 rows)
> SELECT dm.TypeName
FROM rdb.DeviceModel dm
JOIN rdb.Device d ON dm.ModelID = d.modelID
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
    GROUP BY mc.deviceID
    HAVING COUNT(*) > 5
);
  typename
------------
(0 rows)
> SELECT dm.TypeName
FROM rdb.DeviceModel dm
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MeterSuper ms
    JOIN rdb.Device d ON d.deviceID = ms.deviceID
    WHERE d.modelID = dm.ModelID
    GROUP BY ms.deviceID
    HAVING COUNT(*) >= 3
);
  typename
------------
  电表
  电表
  电表
  电表
  电表
(5 rows)
> SELECT dm.ModelName, dm.TypeName, m.current
FROM rdb.DeviceModel dm
JOIN tsdb.MeterSuper m ON dm.modelID = m.modelID
WHERE EXISTS (
    SELECT 1
    FROM rdb.Device d
    WHERE d.modelID = dm.modelID
)
ORDER BY m.deviceID ASC,current;
  modelname | typename |     current
------------+----------+-------------------
  电表模型1 | 电表     | 11.3623350383022
  电表模型1 | 电表     | 51.3657007868602
  电表模型1 | 电表     | 69.6333622281017
  电表模型1 | 电表     |  83.497262058816
  电表模型1 | 电表     | 92.1571660223094
  电表模型1 | 电表     | 93.3225547467301
  电表模型1 | 电表     | 99.4678675025397
  电表模型2 | 电表     |  4.7143663137418
  电表模型2 | 电表     | 11.1845391378352
  电表模型2 | 电表     | 12.2075528531539
  电表模型2 | 电表     | 26.9682940704655
  电表模型2 | 电表     | 28.5696601355255
  电表模型2 | 电表     | 77.9899693670714
  电表模型3 | 电表     |  5.1943308789773
  电表模型3 | 电表     | 19.1017958876088
  电表模型3 | 电表     | 42.5942338040329
  电表模型3 | 电表     | 83.6478628663485
  电表模型3 | 电表     | 88.2676084108624
  电表模型3 | 电表     | 89.7564312801932
  电表模型3 | 电表     | 92.1492678972427
  电表模型4 | 电表     | 50.3771483027861
  电表模型4 | 电表     | 64.7608834949323
  电表模型4 | 电表     | 70.4166998637219
  电表模型4 | 电表     | 86.6408620731391
  电表模型5 | 电表     | 38.3605591260021
  电表模型5 | 电表     | 55.5757147937953
  电表模型1 | 电表     |  8.0020595087802
  电表模型1 | 电表     | 21.2326354535832
  电表模型1 | 电表     |  27.444401746537
  电表模型1 | 电表     | 38.7726102322915
  电表模型2 | 电表     |  2.5362712857187
  电表模型2 | 电表     | 15.9094854493545
  电表模型2 | 电表     | 32.2432444339341
  电表模型2 | 电表     | 32.5922311651652
  电表模型3 | 电表     | 43.7369827209636
  电表模型3 | 电表     | 51.4086117972453
  电表模型3 | 电表     | 97.2639127907299
  电表模型4 | 电表     |  1.4552285651376
  电表模型4 | 电表     | 51.3779408142966
  电表模型4 | 电表     | 58.7603069416189
  电表模型4 | 电表     | 65.8289096339743
  电表模型4 | 电表     | 66.3840449793426
  电表模型5 | 电表     | 27.6364208231029
  电表模型5 | 电表     | 30.1632209734123
  电表模型5 | 电表     | 35.0903702996475
  电表模型5 | 电表     | 79.6054423091845
(46 rows)
> SELECT d.installDate, t.temperature, t.voltage
FROM rdb.Device d
JOIN tsdb.TransformerSuper t ON d.deviceID = t.deviceID
WHERE EXISTS (
    SELECT 1
    FROM rdb.DeviceModel dm
    WHERE dm.modelID = d.modelID
        AND dm.TypeName = '变压器'
)
ORDER BY d.deviceID DESC,voltage;
         installdate        |    temperature    |     voltage
----------------------------+-------------------+-------------------
  2023-07-04 00:00:00+00:00 |  15.9826086472548 | 20.6630930277035
  2023-07-04 00:00:00+00:00 |   8.0043717691936 |  99.004578998381
  2023-07-04 00:00:00+00:00 |  37.9130750083995 | 127.986337408089
  2023-07-04 00:00:00+00:00 |  14.6568703114464 | 136.836842086963
  2023-07-04 00:00:00+00:00 |  1.78438278418483 | 200.658115852603
  2023-07-01 00:00:00+00:00 |  28.3854293845305 | 89.8234905187272
  2023-07-01 00:00:00+00:00 |  15.3674872865237 | 233.658626518117
  2023-07-02 00:00:00+00:00 |  8.99106030213915 | 19.4365034998361
  2023-07-02 00:00:00+00:00 |  21.6289511267588 |  47.376657484987
  2023-07-02 00:00:00+00:00 |  20.4276840331148 |  97.649389955192
  2023-07-02 00:00:00+00:00 |  14.6356906093611 | 98.2060767880287
  2023-07-02 00:00:00+00:00 |   12.141814707802 | 108.511358445958
  2023-07-02 00:00:00+00:00 |  29.4223010516673 | 131.974313155946
  2023-07-03 00:00:00+00:00 |  37.1860326026061 | 70.0397236701451
  2023-07-03 00:00:00+00:00 |  36.2936778436917 | 72.9023828811242
  2023-07-03 00:00:00+00:00 |  14.7352206015563 | 161.355020828364
  2023-07-03 00:00:00+00:00 |  23.9241122925156 | 206.070347266935
  2023-07-03 00:00:00+00:00 |  31.8415012308714 | 220.624857600152
  2023-07-03 00:00:00+00:00 |  17.6025290481215 | 226.761499606397
  2023-07-03 00:00:00+00:00 |  1.02756784982944 |  236.11866419811
  2023-07-04 00:00:00+00:00 |  38.2180913775925 | 108.395207224193
  2023-07-04 00:00:00+00:00 |  16.0702858199367 | 120.126571230442
  2023-07-04 00:00:00+00:00 |  19.2503307615728 | 123.099698869876
  2023-07-04 00:00:00+00:00 |  5.22039849693016 |  144.99413205258
  2023-07-04 00:00:00+00:00 |  12.7393411825183 | 168.258950009786
  2023-07-04 00:00:00+00:00 |  4.02753975120433 | 215.613071987667
  2023-07-01 00:00:00+00:00 |  8.32671806250303 |  7.3255922041065
  2023-07-01 00:00:00+00:00 |  16.1441346256395 |   31.95429667723
  2023-07-01 00:00:00+00:00 |  16.9353628958774 | 74.3088997740017
  2023-07-01 00:00:00+00:00 |   9.9844596700062 |   225.5419937595
  2023-07-02 00:00:00+00:00 | 0.888262181329367 | 34.3637179200209
  2023-07-02 00:00:00+00:00 |  27.8537278009513 | 49.2138283756682
  2023-07-02 00:00:00+00:00 |  28.3796205960211 | 95.5581273127987
  2023-07-02 00:00:00+00:00 |  35.6732716012075 | 128.985755360718
  2023-07-02 00:00:00+00:00 |  19.9842878240267 | 197.815366563331
  2023-07-02 00:00:00+00:00 |  0.88726046519966 | 210.572640997603
  2023-07-02 00:00:00+00:00 |  20.5944805823982 | 210.968491569062
  2023-07-02 00:00:00+00:00 |  30.0818710128209 | 221.387096571049
  2023-07-04 00:00:00+00:00 |  36.1938530615818 | 61.2819106751286
  2023-07-04 00:00:00+00:00 |  16.3709197522662 |  62.093309068496
  2023-07-04 00:00:00+00:00 |  29.7222816635839 | 90.2966818407791
  2023-07-04 00:00:00+00:00 |  3.78880851739069 | 112.812116134239
  2023-07-04 00:00:00+00:00 |  5.17398884989191 | 118.979588026805
  2023-07-04 00:00:00+00:00 |  19.9063912659477 | 154.080199954059
  2023-07-04 00:00:00+00:00 |  7.40772839981332 | 163.309371206004
  2023-07-04 00:00:00+00:00 |  4.26001444506568 | 205.185891118596
  2023-07-04 00:00:00+00:00 |  15.2389583134986 | 223.713905458791
  2023-07-03 00:00:00+00:00 |  38.3103532390913 |   43.27803927302
  2023-07-03 00:00:00+00:00 |  3.70442755758447 | 72.4093102835067
  2023-07-03 00:00:00+00:00 |  22.8197108083401 | 153.226330096026
  2023-07-03 00:00:00+00:00 |   3.4270151228769 | 188.256752793934
  2023-07-03 00:00:00+00:00 |  10.4835555524902 | 195.579912227776
  2023-07-01 00:00:00+00:00 |  34.3656367316592 | 7.46273196927859
  2023-07-01 00:00:00+00:00 |  14.2588989676399 | 90.3264767630324
  2023-07-01 00:00:00+00:00 |  21.1191449238325 | 142.441602089027
(55 rows)
> SELECT d.location, m.current, m.frequency
FROM rdb.Device d
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
WHERE EXISTS (
    SELECT 1
    FROM rdb.DeviceModel dm
    WHERE dm.modelID = d.modelID
        AND dm.TypeName = '电表'
)
ORDER BY d.location ASC,current;
  location |     current      |     frequency
-----------+------------------+--------------------
  area1    | 11.3623350383022 |  18.3155479848789
  area1    | 38.3605591260021 |  47.7261438820055
  area1    | 50.3771483027861 |  57.6755664361319
  area1    | 51.3657007868602 |  21.9499207558219
  area1    | 55.5757147937953 |  29.4643461196237
  area1    | 64.7608834949323 |   6.9986076663541
  area1    | 69.6333622281017 |  58.9094193706912
  area1    | 70.4166998637219 |  16.8520033641003
  area1    |  83.497262058816 |  27.3247611980655
  area1    | 86.6408620731391 |  50.9725199313202
  area1    | 92.1571660223094 |  58.7212739638845
  area1    | 93.3225547467301 |  43.9072248011065
  area1    | 99.4678675025397 |  45.7828540678734
  area2    |  2.5362712857187 |  19.7483576372737
  area2    |  4.7143663137418 |  8.27571492455618
  area2    |  8.0020595087802 |  53.8209955567292
  area2    | 11.1845391378352 | 0.602579310396294
  area2    | 12.2075528531539 |  18.7137334201641
  area2    | 15.9094854493545 |  36.9383322722616
  area2    | 21.2326354535832 |  46.0412660803375
  area2    | 26.9682940704655 |  22.8587538443064
  area2    |  27.444401746537 |   14.455974850198
  area2    | 27.6364208231029 |  26.5355631647354
  area2    | 28.5696601355255 |  16.0609791337855
  area2    | 30.1632209734123 |  5.50441383726124
  area2    | 32.2432444339341 |  3.31446460523622
  area2    | 32.5922311651652 |  50.6448815126542
  area2    | 35.0903702996475 |  54.7685818789391
  area2    | 38.7726102322915 |   37.929835054358
  area2    | 77.9899693670714 |  15.1528517268839
  area2    | 79.6054423091845 |  4.59731967014122
  area3    |  1.4552285651376 |  30.4358871869071
  area3    |  5.1943308789773 |  52.2425306405712
  area3    | 19.1017958876088 |  1.19064069294282
  area3    | 42.5942338040329 |  42.0235732491163
  area3    | 43.7369827209636 |   59.894456926546
  area3    | 51.3779408142966 |   18.087854549501
  area3    | 51.4086117972453 |  3.01038255870466
  area3    | 58.7603069416189 |  41.2031892727525
  area3    | 65.8289096339743 |  25.5717958601356
  area3    | 66.3840449793426 |  19.6441539895672
  area3    | 83.6478628663485 |  37.5976599982106
  area3    | 88.2676084108624 |  26.3510798558143
  area3    | 89.7564312801932 |  9.72415321564185
  area3    | 92.1492678972427 |  27.4222859892684
  area3    | 97.2639127907299 |  56.9383191613316
(46 rows)
> SELECT dm.ModelName, mc.status
FROM rdb.DeviceModel dm
JOIN tsdb.MonitoringCenter mc ON dm.modelID = mc.deviceID
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MonitoringCenter mc2
    WHERE mc2.deviceID = mc.deviceID
)
ORDER BY mc.status DESC;
   modelname  | status
--------------+---------
  电表模型2   |      0
  变压器模型7 |     -1
(2 rows)
> SELECT dm.ModelName, t.temperature
FROM rdb.DeviceModel dm
JOIN rdb.Device d ON dm.modelID = d.modelID
JOIN tsdb.TransformerSuper t ON d.deviceID = t.deviceID
WHERE d.installDate < '2023-07-01'
    AND EXISTS (
        SELECT 1
        FROM tsdb.TransformerSuper t2
        WHERE t2.deviceID = t.deviceID
    )
ORDER BY d.installDate DESC;
  modelname | temperature
------------+--------------
(0 rows)
> SELECT dm.ModelName, m.current, mc.status
FROM rdb.DeviceModel dm
JOIN tsdb.MeterSuper m ON dm.modelID = m.modelID
JOIN tsdb.MonitoringCenter mc ON m.deviceID = mc.deviceID
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MeterSuper m2
    WHERE

 m2.deviceID = m.deviceID
)
ORDER BY m.current DESC, mc.status ASC;
  modelname |     current      | status
------------+------------------+---------
  电表模型2 | 77.9899693670714 |      0
  电表模型2 | 32.5922311651652 |     -1
  电表模型2 | 32.2432444339341 |     -1
  电表模型2 | 28.5696601355255 |      0
  电表模型2 | 26.9682940704655 |      0
  电表模型2 | 15.9094854493545 |     -1
  电表模型2 | 12.2075528531539 |      0
  电表模型2 | 11.1845391378352 |      0
  电表模型2 |  4.7143663137418 |      0
  电表模型2 |  2.5362712857187 |     -1
(10 rows)
> SELECT m.current, m.frequency
FROM rdb.Device d
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
WHERE d.location = 'area1'
    AND EXISTS (
        SELECT 1
        FROM rdb.DeviceModel dm
        WHERE dm.modelID = d.modelID
            AND dm.TypeName = '电表'
    )
ORDER BY m.frequency ASC;
      current      |    frequency
-------------------+-------------------
  64.7608834949323 |  6.9986076663541
  70.4166998637219 | 16.8520033641003
  11.3623350383022 | 18.3155479848789
  51.3657007868602 | 21.9499207558219
   83.497262058816 | 27.3247611980655
  55.5757147937953 | 29.4643461196237
  93.3225547467301 | 43.9072248011065
  99.4678675025397 | 45.7828540678734
  38.3605591260021 | 47.7261438820055
  86.6408620731391 | 50.9725199313202
  50.3771483027861 | 57.6755664361319
  92.1571660223094 | 58.7212739638845
  69.6333622281017 | 58.9094193706912
(13 rows)
> SELECT d.installDate, t.voltage
FROM rdb.Device d
JOIN tsdb.TransformerSuper t ON d.deviceID = t.deviceID
WHERE t.temperature > 50
    AND EXISTS (
        SELECT 1
        FROM tsdb.TransformerSuper t2
        WHERE t2.deviceID = t.deviceID
    )
ORDER BY t.voltage DESC;
  installdate | voltage
--------------+----------
(0 rows)
> SELECT dm.ModelName, m.current, mc.status
FROM rdb.DeviceModel dm
JOIN tsdb.MeterSuper m ON dm.modelID = m.modelID
JOIN tsdb.MonitoringCenter mc ON m.deviceID = mc.deviceID
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MeterSuper m2
    WHERE m2.deviceID = m.deviceID
)
    AND (m.current > 100 OR mc.status = 1)
ORDER BY m.current DESC, mc.status ASC;
  modelname | current | status
------------+---------+---------
(0 rows)
> SELECT d.installDate, m.voltage
FROM rdb.Device d
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
JOIN tsdb.MonitoringCenter mc ON m.deviceID = mc.deviceID
WHERE d.location = 'area2'
    AND mc.status = 0
    AND EXISTS (
        SELECT 1
        FROM rdb.DeviceModel dm
        WHERE dm.modelID = d.modelID
            AND dm.TypeName = '电表'
    )
ORDER BY d.installDate DESC;
         installdate        |     voltage
----------------------------+-------------------
  2023-07-01 00:00:00+00:00 | 140.690224485548
  2023-07-01 00:00:00+00:00 | 73.3038314338742
  2023-07-01 00:00:00+00:00 | 129.540332823266
  2023-07-01 00:00:00+00:00 | 221.252417769086
  2023-07-01 00:00:00+00:00 | 193.149378415718
  2023-07-01 00:00:00+00:00 | 39.4609662728706
(6 rows)
> SELECT dm.TypeName
FROM rdb.DeviceModel dm
WHERE dm.ModelID IN (
    SELECT d.modelID
    FROM rdb.Device d
    WHERE d.deviceID IN (
        SELECT ms.deviceID
        FROM tsdb.MeterSuper ms
    )
);
  typename
------------
  电表
  电表
  电表
  电表
  电表
(5 rows)
> SELECT ms.deviceID, ms.ts
FROM tsdb.MeterSuper ms
WHERE ms.deviceID IN (
    SELECT d.deviceID
    FROM rdb.Device d
    WHERE d.deviceID IN (
        SELECT ms.deviceID
        FROM tsdb.MeterSuper ms
    )
    AND d.installDate = ms.ts::date
);
  deviceid | ts
-----------+-----
(0 rows)
> SELECT dm.TypeName, d.location
FROM rdb.DeviceModel dm
JOIN rdb.Device d ON dm.ModelID = d.modelID
WHERE dm.ModelID IN (
    SELECT ms.modelId
    FROM tsdb.MeterSuper ms
    WHERE ms.deviceID IN (
        SELECT d.deviceID
        FROM rdb.Device d
    )
    AND ms.current > 100
);
  typename | location
-----------+-----------
(0 rows)
> SELECT dm.TypeName, ts.temperature
FROM rdb.DeviceModel dm
JOIN tsdb.TransformerSuper ts ON dm.ModelID = ts.modelId
WHERE dm.ModelID IN (
    SELECT ts.modelId
    FROM tsdb.TransformerSuper ts
    WHERE ts.deviceID IN (
        SELECT d.deviceID
        FROM rdb.Device d
    )
) order by ts.temperature;
  typename |    temperature
-----------+--------------------
  变压器   |  0.88726046519966
  变压器   | 0.888262181329367
  变压器   |  1.02756784982944
  变压器   |  1.78438278418483
  变压器   |   3.4270151228769
  变压器   |  3.70442755758447
  变压器   |  3.78880851739069
  变压器   |  4.02753975120433
  变压器   |  4.26001444506568
  变压器   |  5.17398884989191
  变压器   |  5.22039849693016
  变压器   |  7.40772839981332
  变压器   |   8.0043717691936
  变压器   |  8.32671806250303
  变压器   |  8.99106030213915
  变压器   |   9.9844596700062
  变压器   |  10.4835555524902
  变压器   |   12.141814707802
  变压器   |  12.7393411825183
  变压器   |  14.2588989676399
  变压器   |  14.6356906093611
  变压器   |  14.6568703114464
  变压器   |  14.7352206015563
  变压器   |  15.2389583134986
  变压器   |  15.3674872865237
  变压器   |  15.9826086472548
  变压器   |  16.0702858199367
  变压器   |  16.1441346256395
  变压器   |  16.3709197522662
  变压器   |  16.9353628958774
  变压器   |  17.6025290481215
  变压器   |  19.2503307615728
  变压器   |  19.9063912659477
  变压器   |  19.9842878240267
  变压器   |  20.4276840331148
  变压器   |  20.5944805823982
  变压器   |  21.1191449238325
  变压器   |  21.6289511267588
  变压器   |  22.8197108083401
  变压器   |  23.9241122925156
  变压器   |  27.8537278009513
  变压器   |  28.3796205960211
  变压器   |  28.3854293845305
  变压器   |  29.4223010516673
  变压器   |  29.7222816635839
  变压器   |  30.0818710128209
  变压器   |  31.8415012308714
  变压器   |  34.3656367316592
  变压器   |  35.6732716012075
  变压器   |  36.1938530615818
  变压器   |  36.2936778436917
  变压器   |  37.1860326026061
  变压器   |  37.9130750083995
  变压器   |  38.2180913775925
  变压器   |  38.3103532390913
(55 rows)
> SELECT dm.TypeName, ms.current
FROM rdb.DeviceModel dm
JOIN rdb.Device d ON dm.ModelID = d.modelID
JOIN tsdb.MeterSuper ms ON d.deviceID = ms.deviceID AND dm.ModelID = ms.modelId
WHERE ms.deviceID IN (
    SELECT d.deviceID
    FROM rdb.Device d
) order by current;
  typename |     current
-----------+-------------------
  电表     |  1.4552285651376
  电表     |  2.5362712857187
  电表     |  4.7143663137418
  电表     |  5.1943308789773
  电表     |  8.0020595087802
  电表     | 11.1845391378352
  电表     | 11.3623350383022
  电表     | 12.2075528531539
  电表     | 15.9094854493545
  电表     | 19.1017958876088
  电表     | 21.2326354535832
  电表     | 26.9682940704655
  电表     |  27.444401746537
  电表     | 27.6364208231029
  电表     | 28.5696601355255
  电表     | 30.1632209734123
  电表     | 32.2432444339341
  电表     | 32.5922311651652
  电表     | 35.0903702996475
  电表     | 38.3605591260021
  电表     | 38.7726102322915
  电表     | 42.5942338040329
  电表     | 43.7369827209636
  电表     | 50.3771483027861
  电表     | 51.3657007868602
  电表     | 51.3779408142966
  电表     | 51.4086117972453
  电表     | 55.5757147937953
  电表     | 58.7603069416189
  电表     | 64.7608834949323
  电表     | 65.8289096339743
  电表     | 66.3840449793426
  电表     | 69.6333622281017
  电表     | 70.4166998637219
  电表     | 77.9899693670714
  电表     | 79.6054423091845
  电表     |  83.497262058816
  电表     | 83.6478628663485
  电表     | 86.6408620731391
  电表     | 88.2676084108624
  电表     | 89.7564312801932
  电表     | 92.1492678972427
  电表     | 92.1571660223094
  电表     | 93.3225547467301
  电表     | 97.2639127907299
  电表     | 99.4678675025397
(46 rows)
> SELECT m.current, m.frequency
FROM tsdb.MeterSuper m
WHERE m.deviceID IN (
    SELECT d.deviceID
    FROM rdb.Device d
    JOIN rdb.DeviceModel dm ON d.modelID = dm.modelID
    WHERE dm.ModelName = '电表模型1'
)
ORDER BY m.current DESC;
      current      |    frequency
-------------------+-------------------
  99.4678675025397 | 45.7828540678734
  93.3225547467301 | 43.9072248011065
  92.1571660223094 | 58.7212739638845
   83.497262058816 | 27.3247611980655
  69.6333622281017 | 58.9094193706912
  51.3657007868602 | 21.9499207558219
  38.7726102322915 |  37.929835054358
   27.444401746537 |  14.455974850198
  21.2326354535832 | 46.0412660803375
  11.3623350383022 | 18.3155479848789
   8.0020595087802 | 53.8209955567292
(11 rows)
> SELECT t.temperature, t.voltage
FROM tsdb.TransformerSuper t
WHERE t.deviceID IN (
    SELECT d.deviceID
    FROM rdb.Device d
    JOIN rdb.DeviceModel dm ON d.modelID = dm.modelID
    WHERE dm.TypeName = '变压器'
        AND d.installDate > '2023-07-01'
)
ORDER BY t.temperature ASC;
     temperature    |     voltage
--------------------+-------------------
   0.88726046519966 | 210.572640997603
  0.888262181329367 | 34.3637179200209
   1.02756784982944 |  236.11866419811
   1.78438278418483 | 200.658115852603
    3.4270151228769 | 188.256752793934
   3.70442755758447 | 72.4093102835067
   3.78880851739069 | 112.812116134239
   4.02753975120433 | 215.613071987667
   4.26001444506568 | 205.185891118596
   5.17398884989191 | 118.979588026805
   5.22039849693016 |  144.99413205258
   7.40772839981332 | 163.309371206004
    8.0043717691936 |  99.004578998381
   8.99106030213915 | 19.4365034998361
   10.4835555524902 | 195.579912227776
    12.141814707802 | 108.511358445958
   12.7393411825183 | 168.258950009786
   14.6356906093611 | 98.2060767880287
   14.6568703114464 | 136.836842086963
   14.7352206015563 | 161.355020828364
   15.2389583134986 | 223.713905458791
   15.9826086472548 | 20.6630930277035
   16.0702858199367 | 120.126571230442
   16.3709197522662 |  62.093309068496
   17.6025290481215 | 226.761499606397
   19.2503307615728 | 123.099698869876
   19.9063912659477 | 154.080199954059
   19.9842878240267 | 197.815366563331
   20.4276840331148 |  97.649389955192
   20.5944805823982 | 210.968491569062
   21.6289511267588 |  47.376657484987
   22.8197108083401 | 153.226330096026
   23.9241122925156 | 206.070347266935
   27.8537278009513 | 49.2138283756682
   28.3796205960211 | 95.5581273127987
   29.4223010516673 | 131.974313155946
   29.7222816635839 | 90.2966818407791
   30.0818710128209 | 221.387096571049
   31.8415012308714 | 220.624857600152
   35.6732716012075 | 128.985755360718
   36.1938530615818 | 61.2819106751286
   36.2936778436917 | 72.9023828811242
   37.1860326026061 | 70.0397236701451
   37.9130750083995 | 127.986337408089
   38.2180913775925 | 108.395207224193
   38.3103532390913 |   43.27803927302
(46 rows)
> SELECT d.installDate, m.voltage
FROM rdb.Device d
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
WHERE d.location = 'area1'
    AND d.deviceID IN (
        SELECT m2.deviceID
        FROM tsdb.MeterSuper m2
    )
ORDER BY d.installDate DESC, voltage;
         installdate        |     voltage
----------------------------+-------------------
  2023-07-04 00:00:00+00:00 | 105.947176785265
  2023-07-04 00:00:00+00:00 | 154.900605102746
  2023-07-02 00:00:00+00:00 |  11.403069794533
  2023-07-02 00:00:00+00:00 | 38.3445896240576
  2023-07-02 00:00:00+00:00 | 144.607216977954
  2023-07-02 00:00:00+00:00 | 161.310822672952
  2023-07-01 00:00:00+00:00 | 13.0252418928197
  2023-07-01 00:00:00+00:00 | 37.3173252950804
  2023-07-01 00:00:00+00:00 | 66.6576742686871
  2023-07-01 00:00:00+00:00 | 109.481594926408
  2023-07-01 00:00:00+00:00 | 152.529755792575
  2023-07-01 00:00:00+00:00 | 168.123109584792
  2023-07-01 00:00:00+00:00 | 238.179538590531
(13 rows)
> SELECT t.temperature, t.frequency
FROM tsdb.TransformerSuper t
WHERE t.deviceID IN (
    SELECT d.deviceID
    FROM rdb.Device d
    JOIN rdb.DeviceModel dm ON d.modelID = dm.modelID
    WHERE dm.ModelName = '变压器模型9'
)
ORDER BY t.temperature DESC;
     temperature    |     frequency
--------------------+--------------------
   35.6732716012075 |  40.5432051543244
   30.0818710128209 |  5.65178560720362
   28.3854293845305 |  9.81651559479857
   28.3796205960211 |   30.168265976604
   27.8537278009513 |  10.0507297269897
   20.5944805823982 |  7.07998283945599
   19.9842878240267 | 0.128887904577155
   15.3674872865237 |  18.1259609232502
  0.888262181329367 |  36.0546314605785
   0.88726046519966 |  55.8747599998372
(10 rows)
> SELECT dm.ModelName, dm.TypeName, m.current, mc.status
FROM rdb.DeviceModel dm
JOIN tsdb.MeterSuper m ON dm.modelID = m.modelID
JOIN tsdb.MonitoringCenter mc ON m.deviceID = mc.deviceID
WHERE EXISTS (
    SELECT 1
    FROM rdb.Device d
    WHERE d.modelID = dm.modelID
)
ORDER BY m.deviceID ASC, m.current;
  modelname | typename |     current      | status
------------+----------+------------------+---------
  电表模型2 | 电表     |  4.7143663137418 |      0
  电表模型2 | 电表     | 11.1845391378352 |      0
  电表模型2 | 电表     | 12.2075528531539 |      0
  电表模型2 | 电表     | 26.9682940704655 |      0
  电表模型2 | 电表     | 28.5696601355255 |      0
  电表模型2 | 电表     | 77.9899693670714 |      0
  电表模型2 | 电表     |  2.5362712857187 |     -1
  电表模型2 | 电表     | 15.9094854493545 |     -1
  电表模型2 | 电表     | 32.2432444339341 |     -1
  电表模型2 | 电表     | 32.5922311651652 |     -1
(10 rows)
> SELECT d.location, m.current, t.temperature
FROM rdb.Device d
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
JOIN tsdb.TransformerSuper t ON d.deviceID = t.deviceID
WHERE EXISTS (
    SELECT 1
    FROM rdb.DeviceModel dm
    WHERE dm.modelID = d.modelID
        AND dm.TypeName = '电表'
)
    AND m.current > 100
ORDER BY d.location DESC;
  location | current | temperature
-----------+---------+--------------
(0 rows)
> SELECT dm.ModelName, m.current
FROM rdb.DeviceModel dm
JOIN tsdb.MeterSuper m ON dm.modelID = m.modelID
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = m.deviceID
        AND mc.status = 1
)
ORDER BY dm.ModelName ASC;
  modelname | current
------------+----------
(0 rows)
> SELECT d.installDate, t.temperature
FROM rdb.Device d
JOIN tsdb.TransformerSuper t ON d.deviceID = t.deviceID
WHERE EXISTS (
    SELECT 1
    FROM rdb.DeviceModel dm
    WHERE dm.modelID = d.modelID
        AND dm.TypeName = '变压器'
)
    AND t.temperature > 50
ORDER BY d.installDate ASC;
  installdate | temperature
--------------+--------------
(0 rows)
> SELECT dm.ModelName, m.current
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.modelID
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
JOIN tsdb.MonitoringCenter mc ON d.deviceID = mc.deviceID
WHERE d.location = 'area2'
    AND mc.status = 0
ORDER BY m.current DESC;
  modelname |     current
------------+-------------------
  电表模型2 | 77.9899693670714
  电表模型2 | 28.5696601355255
  电表模型2 | 26.9682940704655
  电表模型2 | 12.2075528531539
  电表模型2 | 11.1845391378352
  电表模型2 |  4.7143663137418
(6 rows)
> SELECT d.location, m.voltage
FROM rdb.Device d
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
JOIN tsdb.MonitoringCenter mc ON d.deviceID = mc.deviceID
WHERE d.installDate > '2023-05-01'
    AND mc.status = 1
ORDER BY m.voltage ASC;
  location | voltage
-----------+----------
(0 rows)
> SELECT ms.deviceID, ms.current,
    (SELECT AVG(ms2.current)
     FROM tsdb.MeterSuper ms2
     WHERE ms2.deviceID = ms.deviceID) AS AverageCurrent
FROM tsdb.MeterSuper ms order by ms.deviceID,current;
  deviceid |     current      |  averagecurrent
-----------+------------------+-------------------
         1 | 11.3623350383022 | 71.5437497690942
         1 | 51.3657007868602 | 71.5437497690942
         1 | 69.6333622281017 | 71.5437497690942
         1 |  83.497262058816 | 71.5437497690942
         1 | 92.1571660223094 | 71.5437497690942
         1 | 93.3225547467301 | 71.5437497690942
         1 | 99.4678675025397 | 71.5437497690942
         2 |  4.7143663137418 | 26.9390636462989
         2 | 11.1845391378352 | 26.9390636462989
         2 | 12.2075528531539 | 26.9390636462989
         2 | 26.9682940704655 | 26.9390636462989
         2 | 28.5696601355255 | 26.9390636462989
         2 | 77.9899693670714 | 26.9390636462989
         3 |  5.1943308789773 | 60.1016472893237
         3 | 19.1017958876088 | 60.1016472893237
         3 | 42.5942338040329 | 60.1016472893237
         3 | 83.6478628663485 | 60.1016472893237
         3 | 88.2676084108624 | 60.1016472893237
         3 | 89.7564312801932 | 60.1016472893237
         3 | 92.1492678972427 | 60.1016472893237
         4 | 50.3771483027861 | 68.0488984336449
         4 | 64.7608834949323 | 68.0488984336449
         4 | 70.4166998637219 | 68.0488984336449
         4 | 86.6408620731391 | 68.0488984336449
         5 | 38.3605591260021 | 46.9681369598987
         5 | 55.5757147937953 | 46.9681369598987
         6 |  8.0020595087802 |  23.862926735298
         6 | 21.2326354535832 |  23.862926735298
         6 |  27.444401746537 |  23.862926735298
         6 | 38.7726102322915 |  23.862926735298
         7 |  2.5362712857187 | 20.8203080835431
         7 | 15.9094854493545 | 20.8203080835431
         7 | 32.2432444339341 | 20.8203080835431
         7 | 32.5922311651652 | 20.8203080835431
         8 | 43.7369827209636 | 64.1365024363129
         8 | 51.4086117972453 | 64.1365024363129
         8 | 97.2639127907299 | 64.1365024363129
         9 |  1.4552285651376 |  48.761286186874
         9 | 51.3779408142966 |  48.761286186874
         9 | 58.7603069416189 |  48.761286186874
         9 | 65.8289096339743 |  48.761286186874
         9 | 66.3840449793426 |  48.761286186874
        10 | 27.6364208231029 | 43.1238636013368
        10 | 30.1632209734123 | 43.1238636013368
        10 | 35.0903702996475 | 43.1238636013368
        10 | 79.6054423091845 | 43.1238636013368
(46 rows)
> SELECT dm.TypeName,
    (SELECT MAX(ms.current)
     FROM tsdb.MeterSuper ms
     WHERE ms.deviceID = d.deviceID) AS MaxCurrent
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID order by MaxCurrent;
  typename |    maxcurrent
-----------+-------------------
  变压器   | NULL
  变压器   | NULL
  变压器   | NULL
  变压器   | NULL
  变压器   | NULL
  变压器   | NULL
  变压器   | NULL
  变压器   | NULL
  变压器   | NULL
  变压器   | NULL
  变压器   | NULL
  电表     | 32.5922311651652
  电表     | 38.7726102322915
  电表     | 55.5757147937953
  电表     | 66.3840449793426
  电表     | 77.9899693670714
  电表     | 79.6054423091845
  电表     | 86.6408620731391
  电表     | 92.1492678972427
  电表     | 97.2639127907299
  电表     | 99.4678675025397
(21 rows)
> SELECT ms.deviceID,
    (SELECT d.installDate
     FROM rdb.Device d
     WHERE d.deviceID = ms.deviceID) AS InstallDate
FROM tsdb.MeterSuper ms order by ms.deviceID;
  deviceid |        installdate
-----------+----------------------------
         1 | 2023-07-01 00:00:00+00:00
         1 | 2023-07-01 00:00:00+00:00
         1 | 2023-07-01 00:00:00+00:00
         1 | 2023-07-01 00:00:00+00:00
         1 | 2023-07-01 00:00:00+00:00
         1 | 2023-07-01 00:00:00+00:00
         1 | 2023-07-01 00:00:00+00:00
         2 | 2023-07-01 00:00:00+00:00
         2 | 2023-07-01 00:00:00+00:00
         2 | 2023-07-01 00:00:00+00:00
         2 | 2023-07-01 00:00:00+00:00
         2 | 2023-07-01 00:00:00+00:00
         2 | 2023-07-01 00:00:00+00:00
         3 | 2023-07-01 00:00:00+00:00
         3 | 2023-07-01 00:00:00+00:00
         3 | 2023-07-01 00:00:00+00:00
         3 | 2023-07-01 00:00:00+00:00
         3 | 2023-07-01 00:00:00+00:00
         3 | 2023-07-01 00:00:00+00:00
         3 | 2023-07-01 00:00:00+00:00
         4 | 2023-07-02 00:00:00+00:00
         4 | 2023-07-02 00:00:00+00:00
         4 | 2023-07-02 00:00:00+00:00
         4 | 2023-07-02 00:00:00+00:00
         5 | 2023-07-04 00:00:00+00:00
         5 | 2023-07-04 00:00:00+00:00
         6 | 2023-07-03 00:00:00+00:00
         6 | 2023-07-03 00:00:00+00:00
         6 | 2023-07-03 00:00:00+00:00
         6 | 2023-07-03 00:00:00+00:00
         7 | 2023-07-02 00:00:00+00:00
         7 | 2023-07-02 00:00:00+00:00
         7 | 2023-07-02 00:00:00+00:00
         7 | 2023-07-02 00:00:00+00:00
         8 | 2023-07-04 00:00:00+00:00
         8 | 2023-07-04 00:00:00+00:00
         8 | 2023-07-04 00:00:00+00:00
         9 | 2023-07-02 00:00:00+00:00
         9 | 2023-07-02 00:00:00+00:00
         9 | 2023-07-02 00:00:00+00:00
         9 | 2023-07-02 00:00:00+00:00
         9 | 2023-07-02 00:00:00+00:00
        10 | 2023-07-04 00:00:00+00:00
        10 | 2023-07-04 00:00:00+00:00
        10 | 2023-07-04 00:00:00+00:00
        10 | 2023-07-04 00:00:00+00:00
(46 rows)
> SELECT d.deviceID,
    (SELECT COUNT(mc.status)
     FROM tsdb.MonitoringCenter mc
     WHERE mc.deviceID = d.deviceID) AS StatusCount
FROM rdb.Device d order by d.deviceID;
  deviceid | statuscount
-----------+--------------
         1 |           0
         2 |           1
         3 |           0
         4 |           0
         5 |           0
         6 |           0
         7 |           1
         8 |           0
         9 |           0
        10 |           0
        11 |           0
        12 |           0
        13 |           0
        14 |           1
        15 |           0
        16 |           1
        17 |           0
        18 |           1
        19 |           0
        20 |           0
        21 |           0
(21 rows)
> SELECT ms.deviceID,
    (SELECT d.location
     FROM rdb.Device d
     WHERE d.deviceID = ms.deviceID) AS Location
FROM tsdb.MeterSuper ms order by ms.deviceID;
  deviceid | location
-----------+-----------
         1 | area1
         1 | area1
         1 | area1
         1 | area1
         1 | area1
         1 | area1
         1 | area1
         2 | area2
         2 | area2
         2 | area2
         2 | area2
         2 | area2
         2 | area2
         3 | area3
         3 | area3
         3 | area3
         3 | area3
         3 | area3
         3 | area3
         3 | area3
         4 | area1
         4 | area1
         4 | area1
         4 | area1
         5 | area1
         5 | area1
         6 | area2
         6 | area2
         6 | area2
         6 | area2
         7 | area2
         7 | area2
         7 | area2
         7 | area2
         8 | area3
         8 | area3
         8 | area3
         9 | area3
         9 | area3
         9 | area3
         9 | area3
         9 | area3
        10 | area2
        10 | area2
        10 | area2
        10 | area2
(46 rows)
> SELECT d.deviceID,
    (SELECT mc.status
     FROM tsdb.MonitoringCenter mc
     WHERE mc.deviceID = d.deviceID
     ORDER BY mc.ts DESC
     LIMIT 1) AS LatestStatus
FROM rdb.Device d order by deviceid;
  deviceid | lateststatus
-----------+---------------
         1 | NULL
         2 |            0
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 |           -1
         8 | NULL
         9 | NULL
        10 | NULL
        11 | NULL
        12 | NULL
        13 | NULL
        14 |            0
        15 | NULL
        16 |           -1
        17 | NULL
        18 |            0
        19 | NULL
        20 | NULL
        21 | NULL
(21 rows)
> SELECT ms.deviceID,
    (SELECT dm.TypeName
     FROM rdb.DeviceModel dm
     WHERE dm.ModelID = (
         SELECT d.modelID
         FROM rdb.Device d
         WHERE d.deviceID = ms.deviceID
     )) AS TypeName
FROM tsdb.MeterSuper ms order by ms.deviceID;
  deviceid | typename
-----------+-----------
         1 | 电表
         1 | 电表
         1 | 电表
         1 | 电表
         1 | 电表
         1 | 电表
         1 | 电表
         2 | 电表
         2 | 电表
         2 | 电表
         2 | 电表
         2 | 电表
         2 | 电表
         3 | 电表
         3 | 电表
         3 | 电表
         3 | 电表
         3 | 电表
         3 | 电表
         3 | 电表
         4 | 电表
         4 | 电表
         4 | 电表
         4 | 电表
         5 | 电表
         5 | 电表
         6 | 电表
         6 | 电表
         6 | 电表
         6 | 电表
         7 | 电表
         7 | 电表
         7 | 电表
         7 | 电表
         8 | 电表
         8 | 电表
         8 | 电表
         9 | 电表
         9 | 电表
         9 | 电表
         9 | 电表
         9 | 电表
        10 | 电表
        10 | 电表
        10 | 电表
        10 | 电表
(46 rows)
> SELECT d.deviceID,
    (SELECT MIN(mc.ts)
     FROM tsdb.MonitoringCenter mc
     WHERE mc.deviceID = d.deviceID) AS EarliestStatusTime
FROM rdb.Device d order by d.deviceID;
  deviceid |      earlieststatustime
-----------+--------------------------------
         1 | NULL
         2 | 2023-07-10 04:20:04.337+00:00
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 | 2023-07-08 04:41:43.514+00:00
         8 | NULL
         9 | NULL
        10 | NULL
        11 | NULL
        12 | NULL
        13 | NULL
        14 | 2023-07-08 14:55:50.421+00:00
        15 | NULL
        16 | 2023-07-10 00:01:06.133+00:00
        17 | NULL
        18 | 2023-07-07 23:23:16.211+00:00
        19 | NULL
        20 | NULL
        21 | NULL
(21 rows)
> SELECT ms.deviceID,
    (SELECT COUNT(dm.ModelID)
     FROM rdb.DeviceModel dm
     WHERE dm.ModelID = (
         SELECT d.modelID
         FROM rdb.Device d
         WHERE d.deviceID = ms.deviceID
     )) AS TypeCount
FROM tsdb.MeterSuper ms order by ms.deviceID;
  deviceid | typecount
-----------+------------
         1 |         1
         1 |         1
         1 |         1
         1 |         1
         1 |         1
         1 |         1
         1 |         1
         2 |         1
         2 |         1
         2 |         1
         2 |         1
         2 |         1
         2 |         1
         3 |         1
         3 |         1
         3 |         1
         3 |         1
         3 |         1
         3 |         1
         3 |         1
         4 |         1
         4 |         1
         4 |         1
         4 |         1
         5 |         1
         5 |         1
         6 |         1
         6 |         1
         6 |         1
         6 |         1
         7 |         1
         7 |         1
         7 |         1
         7 |         1
         8 |         1
         8 |         1
         8 |         1
         9 |         1
         9 |         1
         9 |         1
         9 |         1
         9 |         1
        10 |         1
        10 |         1
        10 |         1
        10 |         1
(46 rows)
> SELECT d.deviceID,
    (SELECT AVG(mc.status)
     FROM tsdb.MonitoringCenter mc
     WHERE mc.deviceID = d.deviceID) AS AverageStatus
FROM rdb.Device d order by d.deviceID;
  deviceid | averagestatus
-----------+----------------
         1 | NULL
         2 |             0
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 |            -1
         8 | NULL
         9 | NULL
        10 | NULL
        11 | NULL
        12 | NULL
        13 | NULL
        14 |             0
        15 | NULL
        16 |            -1
        17 | NULL
        18 |             0
        19 | NULL
        20 | NULL
        21 | NULL
(21 rows)
> SELECT dm.ModelName,
       (SELECT COUNT(*) FROM rdb.Device d WHERE d.modelID = dm.modelID) AS DeviceCount,
       (SELECT AVG(m.current) FROM tsdb.MeterSuper m WHERE m.modelID = dm.modelID) AS AvgCurrent
FROM rdb.DeviceModel dm
ORDER BY DeviceCount DESC, dm.ModelName;
   modelname   | devicecount |    avgcurrent
---------------+-------------+-------------------
  变压器模型10 |           3 | NULL
  变压器模型6  |           2 | NULL
  变压器模型7  |           2 | NULL
  变压器模型8  |           2 | NULL
  变压器模型9  |           2 | NULL
  电表模型1    |           2 | 54.2052686658956
  电表模型2    |           2 | 24.4915614211966
  电表模型3    |           2 | 61.3121038334205
  电表模型4    |           2 | 57.3335582965499
  电表模型5    |           2 | 44.4052880541908
(10 rows)
> SELECT dm.ModelName,
       (SELECT MIN(d.installDate) FROM rdb.Device d WHERE d.modelID = dm.modelID) AS EarliestInstallDate,
       (SELECT MAX(m.current) FROM tsdb.MeterSuper m WHERE m.modelID = dm.modelID) AS MaxCurrent
FROM rdb.DeviceModel dm
ORDER BY EarliestInstallDate ASC, dm.ModelName;
   modelname   |    earliestinstalldate    |    maxcurrent
---------------+---------------------------+-------------------
  变压器模型10 | 2023-07-01 00:00:00+00:00 | NULL
  变压器模型6  | 2023-07-01 00:00:00+00:00 | NULL
  变压器模型9  | 2023-07-01 00:00:00+00:00 | NULL
  电表模型1    | 2023-07-01 00:00:00+00:00 | 99.4678675025397
  电表模型2    | 2023-07-01 00:00:00+00:00 | 77.9899693670714
  电表模型3    | 2023-07-01 00:00:00+00:00 | 97.2639127907299
  变压器模型8  | 2023-07-02 00:00:00+00:00 | NULL
  电表模型4    | 2023-07-02 00:00:00+00:00 | 86.6408620731391
  变压器模型7  | 2023-07-03 00:00:00+00:00 | NULL
  电表模型5    | 2023-07-04 00:00:00+00:00 | 79.6054423091845
(10 rows)
> SELECT dm.ModelName,
       (SELECT COUNT(*) FROM rdb.Device d WHERE d.modelID = dm.modelID) AS DeviceCount,
       (SELECT MIN(t.temperature) FROM tsdb.TransformerSuper t WHERE t.modelID = dm.modelID) AS MinTemperature
FROM rdb.DeviceModel dm
ORDER BY DeviceCount DESC, dm.ModelName;
   modelname   | devicecount |  mintemperature
---------------+-------------+-------------------
  变压器模型10 |           3 | 1.78438278418483
  变压器模型6  |           2 | 4.02753975120433
  变压器模型7  |           2 | 1.02756784982944
  变压器模型8  |           2 | 3.78880851739069
  变压器模型9  |           2 | 0.88726046519966
  电表模型1    |           2 | NULL
  电表模型2    |           2 | NULL
  电表模型3    |           2 | NULL
  电表模型4    |           2 | NULL
  电表模型5    |           2 | NULL
(10 rows)
> SELECT dm.ModelName,
       (SELECT COUNT(*) FROM rdb.Device d WHERE d.modelID = dm.modelID) AS DeviceCount,
       (SELECT AVG(m.frequency) FROM tsdb.MeterSuper m WHERE m.modelID = dm.modelID) AS AvgFrequency
FROM rdb.DeviceModel dm
WHERE (SELECT AVG(m.frequency) FROM tsdb.MeterSuper m WHERE m.modelID = dm.modelID) > 50
ORDER BY AvgFrequency DESC, dm.ModelName;
  modelname | devicecount | avgfrequency
------------+-------------+---------------
(0 rows)
> SELECT dm.ModelName,
       (SELECT COUNT(*) FROM rdb.Device d WHERE d.modelID = dm.modelID) AS DeviceCount,
       (SELECT SUM(m.voltage) FROM tsdb.MeterSuper m WHERE m.modelID = dm.modelID) AS TotalVoltage
FROM rdb.DeviceModel dm
ORDER BY TotalVoltage DESC, dm.ModelName;
   modelname   | devicecount |   totalvoltage
---------------+-------------+-------------------
  电表模型2    |           2 | 1506.64267602925
  电表模型1    |           2 | 1351.23436916282
  电表模型4    |           2 | 1212.08169183403
  电表模型3    |           2 | 1171.81169379372
  电表模型5    |           2 | 861.065114123884
  变压器模型10 |           3 | NULL
  变压器模型6  |           2 | NULL
  变压器模型7  |           2 | NULL
  变压器模型8  |           2 | NULL
  变压器模型9  |           2 | NULL
(10 rows)
> SELECT d.location, m.current AS Current
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.modelID
JOIN (
    SELECT deviceID, current,
           ROW_NUMBER() OVER (PARTITION BY deviceID ORDER BY ts DESC) AS rn
    FROM tsdb.MeterSuper
) m ON m.deviceID = d.deviceID AND m.rn = 1
WHERE dm.ModelName = '电表模型2'
ORDER BY d.location ASC;
ERROR: window functions are not supported in tstable and stable
SQLSTATE: 01000
> SELECT dm.ModelName,
       (SELECT MAX(t.temperature) FROM tsdb.TransformerSuper t WHERE t.modelID = dm.modelID) AS MaxTemperature
FROM rdb.DeviceModel dm
WHERE EXISTS (
    SELECT 1
    FROM tsdb.TransformerSuper t
    WHERE t.modelID = dm.modelID
)
ORDER BY MaxTemperature DESC;
   modelname   |  maxtemperature
---------------+-------------------
  变压器模型7  | 38.3103532390913
  变压器模型6  | 38.2180913775925
  变压器模型10 | 37.9130750083995
  变压器模型8  | 36.1938530615818
  变压器模型9  | 35.6732716012075
(5 rows)
> SELECT dm.ModelName,
       (SELECT m.current FROM tsdb.MeterSuper m WHERE m.deviceID = d.deviceID limit 1) AS Current
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.modelID
ORDER BY modelname,Current DESC;
   modelname   |     current
---------------+-------------------
  变压器模型10 | NULL
  变压器模型10 | NULL
  变压器模型10 | NULL
  变压器模型6  | NULL
  变压器模型6  | NULL
  变压器模型7  | NULL
  变压器模型7  | NULL
  变压器模型8  | NULL
  变压器模型8  | NULL
  变压器模型9  | NULL
  变压器模型9  | NULL
  电表模型1    | 51.3657007868602
  电表模型1    | 38.7726102322915
  电表模型2    | 32.2432444339341
  电表模型2    | 28.5696601355255
  电表模型3    | 88.2676084108624
  电表模型3    | 43.7369827209636
  电表模型4    | 64.7608834949323
  电表模型4    |  1.4552285651376
  电表模型5    | 38.3605591260021
  电表模型5    | 30.1632209734123
(21 rows)
> SELECT d.location,
       (SELECT mc.status FROM tsdb.MonitoringCenter mc WHERE mc.deviceID = d.deviceID) AS Status
FROM rdb.Device d
WHERE (SELECT COUNT(*) FROM tsdb.MonitoringCenter mc WHERE mc.deviceID = d.deviceID AND mc.status = 1) > 2
ORDER BY d.location DESC;
  location | status
-----------+---------
(0 rows)
> SELECT dm.ModelName,
       (SELECT AVG(m.frequency) FROM tsdb.MeterSuper m WHERE m.deviceID = d.deviceID) AS AvgFrequency
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.modelID
ORDER BY AvgFrequency DESC, dm.ModelName;
   modelname   |   avgfrequency
---------------+-------------------
  电表模型3    | 39.9477195488608
  电表模型1    |  39.273000306046
  电表模型5    | 38.5952450008146
  电表模型1    | 38.0620178854057
  电表模型4    | 33.1246743494766
  电表模型3    | 28.0788462345094
  电表模型2    | 27.6615090068564
  电表模型4    | 26.9885761717727
  电表模型5    | 22.8514696377692
  电表模型2    | 13.6107687266821
  变压器模型10 | NULL
  变压器模型10 | NULL
  变压器模型10 | NULL
  变压器模型6  | NULL
  变压器模型6  | NULL
  变压器模型7  | NULL
  变压器模型7  | NULL
  变压器模型8  | NULL
  变压器模型8  | NULL
  变压器模型9  | NULL
  变压器模型9  | NULL
(21 rows)
> SELECT d.deviceID
FROM rdb.Device d
WHERE d.installDate < (
    SELECT MIN(mc.ts)
    FROM tsdb.MonitoringCenter mc
);
  deviceid
------------
         1
         2
         3
         4
         5
         6
         7
         8
         9
        10
        11
        12
        13
        14
        15
        16
        17
        18
        19
        20
        21
(21 rows)
> SELECT ms.deviceID
FROM tsdb.MeterSuper ms
WHERE ms.current > (
    SELECT AVG(ms2.current)
    FROM tsdb.MeterSuper ms2
    WHERE ms2.deviceID = (
        SELECT d.deviceID
        FROM rdb.Device d
        WHERE d.modelID = 1 and d.deviceID=1
    )
) order by deviceid;
  deviceid
------------
         1
         1
         1
         1
         2
         3
         3
         3
         3
         4
         8
        10
(12 rows)
> SELECT d.deviceID
FROM rdb.Device d
WHERE d.modelID = (
    SELECT ms.modelId
    FROM tsdb.MeterSuper ms
    WHERE ms.deviceID = (
        SELECT d.deviceID
        FROM rdb.Device d ORDER by d.deviceID limit 1
    ) ORDER by ms.modelID limit 1
);
  deviceid
------------
         1
         6
(2 rows)
> SELECT ms.deviceID
FROM tsdb.MeterSuper ms
WHERE ms.voltage > (
    SELECT MIN(ms2.voltage)
    FROM tsdb.MeterSuper ms2
    WHERE ms2.deviceID = (
        SELECT d.deviceID
        FROM rdb.Device d ORDER by d.deviceID limit 1
    )
)order by deviceid;
  deviceid
------------
         1
         1
         1
         1
         1
         1
         2
         2
         2
         2
         2
         2
         3
         3
         3
         3
         3
         3
         3
         4
         4
         4
         5
         5
         6
         6
         6
         6
         7
         7
         7
         7
         8
         8
         8
         9
         9
         9
         9
         9
        10
        10
        10
        10
(44 rows)
> SELECT d.deviceID
FROM rdb.Device d
WHERE d.installDate = (
    SELECT MIN(mc.ts)
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = (
        SELECT d.deviceID
        FROM rdb.Device d ORDER by d.deviceID limit 1
    )
);
  deviceid
------------
(0 rows)
> SELECT ms.deviceID
FROM tsdb.MeterSuper ms
WHERE ms.current < (
    SELECT MAX(ms2.current)
    FROM tsdb.MeterSuper ms2
    WHERE ms2.deviceID = (
        SELECT d.deviceID
        FROM rdb.Device d
        WHERE d.modelID = 1  ORDER by d.deviceID limit 1
    )
) order by deviceid;
  deviceid
------------
         1
         1
         1
         1
         1
         1
         2
         2
         2
         2
         2
         2
         3
         3
         3
         3
         3
         3
         3
         4
         4
         4
         4
         5
         5
         6
         6
         6
         6
         7
         7
         7
         7
         8
         8
         8
         9
         9
         9
         9
         9
        10
        10
        10
        10
(45 rows)
> SELECT dm.TypeName
FROM rdb.DeviceModel dm
WHERE dm.ModelID = (
    SELECT d.modelID
    FROM rdb.Device d
    WHERE d.deviceID = (
        SELECT ms.deviceID
        FROM
 tsdb.MeterSuper ms ORDER by ms.deviceID limit 1
    )
);
  typename
------------
  电表
(1 row)
> SELECT ms.deviceID
FROM tsdb.MeterSuper ms
WHERE ms.current = (
    SELECT AVG(ms2.current)
    FROM tsdb.MeterSuper ms2
    WHERE ms2.deviceID = (
        SELECT d.deviceID
        FROM rdb.Device d
        WHERE d.modelID = 1 ORDER by d.deviceID limit 1
    )
);
  deviceid
------------
(0 rows)
> SELECT dm.TypeName
FROM rdb.DeviceModel dm
WHERE dm.ModelID = (
    SELECT d.modelID
    FROM rdb.Device d
    WHERE d.deviceID = (
        SELECT mc.deviceID
        FROM tsdb.MonitoringCenter mc ORDER by mc.deviceID limit 1
    )
);
  typename
------------
  电表
(1 row)
> SELECT ms.deviceID
FROM tsdb.MeterSuper ms
WHERE ms.voltage = (
    SELECT MIN(ms2.voltage)
    FROM tsdb.MeterSuper ms2
    WHERE ms2.deviceID = (
        SELECT d.deviceID
        FROM rdb.Device d ORDER by d.deviceID limit 1
    )
);
  deviceid
------------
         1
(1 row)
> SELECT dm.ModelName,
       (SELECT COUNT(*) FROM rdb.Device d WHERE d.modelID = dm.modelID) AS DeviceCount,
       (SELECT MAX(m.current) FROM tsdb.MeterSuper m WHERE m.deviceID = ANY(SELECT d.deviceID FROM rdb.Device d WHERE d.modelID = dm.modelID)) AS MaxCurrent
FROM rdb.DeviceModel dm
ORDER BY DeviceCount DESC, dm.ModelName;
   modelname   | devicecount |    maxcurrent
---------------+-------------+-------------------
  变压器模型10 |           3 | NULL
  变压器模型6  |           2 | NULL
  变压器模型7  |           2 | NULL
  变压器模型8  |           2 | NULL
  变压器模型9  |           2 | NULL
  电表模型1    |           2 | 99.4678675025397
  电表模型2    |           2 | 77.9899693670714
  电表模型3    |           2 | 97.2639127907299
  电表模型4    |           2 | 86.6408620731391
  电表模型5    |           2 | 79.6054423091845
(10 rows)
> SELECT dm.ModelName,
       (SELECT COUNT(*) FROM rdb.Device d WHERE d.modelID = dm.modelID) AS DeviceCount,
       (SELECT AVG(t.temperature) FROM tsdb.TransformerSuper t WHERE t.deviceID = ANY(SELECT d.deviceID FROM rdb.Device d WHERE d.modelID = dm.modelID)) AS AvgTemperature
FROM rdb.DeviceModel dm
WHERE (SELECT AVG(t.temperature) FROM tsdb.TransformerSuper t WHERE t.deviceID = ANY(SELECT d.deviceID FROM rdb.Device d WHERE d.modelID = dm.modelID)) < 50
ORDER BY DeviceCount ASC, AvgTemperature;
   modelname   | devicecount |  avgtemperature
---------------+-------------+-------------------
  变压器模型8  |           2 | 16.3540297399922
  变压器模型6  |           2 | 18.3632964458763
  变压器模型7  |           2 | 20.1129753124646
  变压器模型9  |           2 | 20.8095698735009
  变压器模型10 |           3 | 14.4146648638339
(5 rows)
> SELECT dm.ModelName,
       (SELECT COUNT(*) FROM rdb.Device d WHERE d.modelID = dm.modelID) AS DeviceCount,
       (SELECT MIN(m.frequency) FROM tsdb.MeterSuper m WHERE m.deviceID = ANY(SELECT d.deviceID FROM rdb.Device d WHERE d.modelID = dm.modelID)) AS MinFrequency
FROM rdb.DeviceModel dm
WHERE (SELECT COUNT(*) FROM rdb.Device d WHERE d.modelID = dm.modelID) > 3
ORDER BY DeviceCount DESC, MinFrequency;
  modelname | devicecount | minfrequency
------------+-------------+---------------
(0 rows)
> SELECT dm.ModelName,
       (SELECT COUNT(*) FROM rdb.Device d WHERE d.modelID = dm.modelID) AS DeviceCount,
       (SELECT SUM(m.voltage) FROM tsdb.MeterSuper m WHERE m.deviceID = ANY(SELECT d.deviceID FROM rdb.Device d WHERE d.modelID = dm.modelID)) AS TotalVoltage
FROM rdb.DeviceModel dm
ORDER BY TotalVoltage ASC, dm.ModelName;
   modelname   | devicecount |   totalvoltage
---------------+-------------+-------------------
  变压器模型10 |           3 | NULL
  变压器模型6  |           2 | NULL
  变压器模型7  |           2 | NULL
  变压器模型8  |           2 | NULL
  变压器模型9  |           2 | NULL
  电表模型5    |           2 | 861.065114123884
  电表模型3    |           2 | 1171.81169379372
  电表模型4    |           2 | 1212.08169183403
  电表模型1    |           2 | 1351.23436916282
  电表模型2    |           2 | 1506.64267602925
(10 rows)
> SELECT dm.ModelName,
       (SELECT COUNT(*) FROM rdb.Device d WHERE d.modelID = dm.modelID) AS DeviceCount,
       (SELECT COUNT(*) FROM tsdb.MonitoringCenter mc WHERE mc.deviceID = ANY(SELECT d.deviceID FROM rdb.Device d WHERE d.modelID = dm.modelID) AND mc.status = 1) AS StatusCount
FROM rdb.DeviceModel dm
ORDER BY DeviceCount DESC, dm.ModelName;
   modelname   | devicecount | statuscount
---------------+-------------+--------------
  变压器模型10 |           3 |           0
  变压器模型6  |           2 |           0
  变压器模型7  |           2 |           0
  变压器模型8  |           2 |           0
  变压器模型9  |           2 |           0
  电表模型1    |           2 |           0
  电表模型2    |           2 |           0
  电表模型3    |           2 |           0
  电表模型4    |           2 |           0
  电表模型5    |           2 |           0
(10 rows)
> SELECT dm.TypeName
FROM rdb.DeviceModel dm
GROUP BY dm.TypeName
HAVING COUNT(*) > (
    SELECT COUNT(*)
    FROM tsdb.MeterSuper ms
    WHERE ms.current > 100
) order by TypeName;
  typename
------------
  变压器
  电表
(2 rows)
> SELECT ms.deviceID
FROM tsdb.MeterSuper ms
GROUP BY ms.deviceID
HAVING COUNT(*) > (
    SELECT COUNT(d.deviceID)
    FROM rdb.Device d
) order by ms.deviceID;
  deviceid
------------
(0 rows)
> SELECT d.deviceID, dm.TypeName
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
GROUP BY d.deviceID, dm.TypeName
HAVING AVG(d.deviceID) > (
    SELECT AVG(ms.current)
    FROM tsdb.MeterSuper ms
    WHERE ms.deviceID = d.deviceID
);
  deviceid | typename
-----------+-----------
(0 rows)
> SELECT ms.deviceID, ms.current
FROM tsdb.MeterSuper ms
GROUP BY ms.deviceID, ms.current
HAVING ms.deviceID IN (
    SELECT d.deviceID
    FROM rdb.Device d
    WHERE d.modelID = 1
) order by deviceid,current
;
  deviceid |     current
-----------+-------------------
         1 | 11.3623350383022
         1 | 51.3657007868602
         1 | 69.6333622281017
         1 |  83.497262058816
         1 | 92.1571660223094
         1 | 93.3225547467301
         1 | 99.4678675025397
         6 |  8.0020595087802
         6 | 21.2326354535832
         6 |  27.444401746537
         6 | 38.7726102322915
(11 rows)
> SELECT d.deviceID
FROM rdb.Device d
GROUP BY d.deviceID
HAVING d.deviceID IN (
    SELECT mc.deviceID
    FROM tsdb.MonitoringCenter mc
    GROUP BY mc.deviceID
    HAVING COUNT(*) > 5
);
  deviceid
------------
(0 rows)
> SELECT ms.deviceID, ms.current
FROM tsdb.MeterSuper ms
WHERE ms.deviceID IN (
    SELECT d.deviceID
    FROM rdb.Device d
    WHERE d.modelID = 2
)
GROUP BY ms.deviceID, ms.current
HAVING ms.current > (
    SELECT MAX(ms2.current)
    FROM tsdb.MeterSuper ms2
    WHERE ms2.deviceID IN (
        SELECT d.deviceID
        FROM rdb.Device d
        WHERE d.modelID = 2
    )
);
  deviceid | current
-----------+----------
(0 rows)
> SELECT d.deviceID, dm.TypeName
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
GROUP BY d.deviceID, dm.TypeName
HAVING AVG(d.deviceID) < (
    SELECT AVG(mc.status)
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
);
  deviceid | typename
-----------+-----------
(0 rows)
> SELECT ms.deviceID, ms.voltage
FROM tsdb.MeterSuper ms
WHERE ms.deviceID IN (
    SELECT d.deviceID
    FROM rdb.Device d
    WHERE d.modelID = 1
)
GROUP BY ms.deviceID, ms.voltage
HAVING ms.voltage < (
    SELECT MIN(ms2.voltage)
    FROM tsdb.MeterSuper ms2
    WHERE ms2.deviceID IN (
        SELECT d.deviceID
        FROM rdb.Device d
        WHERE d.modelID = 1
    )
);
  deviceid | voltage
-----------+----------
(0 rows)
> SELECT d.deviceID, dm.TypeName
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
GROUP BY d.deviceID, dm.TypeName,dm.modelID
HAVING AVG(d.deviceID) > 50
AND dm.ModelID = 2
AND d.deviceID IN (
    SELECT ms.deviceID
    FROM tsdb.MeterSuper ms
);
  deviceid | typename
-----------+-----------
(0 rows)
> SELECT ms.deviceID, ms.current
FROM tsdb.MeterSuper ms
WHERE ms.deviceID IN (
    SELECT d.deviceID
    FROM rdb.Device d
    WHERE d.modelID = 1
)
GROUP BY ms.deviceID, ms.current
HAVING ms.current < (
    SELECT AVG(ms2.current)
    FROM tsdb.MeterSuper ms2
    WHERE ms2.deviceID IN (
        SELECT d.deviceID
        FROM rdb.Device d
        WHERE d.modelID = 1
    )
) order by deviceid,current;
  deviceid |     current
-----------+-------------------
         1 | 11.3623350383022
         1 | 51.3657007868602
         6 |  8.0020595087802
         6 | 21.2326354535832
         6 |  27.444401746537
         6 | 38.7726102322915
(6 rows)
> SELECT dm.ModelName,
       COUNT(*) AS DeviceCount,
       MAX(m.current) AS MaxCurrent
FROM rdb.DeviceModel dm
JOIN rdb.Device d ON dm.modelID = d.modelID
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
GROUP BY dm.ModelName
HAVING COUNT(*) > 3 AND MAX(m.current) > 100
ORDER BY DeviceCount DESC;
  modelname | devicecount | maxcurrent
------------+-------------+-------------
(0 rows)
> SELECT dm.ModelName,
       COUNT(*) AS DeviceCount,
       AVG(t.temperature) AS AvgTemperature
FROM rdb.DeviceModel dm
JOIN rdb.Device d ON dm.modelID = d.modelID
JOIN tsdb.TransformerSuper t ON d.deviceID = t.deviceID
GROUP BY dm.ModelName
HAVING COUNT(*) > 2 AND AVG(t.temperature) < 50
ORDER BY DeviceCount ASC, dm.ModelName;
   modelname   | devicecount |  avgtemperature
---------------+-------------+-------------------
  变压器模型10 |           9 | 14.4146648638339
  变压器模型6  |           9 | 18.3632964458763
  变压器模型9  |          10 | 20.8095698735009
  变压器模型7  |          12 | 20.1129753124646
  变压器模型8  |          15 | 16.3540297399922
(5 rows)
> SELECT dm.ModelName,
       COUNT(*) AS DeviceCount,
       MIN(m.frequency) AS MinFrequency
FROM rdb.DeviceModel dm
JOIN rdb.Device d ON dm.modelID = d.modelID
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
GROUP BY dm.ModelName
HAVING COUNT(*) > 1 AND MIN(m.frequency) > 50
ORDER BY DeviceCount DESC;
  modelname | devicecount | minfrequency
------------+-------------+---------------
(0 rows)
> SELECT dm.ModelName,
       COUNT(*) AS DeviceCount,
       SUM(m.voltage) AS TotalVoltage
FROM rdb.DeviceModel dm
JOIN rdb.Device d ON dm.modelID = d.modelID
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
GROUP BY dm.ModelName
HAVING COUNT(*) > 3
ORDER BY TotalVoltage ASC;
  modelname | devicecount |   totalvoltage
------------+-------------+-------------------
  电表模型5 |           6 | 861.065114123884
  电表模型3 |          10 | 1171.81169379372
  电表模型4 |           9 | 1212.08169183403
  电表模型1 |          11 | 1351.23436916282
  电表模型2 |          10 | 1506.64267602925
(5 rows)
> SELECT dm.ModelName,
COUNT(1) AS DeviceCount,
(SELECT COUNT(1) FROM tsdb.MonitoringCenter mc WHERE mc.deviceID = d.deviceID AND mc.status = 1) AS StatusCount
FROM rdb.DeviceModel dm
JOIN rdb.Device d ON dm.modelID = d.modelID
GROUP BY dm.ModelName, d.deviceID
HAVING COUNT(*) > 2
ORDER BY DeviceCount DESC;
  modelname | devicecount | statuscount
------------+-------------+--------------
(0 rows)
> SELECT d.location,
       m.current AS Current
FROM rdb.Device d
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
WHERE d.modelID = (SELECT modelID FROM rdb.DeviceModel WHERE ModelName = '电表模型1')
ORDER BY d.location ASC;
  location |     current
-----------+-------------------
  area1    | 51.3657007868602
  area1    | 11.3623350383022
  area1    |  83.497262058816
  area1    | 69.6333622281017
  area1    | 92.1571660223094
  area1    | 93.3225547467301
  area1    | 99.4678675025397
  area2    | 38.7726102322915
  area2    |  8.0020595087802
  area2    | 21.2326354535832
  area2    |  27.444401746537
(11 rows)
> SELECT dm.ModelName,
t.temperature AS Temperature
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.modelID
JOIN tsdb.TransformerSuper t ON d.deviceID = t.deviceID
WHERE d.deviceID IN (SELECT mc.deviceID FROM tsdb.MonitoringCenter mc WHERE mc.status = 0)
AND (SELECT MAX(m.current) FROM tsdb.MeterSuper m WHERE m.deviceID = d.deviceID) < 100
ORDER BY Temperature DESC;
  modelname | temperature
------------+--------------
(0 rows)
> SELECT dm.ModelName,
       m.current AS Current
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.modelID
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
WHERE m.current > (SELECT AVG(current) FROM tsdb.MeterSuper)
ORDER BY Current DESC;
  modelname |     current
------------+-------------------
  电表模型1 | 99.4678675025397
  电表模型3 | 97.2639127907299
  电表模型1 | 93.3225547467301
  电表模型1 | 92.1571660223094
  电表模型3 | 92.1492678972427
  电表模型3 | 89.7564312801932
  电表模型3 | 88.2676084108624
  电表模型4 | 86.6408620731391
  电表模型3 | 83.6478628663485
  电表模型1 |  83.497262058816
  电表模型5 | 79.6054423091845
  电表模型2 | 77.9899693670714
  电表模型4 | 70.4166998637219
  电表模型1 | 69.6333622281017
  电表模型4 | 66.3840449793426
  电表模型4 | 65.8289096339743
  电表模型4 | 64.7608834949323
  电表模型4 | 58.7603069416189
  电表模型5 | 55.5757147937953
  电表模型3 | 51.4086117972453
  电表模型4 | 51.3779408142966
  电表模型1 | 51.3657007868602
  电表模型4 | 50.3771483027861
(23 rows)
> SELECT d.location,
       mc.status AS Status
FROM rdb.Device d
         JOIN tsdb.MonitoringCenter mc ON d.deviceID = mc.deviceID
WHERE EXISTS (
              SELECT 1
              FROM rdb.Device d2
              WHERE d2.location = d.location
              HAVING COUNT(*) > 1
          )
ORDER BY d.location DESC,status;
  location | status
-----------+---------
  area3    |     -1
  area2    |     -1
  area2    |      0
  area2    |      0
  area2    |      0
(5 rows)
> SELECT dm.ModelName,
       m.frequency AS AvgFrequency
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.modelID
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
GROUP BY dm.ModelName, m.frequency
ORDER BY AvgFrequency DESC;
  modelname |   avgfrequency
------------+--------------------
  电表模型3 |   59.894456926546
  电表模型1 |  58.9094193706912
  电表模型1 |  58.7212739638845
  电表模型4 |  57.6755664361319
  电表模型3 |  56.9383191613316
  电表模型5 |  54.7685818789391
  电表模型1 |  53.8209955567292
  电表模型3 |  52.2425306405712
  电表模型4 |  50.9725199313202
  电表模型2 |  50.6448815126542
  电表模型5 |  47.7261438820055
  电表模型1 |  46.0412660803375
  电表模型1 |  45.7828540678734
  电表模型1 |  43.9072248011065
  电表模型3 |  42.0235732491163
  电表模型4 |  41.2031892727525
  电表模型1 |   37.929835054358
  电表模型3 |  37.5976599982106
  电表模型2 |  36.9383322722616
  电表模型4 |  30.4358871869071
  电表模型5 |  29.4643461196237
  电表模型3 |  27.4222859892684
  电表模型1 |  27.3247611980655
  电表模型5 |  26.5355631647354
  电表模型3 |  26.3510798558143
  电表模型4 |  25.5717958601356
  电表模型2 |  22.8587538443064
  电表模型1 |  21.9499207558219
  电表模型2 |  19.7483576372737
  电表模型4 |  19.6441539895672
  电表模型2 |  18.7137334201641
  电表模型1 |  18.3155479848789
  电表模型4 |   18.087854549501
  电表模型4 |  16.8520033641003
  电表模型2 |  16.0609791337855
  电表模型2 |  15.1528517268839
  电表模型1 |   14.455974850198
  电表模型3 |  9.72415321564185
  电表模型2 |  8.27571492455618
  电表模型4 |   6.9986076663541
  电表模型5 |  5.50441383726124
  电表模型5 |  4.59731967014122
  电表模型2 |  3.31446460523622
  电表模型3 |  3.01038255870466
  电表模型3 |  1.19064069294282
  电表模型2 | 0.602579310396294
(46 rows)
> SELECT d.deviceID, dm.TypeName
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
ORDER BY (
    SELECT AVG(ms.current)
    FROM tsdb.MeterSuper ms
    WHERE ms.deviceID = d.deviceID
) DESC,d.deviceID;
  deviceid | typename
-----------+-----------
         1 | 电表
         4 | 电表
         8 | 电表
         3 | 电表
         9 | 电表
         5 | 电表
        10 | 电表
         2 | 电表
         6 | 电表
         7 | 电表
        11 | 变压器
        12 | 变压器
        13 | 变压器
        14 | 变压器
        15 | 变压器
        16 | 变压器
        17 | 变压器
        18 | 变压器
        19 | 变压器
        20 | 变压器
        21 | 变压器
(21 rows)
> SELECT ms.deviceID, ms.current
FROM tsdb.MeterSuper ms
ORDER BY (
    SELECT dm.TypeID
    FROM rdb.DeviceModel dm
    WHERE dm.ModelID = (
        SELECT d.modelID
        FROM rdb.Device d
        WHERE d.deviceID = ms.deviceID
    )
) , deviceid, current ASC;
  deviceid |     current
-----------+-------------------
         1 | 11.3623350383022
         1 | 51.3657007868602
         1 | 69.6333622281017
         1 |  83.497262058816
         1 | 92.1571660223094
         1 | 93.3225547467301
         1 | 99.4678675025397
         2 |  4.7143663137418
         2 | 11.1845391378352
         2 | 12.2075528531539
         2 | 26.9682940704655
         2 | 28.5696601355255
         2 | 77.9899693670714
         3 |  5.1943308789773
         3 | 19.1017958876088
         3 | 42.5942338040329
         3 | 83.6478628663485
         3 | 88.2676084108624
         3 | 89.7564312801932
         3 | 92.1492678972427
         4 | 50.3771483027861
         4 | 64.7608834949323
         4 | 70.4166998637219
         4 | 86.6408620731391
         5 | 38.3605591260021
         5 | 55.5757147937953
         6 |  8.0020595087802
         6 | 21.2326354535832
         6 |  27.444401746537
         6 | 38.7726102322915
         7 |  2.5362712857187
         7 | 15.9094854493545
         7 | 32.2432444339341
         7 | 32.5922311651652
         8 | 43.7369827209636
         8 | 51.4086117972453
         8 | 97.2639127907299
         9 |  1.4552285651376
         9 | 51.3779408142966
         9 | 58.7603069416189
         9 | 65.8289096339743
         9 | 66.3840449793426
        10 | 27.6364208231029
        10 | 30.1632209734123
        10 | 35.0903702996475
        10 | 79.6054423091845
(46 rows)
> SELECT d.deviceID, dm.TypeName
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
ORDER BY (
    SELECT MAX(ms.current) - MIN(ms.current)
    FROM tsdb.MeterSuper ms
    WHERE ms.deviceID = d.deviceID
) DESC,d.deviceID;
  deviceid | typename
-----------+-----------
         1 | 电表
         3 | 电表
         2 | 电表
         9 | 电表
         8 | 电表
        10 | 电表
         4 | 电表
         6 | 电表
         7 | 电表
         5 | 电表
        11 | 变压器
        12 | 变压器
        13 | 变压器
        14 | 变压器
        15 | 变压器
        16 | 变压器
        17 | 变压器
        18 | 变压器
        19 | 变压器
        20 | 变压器
        21 | 变压器
(21 rows)
> SELECT ms.deviceID, ms.current
FROM tsdb.MeterSuper ms
ORDER BY (
    SELECT d.installDate
    FROM rdb.Device d
    WHERE d.deviceID = ms.deviceID
) DESC,deviceid,current;
  deviceid |     current
-----------+-------------------
         5 | 38.3605591260021
         5 | 55.5757147937953
         8 | 43.7369827209636
         8 | 51.4086117972453
         8 | 97.2639127907299
        10 | 27.6364208231029
        10 | 30.1632209734123
        10 | 35.0903702996475
        10 | 79.6054423091845
         6 |  8.0020595087802
         6 | 21.2326354535832
         6 |  27.444401746537
         6 | 38.7726102322915
         4 | 50.3771483027861
         4 | 64.7608834949323
         4 | 70.4166998637219
         4 | 86.6408620731391
         7 |  2.5362712857187
         7 | 15.9094854493545
         7 | 32.2432444339341
         7 | 32.5922311651652
         9 |  1.4552285651376
         9 | 51.3779408142966
         9 | 58.7603069416189
         9 | 65.8289096339743
         9 | 66.3840449793426
         1 | 11.3623350383022
         1 | 51.3657007868602
         1 | 69.6333622281017
         1 |  83.497262058816
         1 | 92.1571660223094
         1 | 93.3225547467301
         1 | 99.4678675025397
         2 |  4.7143663137418
         2 | 11.1845391378352
         2 | 12.2075528531539
         2 | 26.9682940704655
         2 | 28.5696601355255
         2 | 77.9899693670714
         3 |  5.1943308789773
         3 | 19.1017958876088
         3 | 42.5942338040329
         3 | 83.6478628663485
         3 | 88.2676084108624
         3 | 89.7564312801932
         3 | 92.1492678972427
(46 rows)
> SELECT d.deviceID, dm.TypeName
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
ORDER BY (
    SELECT COUNT(mc.status)
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
) ASC, d.deviceID;
  deviceid | typename
-----------+-----------
         1 | 电表
         3 | 电表
         4 | 电表
         5 | 电表
         6 | 电表
         8 | 电表
         9 | 电表
        10 | 电表
        11 | 变压器
        12 | 变压器
        13 | 变压器
        15 | 变压器
        17 | 变压器
        19 | 变压器
        20 | 变压器
        21 | 变压器
         2 | 电表
         7 | 电表
        14 | 变压器
        16 | 变压器
        18 | 变压器
(21 rows)
> SELECT ms.deviceID, ms.current
FROM tsdb.MeterSuper ms
ORDER BY (
    SELECT dm.TypeID
    FROM rdb.Device d
    JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
    WHERE d.deviceID = ms.deviceID
) ASC,deviceid,current;
  deviceid |     current
-----------+-------------------
         1 | 11.3623350383022
         1 | 51.3657007868602
         1 | 69.6333622281017
         1 |  83.497262058816
         1 | 92.1571660223094
         1 | 93.3225547467301
         1 | 99.4678675025397
         2 |  4.7143663137418
         2 | 11.1845391378352
         2 | 12.2075528531539
         2 | 26.9682940704655
         2 | 28.5696601355255
         2 | 77.9899693670714
         3 |  5.1943308789773
         3 | 19.1017958876088
         3 | 42.5942338040329
         3 | 83.6478628663485
         3 | 88.2676084108624
         3 | 89.7564312801932
         3 | 92.1492678972427
         4 | 50.3771483027861
         4 | 64.7608834949323
         4 | 70.4166998637219
         4 | 86.6408620731391
         5 | 38.3605591260021
         5 | 55.5757147937953
         6 |  8.0020595087802
         6 | 21.2326354535832
         6 |  27.444401746537
         6 | 38.7726102322915
         7 |  2.5362712857187
         7 | 15.9094854493545
         7 | 32.2432444339341
         7 | 32.5922311651652
         8 | 43.7369827209636
         8 | 51.4086117972453
         8 | 97.2639127907299
         9 |  1.4552285651376
         9 | 51.3779408142966
         9 | 58.7603069416189
         9 | 65.8289096339743
         9 | 66.3840449793426
        10 | 27.6364208231029
        10 | 30.1632209734123
        10 | 35.0903702996475
        10 | 79.6054423091845
(46 rows)
> SELECT d.deviceID, dm.TypeName
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
ORDER BY (
    SELECT AVG(ms.current) + AVG(ms.frequency)
    FROM tsdb.MeterSuper ms
    WHERE ms.deviceID = d.deviceID
) DESC,d.deviceID;
  deviceid | typename
-----------+-----------
         1 | 电表
         8 | 电表
         4 | 电表
         3 | 电表
         5 | 电表
         9 | 电表
        10 | 电表
         6 | 电表
         7 | 电表
         2 | 电表
        11 | 变压器
        12 | 变压器
        13 | 变压器
        14 | 变压器
        15 | 变压器
        16 | 变压器
        17 | 变压器
        18 | 变压器
        19 | 变压器
        20 | 变压器
        21 | 变压器
(21 rows)
> SELECT ms.deviceID, ms.current
FROM tsdb.MeterSuper ms
ORDER BY (
    SELECT d.installDate
    FROM rdb.Device d
    JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
    WHERE d.deviceID = ms.deviceID
) DESC,deviceid,current;
  deviceid |     current
-----------+-------------------
         5 | 38.3605591260021
         5 | 55.5757147937953
         8 | 43.7369827209636
         8 | 51.4086117972453
         8 | 97.2639127907299
        10 | 27.6364208231029
        10 | 30.1632209734123
        10 | 35.0903702996475
        10 | 79.6054423091845
         6 |  8.0020595087802
         6 | 21.2326354535832
         6 |  27.444401746537
         6 | 38.7726102322915
         4 | 50.3771483027861
         4 | 64.7608834949323
         4 | 70.4166998637219
         4 | 86.6408620731391
         7 |  2.5362712857187
         7 | 15.9094854493545
         7 | 32.2432444339341
         7 | 32.5922311651652
         9 |  1.4552285651376
         9 | 51.3779408142966
         9 | 58.7603069416189
         9 | 65.8289096339743
         9 | 66.3840449793426
         1 | 11.3623350383022
         1 | 51.3657007868602
         1 | 69.6333622281017
         1 |  83.497262058816
         1 | 92.1571660223094
         1 | 93.3225547467301
         1 | 99.4678675025397
         2 |  4.7143663137418
         2 | 11.1845391378352
         2 | 12.2075528531539
         2 | 26.9682940704655
         2 | 28.5696601355255
         2 | 77.9899693670714
         3 |  5.1943308789773
         3 | 19.1017958876088
         3 | 42.5942338040329
         3 | 83.6478628663485
         3 | 88.2676084108624
         3 | 89.7564312801932
         3 | 92.1492678972427
(46 rows)
> SELECT d.deviceID, dm.TypeName
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
ORDER BY (
    SELECT MIN(mc.ts)
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
) ASC, d.deviceID;
  deviceid | typename
-----------+-----------
         1 | 电表
         3 | 电表
         4 | 电表
         5 | 电表
         6 | 电表
         8 | 电表
         9 | 电表
        10 | 电表
        11 | 变压器
        12 | 变压器
        13 | 变压器
        15 | 变压器
        17 | 变压器
        19 | 变压器
        20 | 变压器
        21 | 变压器
        18 | 变压器
         7 | 电表
        14 | 变压器
        16 | 变压器
         2 | 电表
(21 rows)
> SELECT ms.deviceID, ms.current
FROM tsdb.MeterSuper ms
ORDER BY (
    SELECT  d.installDate
    FROM rdb.Device d
    JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
    WHERE d.deviceID = ms.deviceID
) ASC,deviceid,current;
  deviceid |     current
-----------+-------------------
         1 | 11.3623350383022
         1 | 51.3657007868602
         1 | 69.6333622281017
         1 |  83.497262058816
         1 | 92.1571660223094
         1 | 93.3225547467301
         1 | 99.4678675025397
         2 |  4.7143663137418
         2 | 11.1845391378352
         2 | 12.2075528531539
         2 | 26.9682940704655
         2 | 28.5696601355255
         2 | 77.9899693670714
         3 |  5.1943308789773
         3 | 19.1017958876088
         3 | 42.5942338040329
         3 | 83.6478628663485
         3 | 88.2676084108624
         3 | 89.7564312801932
         3 | 92.1492678972427
         4 | 50.3771483027861
         4 | 64.7608834949323
         4 | 70.4166998637219
         4 | 86.6408620731391
         7 |  2.5362712857187
         7 | 15.9094854493545
         7 | 32.2432444339341
         7 | 32.5922311651652
         9 |  1.4552285651376
         9 | 51.3779408142966
         9 | 58.7603069416189
         9 | 65.8289096339743
         9 | 66.3840449793426
         6 |  8.0020595087802
         6 | 21.2326354535832
         6 |  27.444401746537
         6 | 38.7726102322915
         5 | 38.3605591260021
         5 | 55.5757147937953
         8 | 43.7369827209636
         8 | 51.4086117972453
         8 | 97.2639127907299
        10 | 27.6364208231029
        10 | 30.1632209734123
        10 | 35.0903702996475
        10 | 79.6054423091845
(46 rows)
> SELECT d.deviceID
FROM rdb.Device d
WHERE d.deviceID IN (
    SELECT ms.deviceID
    FROM tsdb.MeterSuper ms
) order by deviceid;
  deviceid
------------
         1
         2
         3
         4
         5
         6
         7
         8
         9
        10
(10 rows)
> SELECT ms.current
FROM tsdb.MeterSuper ms
WHERE ms.deviceID = (
    SELECT d.deviceID
    FROM rdb.Device d
    WHERE d.deviceID = 1
);
      current
--------------------
  51.3657007868602
  11.3623350383022
   83.497262058816
  69.6333622281017
  92.1571660223094
  93.3225547467301
  99.4678675025397
(7 rows)
> SELECT d.deviceID
FROM rdb.Device d
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MeterSuper ms
    WHERE ms.deviceID = d.deviceID
    AND ms.voltage > 100
) order by deviceid;
  deviceid
------------
         1
         2
         3
         4
         5
         6
         7
         8
         9
        10
(10 rows)
> SELECT ms.voltage
FROM tsdb.MeterSuper ms
WHERE ms.deviceID IN (
    SELECT d.deviceID
    FROM rdb.Device d
    WHERE d.modelID = 2
) order by voltage;
      voltage
--------------------
  39.4609662728706
  73.3038314338742
  129.540332823266
  140.690224485548
  168.706203551883
  177.586383495766
  178.524534293103
  184.428403488133
  193.149378415718
  221.252417769086
(10 rows)
> SELECT d.deviceID
FROM rdb.Device d
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
    HAVING COUNT(*) > 10
);
  deviceid
------------
(0 rows)
> SELECT ms.current
FROM tsdb.MeterSuper ms
WHERE ms.deviceID BETWEEN (
    SELECT MIN(d.deviceID)
    FROM rdb.Device d
) AND (
    SELECT MAX(d.deviceID)
    FROM rdb.Device d
) order by current;
      current
--------------------
   1.4552285651376
   2.5362712857187
   4.7143663137418
   5.1943308789773
   8.0020595087802
  11.1845391378352
  11.3623350383022
  12.2075528531539
  15.9094854493545
  19.1017958876088
  21.2326354535832
  26.9682940704655
   27.444401746537
  27.6364208231029
  28.5696601355255
  30.1632209734123
  32.2432444339341
  32.5922311651652
  35.0903702996475
  38.3605591260021
  38.7726102322915
  42.5942338040329
  43.7369827209636
  50.3771483027861
  51.3657007868602
  51.3779408142966
  51.4086117972453
  55.5757147937953
  58.7603069416189
  64.7608834949323
  65.8289096339743
  66.3840449793426
  69.6333622281017
  70.4166998637219
  77.9899693670714
  79.6054423091845
   83.497262058816
  83.6478628663485
  86.6408620731391
  88.2676084108624
  89.7564312801932
  92.1492678972427
  92.1571660223094
  93.3225547467301
  97.2639127907299
  99.4678675025397
(46 rows)
> SELECT ms.current
FROM tsdb.MeterSuper ms
WHERE ms.deviceID BETWEEN 1 AND 5 order by current;
      current
--------------------
   4.7143663137418
   5.1943308789773
  11.1845391378352
  11.3623350383022
  12.2075528531539
  19.1017958876088
  26.9682940704655
  28.5696601355255
  38.3605591260021
  42.5942338040329
  50.3771483027861
  51.3657007868602
  55.5757147937953
  64.7608834949323
  69.6333622281017
  70.4166998637219
  77.9899693670714
   83.497262058816
  83.6478628663485
  86.6408620731391
  88.2676084108624
  89.7564312801932
  92.1492678972427
  92.1571660223094
  93.3225547467301
  99.4678675025397
(26 rows)
> SELECT d.deviceID
FROM rdb.Device d
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MeterSuper ms
    WHERE ms.deviceID = d.deviceID
    AND ms.current < 0
);
  deviceid
------------
(0 rows)
> SELECT ms.current
FROM tsdb.MeterSuper ms
WHERE ms.deviceID IN (
    SELECT d.deviceID
    FROM rdb.Device d
    WHERE EXISTS (
        SELECT 1
        FROM tsdb.MeterSuper ms2
        WHERE ms2.deviceID = d.deviceID
    )
) order by current;
      current
--------------------
   1.4552285651376
   2.5362712857187
   4.7143663137418
   5.1943308789773
   8.0020595087802
  11.1845391378352
  11.3623350383022
  12.2075528531539
  15.9094854493545
  19.1017958876088
  21.2326354535832
  26.9682940704655
   27.444401746537
  27.6364208231029
  28.5696601355255
  30.1632209734123
  32.2432444339341
  32.5922311651652
  35.0903702996475
  38.3605591260021
  38.7726102322915
  42.5942338040329
  43.7369827209636
  50.3771483027861
  51.3657007868602
  51.3779408142966
  51.4086117972453
  55.5757147937953
  58.7603069416189
  64.7608834949323
  65.8289096339743
  66.3840449793426
  69.6333622281017
  70.4166998637219
  77.9899693670714
  79.6054423091845
   83.497262058816
  83.6478628663485
  86.6408620731391
  88.2676084108624
  89.7564312801932
  92.1492678972427
  92.1571660223094
  93.3225547467301
  97.2639127907299
  99.4678675025397
(46 rows)
> SELECT d.deviceID
FROM rdb.Device d
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
    AND mc.status = 0
)order by deviceID;
  deviceid
------------
         2
        14
        18
(3 rows)
> SELECT ms.voltage
FROM tsdb.MeterSuper ms
WHERE ms.deviceID IN (
    SELECT d.deviceID
    FROM rdb.Device d
    WHERE d.modelID IN (
        SELECT DISTINCT ms2.modelID
        FROM tsdb.MeterSuper ms2
    )
) order by voltage;
      voltage
--------------------
   11.403069794533
  13.0252418928197
  23.3376270607565
  37.3173252950804
  38.3445896240576
  39.4609662728706
  42.1546680819372
  44.4525515100625
   63.650041383934
  66.6576742686871
   68.608811662107
  73.3038314338742
  89.6890974542114
  105.947176785265
  109.481594926408
  113.326792465594
  115.685714706139
  122.083784577671
  124.823615938242
  129.540332823266
  140.690224485548
  144.607216977954
  150.928638817977
  151.864034289804
  152.529755792575
  154.367306029744
  154.900605102746
  159.241597291105
  160.295718477005
  161.310822672952
  168.123109584792
  168.706203551883
  172.393339584028
   177.34815592286
  177.586383495766
  178.524534293103
  182.232060755966
  184.428403488133
  193.149378415718
  195.691458386067
  205.924083865798
  208.615787918257
  221.252417769086
  231.302018540164
  236.348242886617
  238.179538590531
(46 rows)
> SELECT d.deviceID, dm.TypeName, ms.current, ms.voltage
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
JOIN tsdb.MeterSuper ms ON d.deviceID = ms.deviceID order by deviceid,current;
  deviceid | typename |     current      |     voltage
-----------+----------+------------------+-------------------
         1 | 电表     | 11.3623350383022 | 152.529755792575
         1 | 电表     | 51.3657007868602 | 168.123109584792
         1 | 电表     | 69.6333622281017 | 238.179538590531
         1 | 电表     |  83.497262058816 | 109.481594926408
         1 | 电表     | 92.1571660223094 | 37.3173252950804
         1 | 电表     | 93.3225547467301 | 66.6576742686871
         1 | 电表     | 99.4678675025397 | 13.0252418928197
         2 | 电表     |  4.7143663137418 | 73.3038314338742
         2 | 电表     | 11.1845391378352 | 39.4609662728706
         2 | 电表     | 12.2075528531539 | 129.540332823266
         2 | 电表     | 26.9682940704655 | 221.252417769086
         2 | 电表     | 28.5696601355255 | 140.690224485548
         2 | 电表     | 77.9899693670714 | 193.149378415718
         3 | 电表     |  5.1943308789773 |  63.650041383934
         3 | 电表     | 19.1017958876088 | 115.685714706139
         3 | 电表     | 42.5942338040329 | 208.615787918257
         3 | 电表     | 83.6478628663485 | 89.6890974542114
         3 | 电表     | 88.2676084108624 | 151.864034289804
         3 | 电表     | 89.7564312801932 | 150.928638817977
         3 | 电表     | 92.1492678972427 | 122.083784577671
         4 | 电表     | 50.3771483027861 | 161.310822672952
         4 | 电表     | 64.7608834949323 |  11.403069794533
         4 | 电表     | 70.4166998637219 | 38.3445896240576
         4 | 电表     | 86.6408620731391 | 144.607216977954
         5 | 电表     | 38.3605591260021 | 154.900605102746
         5 | 电表     | 55.5757147937953 | 105.947176785265
         6 | 电表     |  8.0020595087802 | 124.823615938242
         6 | 电表     | 21.2326354535832 | 160.295718477005
         6 | 电表     |  27.444401746537 | 236.348242886617
         6 | 电表     | 38.7726102322915 | 44.4525515100625
         7 | 电表     |  2.5362712857187 | 184.428403488133
         7 | 电表     | 15.9094854493545 | 178.524534293103
         7 | 电表     | 32.2432444339341 | 177.586383495766
         7 | 电表     | 32.5922311651652 | 168.706203551883
         8 | 电表     | 43.7369827209636 |  68.608811662107
         8 | 电表     | 51.4086117972453 |  177.34815592286
         8 | 电表     | 97.2639127907299 | 23.3376270607565
         9 | 电表     |  1.4552285651376 | 113.326792465594
         9 | 电表     | 51.3779408142966 | 205.924083865798
         9 | 电表     | 58.7603069416189 | 159.241597291105
         9 | 电表     | 65.8289096339743 | 195.691458386067
         9 | 电表     | 66.3840449793426 | 182.232060755966
        10 | 电表     | 27.6364208231029 | 154.367306029744
        10 | 电表     | 30.1632209734123 | 172.393339584028
        10 | 电表     | 35.0903702996475 | 42.1546680819372
        10 | 电表     | 79.6054423091845 | 231.302018540164
(46 rows)
> SELECT ms.deviceID, ms.current, dm.TypeName, d.installDate
FROM tsdb.MeterSuper ms
JOIN rdb.Device d ON ms.deviceID = d.deviceID
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
WHERE d.deviceID = 1;
  deviceid |     current      | typename |        installdate
-----------+------------------+----------+----------------------------
         1 | 51.3657007868602 | 电表     | 2023-07-01 00:00:00+00:00
         1 | 11.3623350383022 | 电表     | 2023-07-01 00:00:00+00:00
         1 |  83.497262058816 | 电表     | 2023-07-01 00:00:00+00:00
         1 | 69.6333622281017 | 电表     | 2023-07-01 00:00:00+00:00
         1 | 92.1571660223094 | 电表     | 2023-07-01 00:00:00+00:00
         1 | 93.3225547467301 | 电表     | 2023-07-01 00:00:00+00:00
         1 | 99.4678675025397 | 电表     | 2023-07-01 00:00:00+00:00
(7 rows)
> SELECT d.deviceID, dm.TypeName, ms.current, ms.frequency
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
JOIN tsdb.MeterSuper ms ON d.deviceID = ms.deviceID
WHERE ms.voltage > 100 order by deviceid,current;
  deviceid | typename |     current      |    frequency
-----------+----------+------------------+-------------------
         1 | 电表     | 11.3623350383022 | 18.3155479848789
         1 | 电表     | 51.3657007868602 | 21.9499207558219
         1 | 电表     | 69.6333622281017 | 58.9094193706912
         1 | 电表     |  83.497262058816 | 27.3247611980655
         2 | 电表     | 12.2075528531539 | 18.7137334201641
         2 | 电表     | 26.9682940704655 | 22.8587538443064
         2 | 电表     | 28.5696601355255 | 16.0609791337855
         2 | 电表     | 77.9899693670714 | 15.1528517268839
         3 | 电表     | 19.1017958876088 | 1.19064069294282
         3 | 电表     | 42.5942338040329 | 42.0235732491163
         3 | 电表     | 88.2676084108624 | 26.3510798558143
         3 | 电表     | 89.7564312801932 | 9.72415321564185
         3 | 电表     | 92.1492678972427 | 27.4222859892684
         4 | 电表     | 50.3771483027861 | 57.6755664361319
         4 | 电表     | 86.6408620731391 | 50.9725199313202
         5 | 电表     | 38.3605591260021 | 47.7261438820055
         5 | 电表     | 55.5757147937953 | 29.4643461196237
         6 | 电表     |  8.0020595087802 | 53.8209955567292
         6 | 电表     | 21.2326354535832 | 46.0412660803375
         6 | 电表     |  27.444401746537 |  14.455974850198
         7 | 电表     |  2.5362712857187 | 19.7483576372737
         7 | 电表     | 15.9094854493545 | 36.9383322722616
         7 | 电表     | 32.2432444339341 | 3.31446460523622
         7 | 电表     | 32.5922311651652 | 50.6448815126542
         8 | 电表     | 51.4086117972453 | 3.01038255870466
         9 | 电表     |  1.4552285651376 | 30.4358871869071
         9 | 电表     | 51.3779408142966 |  18.087854549501
         9 | 电表     | 58.7603069416189 | 41.2031892727525
         9 | 电表     | 65.8289096339743 | 25.5717958601356
         9 | 电表     | 66.3840449793426 | 19.6441539895672
        10 | 电表     | 27.6364208231029 | 26.5355631647354
        10 | 电表     | 30.1632209734123 | 5.50441383726124
        10 | 电表     | 79.6054423091845 | 4.59731967014122
(33 rows)
> SELECT ms.deviceID, ms.current, dm.TypeName, d.installDate
FROM tsdb.MeterSuper ms
JOIN rdb.Device d ON ms.deviceID = d.deviceID
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
WHERE d.modelID = 2 order by deviceid,current;
  deviceid |     current      | typename |        installdate
-----------+------------------+----------+----------------------------
         2 |  4.7143663137418 | 电表     | 2023-07-01 00:00:00+00:00
         2 | 11.1845391378352 | 电表     | 2023-07-01 00:00:00+00:00
         2 | 12.2075528531539 | 电表     | 2023-07-01 00:00:00+00:00
         2 | 26.9682940704655 | 电表     | 2023-07-01 00:00:00+00:00
         2 | 28.5696601355255 | 电表     | 2023-07-01 00:00:00+00:00
         2 | 77.9899693670714 | 电表     | 2023-07-01 00:00:00+00:00
         7 |  2.5362712857187 | 电表     | 2023-07-02 00:00:00+00:00
         7 | 15.9094854493545 | 电表     | 2023-07-02 00:00:00+00:00
         7 | 32.2432444339341 | 电表     | 2023-07-02 00:00:00+00:00
         7 | 32.5922311651652 | 电表     | 2023-07-02 00:00:00+00:00
(10 rows)
> SELECT d.deviceID, dm.TypeName, AVG(mc.status), MAX(mc.status)
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
JOIN tsdb.MonitoringCenter mc ON d.deviceID = mc.deviceID
GROUP BY d.deviceID, dm.TypeName
HAVING COUNT(mc.status) > 10;
  deviceid | typename | avg | max
-----------+----------+-----+------
(0 rows)
> SELECT ms.deviceID, ms.current, dm.TypeName, d.installDate
FROM tsdb.MeterSuper ms
JOIN rdb.Device d ON ms.deviceID = d.deviceID
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
WHERE d.deviceID BETWEEN 1 AND 5 order by deviceid,current;
  deviceid |     current      | typename |        installdate
-----------+------------------+----------+----------------------------
         1 | 11.3623350383022 | 电表     | 2023-07-01 00:00:00+00:00
         1 | 51.3657007868602 | 电表     | 2023-07-01 00:00:00+00:00
         1 | 69.6333622281017 | 电表     | 2023-07-01 00:00:00+00:00
         1 |  83.497262058816 | 电表     | 2023-07-01 00:00:00+00:00
         1 | 92.1571660223094 | 电表     | 2023-07-01 00:00:00+00:00
         1 | 93.3225547467301 | 电表     | 2023-07-01 00:00:00+00:00
         1 | 99.4678675025397 | 电表     | 2023-07-01 00:00:00+00:00
         2 |  4.7143663137418 | 电表     | 2023-07-01 00:00:00+00:00
         2 | 11.1845391378352 | 电表     | 2023-07-01 00:00:00+00:00
         2 | 12.2075528531539 | 电表     | 2023-07-01 00:00:00+00:00
         2 | 26.9682940704655 | 电表     | 2023-07-01 00:00:00+00:00
         2 | 28.5696601355255 | 电表     | 2023-07-01 00:00:00+00:00
         2 | 77.9899693670714 | 电表     | 2023-07-01 00:00:00+00:00
         3 |  5.1943308789773 | 电表     | 2023-07-01 00:00:00+00:00
         3 | 19.1017958876088 | 电表     | 2023-07-01 00:00:00+00:00
         3 | 42.5942338040329 | 电表     | 2023-07-01 00:00:00+00:00
         3 | 83.6478628663485 | 电表     | 2023-07-01 00:00:00+00:00
         3 | 88.2676084108624 | 电表     | 2023-07-01 00:00:00+00:00
         3 | 89.7564312801932 | 电表     | 2023-07-01 00:00:00+00:00
         3 | 92.1492678972427 | 电表     | 2023-07-01 00:00:00+00:00
         4 | 50.3771483027861 | 电表     | 2023-07-02 00:00:00+00:00
         4 | 64.7608834949323 | 电表     | 2023-07-02 00:00:00+00:00
         4 | 70.4166998637219 | 电表     | 2023-07-02 00:00:00+00:00
         4 | 86.6408620731391 | 电表     | 2023-07-02 00:00:00+00:00
         5 | 38.3605591260021 | 电表     | 2023-07-04 00:00:00+00:00
         5 | 55.5757147937953 | 电表     | 2023-07-04 00:00:00+00:00
(26 rows)
> SELECT d.deviceID, dm.TypeName, ms.current, ms.voltage
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
JOIN tsdb.MeterSuper ms ON d.deviceID = ms.deviceID
WHERE ms.current < 0;
  deviceid | typename | current | voltage
-----------+----------+---------+----------
(0 rows)
> SELECT ms.current, dm.TypeName, d.installDate
FROM tsdb.MeterSuper ms
JOIN rdb.Device d ON ms.deviceID = d.deviceID
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
WHERE d.deviceID IN (
    SELECT deviceID
    FROM tsdb.MeterSuper
) order by current;
      current      | typename |        installdate
-------------------+----------+----------------------------
   1.4552285651376 | 电表     | 2023-07-02 00:00:00+00:00
   2.5362712857187 | 电表     | 2023-07-02 00:00:00+00:00
   4.7143663137418 | 电表     | 2023-07-01 00:00:00+00:00
   5.1943308789773 | 电表     | 2023-07-01 00:00:00+00:00
   8.0020595087802 | 电表     | 2023-07-03 00:00:00+00:00
  11.1845391378352 | 电表     | 2023-07-01 00:00:00+00:00
  11.3623350383022 | 电表     | 2023-07-01 00:00:00+00:00
  12.2075528531539 | 电表     | 2023-07-01 00:00:00+00:00
  15.9094854493545 | 电表     | 2023-07-02 00:00:00+00:00
  19.1017958876088 | 电表     | 2023-07-01 00:00:00+00:00
  21.2326354535832 | 电表     | 2023-07-03 00:00:00+00:00
  26.9682940704655 | 电表     | 2023-07-01 00:00:00+00:00
   27.444401746537 | 电表     | 2023-07-03 00:00:00+00:00
  27.6364208231029 | 电表     | 2023-07-04 00:00:00+00:00
  28.5696601355255 | 电表     | 2023-07-01 00:00:00+00:00
  30.1632209734123 | 电表     | 2023-07-04 00:00:00+00:00
  32.2432444339341 | 电表     | 2023-07-02 00:00:00+00:00
  32.5922311651652 | 电表     | 2023-07-02 00:00:00+00:00
  35.0903702996475 | 电表     | 2023-07-04 00:00:00+00:00
  38.3605591260021 | 电表     | 2023-07-04 00:00:00+00:00
  38.7726102322915 | 电表     | 2023-07-03 00:00:00+00:00
  42.5942338040329 | 电表     | 2023-07-01 00:00:00+00:00
  43.7369827209636 | 电表     | 2023-07-04 00:00:00+00:00
  50.3771483027861 | 电表     | 2023-07-02 00:00:00+00:00
  51.3657007868602 | 电表     | 2023-07-01 00:00:00+00:00
  51.3779408142966 | 电表     | 2023-07-02 00:00:00+00:00
  51.4086117972453 | 电表     | 2023-07-04 00:00:00+00:00
  55.5757147937953 | 电表     | 2023-07-04 00:00:00+00:00
  58.7603069416189 | 电表     | 2023-07-02 00:00:00+00:00
  64.7608834949323 | 电表     | 2023-07-02 00:00:00+00:00
  65.8289096339743 | 电表     | 2023-07-02 00:00:00+00:00
  66.3840449793426 | 电表     | 2023-07-02 00:00:00+00:00
  69.6333622281017 | 电表     | 2023-07-01 00:00:00+00:00
  70.4166998637219 | 电表     | 2023-07-02 00:00:00+00:00
  77.9899693670714 | 电表     | 2023-07-01 00:00:00+00:00
  79.6054423091845 | 电表     | 2023-07-04 00:00:00+00:00
   83.497262058816 | 电表     | 2023-07-01 00:00:00+00:00
  83.6478628663485 | 电表     | 2023-07-01 00:00:00+00:00
  86.6408620731391 | 电表     | 2023-07-02 00:00:00+00:00
  88.2676084108624 | 电表     | 2023-07-01 00:00:00+00:00
  89.7564312801932 | 电表     | 2023-07-01 00:00:00+00:00
  92.1492678972427 | 电表     | 2023-07-01 00:00:00+00:00
  92.1571660223094 | 电表     | 2023-07-01 00:00:00+00:00
  93.3225547467301 | 电表     | 2023-07-01 00:00:00+00:00
  97.2639127907299 | 电表     | 2023-07-04 00:00:00+00:00
  99.4678675025397 | 电表     | 2023-07-01 00:00:00+00:00
(46 rows)
> SELECT d.deviceID, dm.TypeName, AVG(mc.status), MIN(mc.status)
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
JOIN tsdb.MonitoringCenter mc ON d.deviceID = mc.deviceID
WHERE mc.status = 0
GROUP BY d.deviceID, dm.TypeName order by d.deviceID;
  deviceid | typename | avg | min
-----------+----------+-----+------
         2 | 电表     |   0 |   0
        14 | 变压器   |   0 |   0
        18 | 变压器   |   0 |   0
(3 rows)
> SELECT ms.voltage, dm.TypeName, d.installDate
FROM tsdb.MeterSuper ms
JOIN rdb.Device d ON ms.deviceID = d.deviceID
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
WHERE d.modelID IN (
    SELECT DISTINCT modelID
    FROM tsdb.MeterSuper
) order by voltage;
      voltage      | typename |        installdate
-------------------+----------+----------------------------
   11.403069794533 | 电表     | 2023-07-02 00:00:00+00:00
  13.0252418928197 | 电表     | 2023-07-01 00:00:00+00:00
  23.3376270607565 | 电表     | 2023-07-04 00:00:00+00:00
  37.3173252950804 | 电表     | 2023-07-01 00:00:00+00:00
  38.3445896240576 | 电表     | 2023-07-02 00:00:00+00:00
  39.4609662728706 | 电表     | 2023-07-01 00:00:00+00:00
  42.1546680819372 | 电表     | 2023-07-04 00:00:00+00:00
  44.4525515100625 | 电表     | 2023-07-03 00:00:00+00:00
   63.650041383934 | 电表     | 2023-07-01 00:00:00+00:00
  66.6576742686871 | 电表     | 2023-07-01 00:00:00+00:00
   68.608811662107 | 电表     | 2023-07-04 00:00:00+00:00
  73.3038314338742 | 电表     | 2023-07-01 00:00:00+00:00
  89.6890974542114 | 电表     | 2023-07-01 00:00:00+00:00
  105.947176785265 | 电表     | 2023-07-04 00:00:00+00:00
  109.481594926408 | 电表     | 2023-07-01 00:00:00+00:00
  113.326792465594 | 电表     | 2023-07-02 00:00:00+00:00
  115.685714706139 | 电表     | 2023-07-01 00:00:00+00:00
  122.083784577671 | 电表     | 2023-07-01 00:00:00+00:00
  124.823615938242 | 电表     | 2023-07-03 00:00:00+00:00
  129.540332823266 | 电表     | 2023-07-01 00:00:00+00:00
  140.690224485548 | 电表     | 2023-07-01 00:00:00+00:00
  144.607216977954 | 电表     | 2023-07-02 00:00:00+00:00
  150.928638817977 | 电表     | 2023-07-01 00:00:00+00:00
  151.864034289804 | 电表     | 2023-07-01 00:00:00+00:00
  152.529755792575 | 电表     | 2023-07-01 00:00:00+00:00
  154.367306029744 | 电表     | 2023-07-04 00:00:00+00:00
  154.900605102746 | 电表     | 2023-07-04 00:00:00+00:00
  159.241597291105 | 电表     | 2023-07-02 00:00:00+00:00
  160.295718477005 | 电表     | 2023-07-03 00:00:00+00:00
  161.310822672952 | 电表     | 2023-07-02 00:00:00+00:00
  168.123109584792 | 电表     | 2023-07-01 00:00:00+00:00
  168.706203551883 | 电表     | 2023-07-02 00:00:00+00:00
  172.393339584028 | 电表     | 2023-07-04 00:00:00+00:00
   177.34815592286 | 电表     | 2023-07-04 00:00:00+00:00
  177.586383495766 | 电表     | 2023-07-02 00:00:00+00:00
  178.524534293103 | 电表     | 2023-07-02 00:00:00+00:00
  182.232060755966 | 电表     | 2023-07-02 00:00:00+00:00
  184.428403488133 | 电表     | 2023-07-02 00:00:00+00:00
  193.149378415718 | 电表     | 2023-07-01 00:00:00+00:00
  195.691458386067 | 电表     | 2023-07-02 00:00:00+00:00
  205.924083865798 | 电表     | 2023-07-02 00:00:00+00:00
  208.615787918257 | 电表     | 2023-07-01 00:00:00+00:00
  221.252417769086 | 电表     | 2023-07-01 00:00:00+00:00
  231.302018540164 | 电表     | 2023-07-04 00:00:00+00:00
  236.348242886617 | 电表     | 2023-07-03 00:00:00+00:00
  238.179538590531 | 电表     | 2023-07-01 00:00:00+00:00
(46 rows)
> SELECT deviceID, NULL AS ts
FROM rdb.Device
UNION
SELECT NULL AS deviceID, ts
FROM tsdb.MonitoringCenter order by deviceid, ts;
  deviceid |              ts
-----------+--------------------------------
  NULL     | 2023-07-07 23:23:16.211+00:00
  NULL     | 2023-07-08 04:41:43.514+00:00
  NULL     | 2023-07-08 14:55:50.421+00:00
  NULL     | 2023-07-10 00:01:06.133+00:00
  NULL     | 2023-07-10 04:20:04.337+00:00
         1 | NULL
         2 | NULL
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 | NULL
         8 | NULL
         9 | NULL
        10 | NULL
        11 | NULL
        12 | NULL
        13 | NULL
        14 | NULL
        15 | NULL
        16 | NULL
        17 | NULL
        18 | NULL
        19 | NULL
        20 | NULL
        21 | NULL
(26 rows)
> SELECT ModelID, NULL AS current
FROM rdb.DeviceModel
UNION
SELECT NULL AS ModelID, current
FROM tsdb.MeterSuper order by modelid, current;
  modelid |     current
----------+-------------------
  NULL    |  1.4552285651376
  NULL    |  2.5362712857187
  NULL    |  4.7143663137418
  NULL    |  5.1943308789773
  NULL    |  8.0020595087802
  NULL    | 11.1845391378352
  NULL    | 11.3623350383022
  NULL    | 12.2075528531539
  NULL    | 15.9094854493545
  NULL    | 19.1017958876088
  NULL    | 21.2326354535832
  NULL    | 26.9682940704655
  NULL    |  27.444401746537
  NULL    | 27.6364208231029
  NULL    | 28.5696601355255
  NULL    | 30.1632209734123
  NULL    | 32.2432444339341
  NULL    | 32.5922311651652
  NULL    | 35.0903702996475
  NULL    | 38.3605591260021
  NULL    | 38.7726102322915
  NULL    | 42.5942338040329
  NULL    | 43.7369827209636
  NULL    | 50.3771483027861
  NULL    | 51.3657007868602
  NULL    | 51.3779408142966
  NULL    | 51.4086117972453
  NULL    | 55.5757147937953
  NULL    | 58.7603069416189
  NULL    | 64.7608834949323
  NULL    | 65.8289096339743
  NULL    | 66.3840449793426
  NULL    | 69.6333622281017
  NULL    | 70.4166998637219
  NULL    | 77.9899693670714
  NULL    | 79.6054423091845
  NULL    |  83.497262058816
  NULL    | 83.6478628663485
  NULL    | 86.6408620731391
  NULL    | 88.2676084108624
  NULL    | 89.7564312801932
  NULL    | 92.1492678972427
  NULL    | 92.1571660223094
  NULL    | 93.3225547467301
  NULL    | 97.2639127907299
  NULL    | 99.4678675025397
        1 | NULL
        2 | NULL
        3 | NULL
        4 | NULL
        5 | NULL
        6 | NULL
        7 | NULL
        8 | NULL
        9 | NULL
       10 | NULL
(56 rows)
> SELECT deviceID, NULL AS status
FROM rdb.Device
UNION
SELECT NULL AS deviceID, status
FROM tsdb.MonitoringCenter order by deviceID,status;
  deviceid | status
-----------+---------
  NULL     |     -1
  NULL     |      0
         1 | NULL
         2 | NULL
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 | NULL
         8 | NULL
         9 | NULL
        10 | NULL
        11 | NULL
        12 | NULL
        13 | NULL
        14 | NULL
        15 | NULL
        16 | NULL
        17 | NULL
        18 | NULL
        19 | NULL
        20 | NULL
        21 | NULL
(23 rows)
> SELECT ModelName, NULL AS frequency
FROM rdb.DeviceModel
UNION
SELECT NULL AS ModelName, frequency
FROM tsdb.MeterSuper order by ModelName, frequency;
   modelname   |     frequency
---------------+--------------------
  NULL         | 0.602579310396294
  NULL         |  1.19064069294282
  NULL         |  3.01038255870466
  NULL         |  3.31446460523622
  NULL         |  4.59731967014122
  NULL         |  5.50441383726124
  NULL         |   6.9986076663541
  NULL         |  8.27571492455618
  NULL         |  9.72415321564185
  NULL         |   14.455974850198
  NULL         |  15.1528517268839
  NULL         |  16.0609791337855
  NULL         |  16.8520033641003
  NULL         |   18.087854549501
  NULL         |  18.3155479848789
  NULL         |  18.7137334201641
  NULL         |  19.6441539895672
  NULL         |  19.7483576372737
  NULL         |  21.9499207558219
  NULL         |  22.8587538443064
  NULL         |  25.5717958601356
  NULL         |  26.3510798558143
  NULL         |  26.5355631647354
  NULL         |  27.3247611980655
  NULL         |  27.4222859892684
  NULL         |  29.4643461196237
  NULL         |  30.4358871869071
  NULL         |  36.9383322722616
  NULL         |  37.5976599982106
  NULL         |   37.929835054358
  NULL         |  41.2031892727525
  NULL         |  42.0235732491163
  NULL         |  43.9072248011065
  NULL         |  45.7828540678734
  NULL         |  46.0412660803375
  NULL         |  47.7261438820055
  NULL         |  50.6448815126542
  NULL         |  50.9725199313202
  NULL         |  52.2425306405712
  NULL         |  53.8209955567292
  NULL         |  54.7685818789391
  NULL         |  56.9383191613316
  NULL         |  57.6755664361319
  NULL         |  58.7212739638845
  NULL         |  58.9094193706912
  NULL         |   59.894456926546
  变压器模型10 | NULL
  变压器模型6  | NULL
  变压器模型7  | NULL
  变压器模型8  | NULL
  变压器模型9  | NULL
  电表模型1    | NULL
  电表模型2    | NULL
  电表模型3    | NULL
  电表模型4    | NULL
  电表模型5    | NULL
(56 rows)
> SELECT deviceID, NULL AS temperature
FROM rdb.Device
UNION
SELECT NULL AS deviceID, temperature
FROM tsdb.TransformerSuper order by deviceID,temperature;
  deviceid |    temperature
-----------+--------------------
  NULL     |  0.88726046519966
  NULL     | 0.888262181329367
  NULL     |  1.02756784982944
  NULL     |  1.78438278418483
  NULL     |   3.4270151228769
  NULL     |  3.70442755758447
  NULL     |  3.78880851739069
  NULL     |  4.02753975120433
  NULL     |  4.26001444506568
  NULL     |  5.17398884989191
  NULL     |  5.22039849693016
  NULL     |  7.40772839981332
  NULL     |   8.0043717691936
  NULL     |  8.32671806250303
  NULL     |  8.99106030213915
  NULL     |   9.9844596700062
  NULL     |  10.4835555524902
  NULL     |   12.141814707802
  NULL     |  12.7393411825183
  NULL     |  14.2588989676399
  NULL     |  14.6356906093611
  NULL     |  14.6568703114464
  NULL     |  14.7352206015563
  NULL     |  15.2389583134986
  NULL     |  15.3674872865237
  NULL     |  15.9826086472548
  NULL     |  16.0702858199367
  NULL     |  16.1441346256395
  NULL     |  16.3709197522662
  NULL     |  16.9353628958774
  NULL     |  17.6025290481215
  NULL     |  19.2503307615728
  NULL     |  19.9063912659477
  NULL     |  19.9842878240267
  NULL     |  20.4276840331148
  NULL     |  20.5944805823982
  NULL     |  21.1191449238325
  NULL     |  21.6289511267588
  NULL     |  22.8197108083401
  NULL     |  23.9241122925156
  NULL     |  27.8537278009513
  NULL     |  28.3796205960211
  NULL     |  28.3854293845305
  NULL     |  29.4223010516673
  NULL     |  29.7222816635839
  NULL     |  30.0818710128209
  NULL     |  31.8415012308714
  NULL     |  34.3656367316592
  NULL     |  35.6732716012075
  NULL     |  36.1938530615818
  NULL     |  36.2936778436917
  NULL     |  37.1860326026061
  NULL     |  37.9130750083995
  NULL     |  38.2180913775925
  NULL     |  38.3103532390913
         1 | NULL
         2 | NULL
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 | NULL
         8 | NULL
         9 | NULL
        10 | NULL
        11 | NULL
        12 | NULL
        13 | NULL
        14 | NULL
        15 | NULL
        16 | NULL
        17 | NULL
        18 | NULL
        19 | NULL
        20 | NULL
        21 | NULL
(76 rows)
> SELECT TypeName, NULL AS status
FROM rdb.DeviceModel
UNION
SELECT NULL AS TypeName, status
FROM tsdb.MonitoringCenter order by TypeName,status;
  typename | status
-----------+---------
  NULL     |     -1
  NULL     |      0
  变压器   | NULL
  电表     | NULL
(4 rows)
> SELECT installDate, NULL AS voltage
FROM rdb.Device
UNION
SELECT NULL AS installDate, voltage
FROM tsdb.MeterSuper  order by installDate, voltage;
         installdate        |     voltage
----------------------------+-------------------
  NULL                      |  11.403069794533
  NULL                      | 13.0252418928197
  NULL                      | 23.3376270607565
  NULL                      | 37.3173252950804
  NULL                      | 38.3445896240576
  NULL                      | 39.4609662728706
  NULL                      | 42.1546680819372
  NULL                      | 44.4525515100625
  NULL                      |  63.650041383934
  NULL                      | 66.6576742686871
  NULL                      |  68.608811662107
  NULL                      | 73.3038314338742
  NULL                      | 89.6890974542114
  NULL                      | 105.947176785265
  NULL                      | 109.481594926408
  NULL                      | 113.326792465594
  NULL                      | 115.685714706139
  NULL                      | 122.083784577671
  NULL                      | 124.823615938242
  NULL                      | 129.540332823266
  NULL                      | 140.690224485548
  NULL                      | 144.607216977954
  NULL                      | 150.928638817977
  NULL                      | 151.864034289804
  NULL                      | 152.529755792575
  NULL                      | 154.367306029744
  NULL                      | 154.900605102746
  NULL                      | 159.241597291105
  NULL                      | 160.295718477005
  NULL                      | 161.310822672952
  NULL                      | 168.123109584792
  NULL                      | 168.706203551883
  NULL                      | 172.393339584028
  NULL                      |  177.34815592286
  NULL                      | 177.586383495766
  NULL                      | 178.524534293103
  NULL                      | 182.232060755966
  NULL                      | 184.428403488133
  NULL                      | 193.149378415718
  NULL                      | 195.691458386067
  NULL                      | 205.924083865798
  NULL                      | 208.615787918257
  NULL                      | 221.252417769086
  NULL                      | 231.302018540164
  NULL                      | 236.348242886617
  NULL                      | 238.179538590531
  2023-07-01 00:00:00+00:00 | NULL
  2023-07-02 00:00:00+00:00 | NULL
  2023-07-03 00:00:00+00:00 | NULL
  2023-07-04 00:00:00+00:00 | NULL
(50 rows)
> SELECT TypeName, NULL AS frequency
FROM rdb.DeviceModel
UNION
SELECT NULL AS TypeName, frequency
FROM tsdb.TransformerSuper order by TypeName,frequency;
  typename |     frequency
-----------+--------------------
  NULL     | 0.128887904577155
  NULL     |  3.88934476100687
  NULL     |  5.03330816748402
  NULL     |  5.24889455764125
  NULL     |  5.65178560720362
  NULL     |  6.26727010942794
  NULL     |  7.07998283945599
  NULL     |  7.40748941885712
  NULL     |   8.4282595331878
  NULL     |  8.91706553719459
  NULL     |  9.81651559479857
  NULL     |  10.0507297269897
  NULL     |   10.417407156384
  NULL     |  11.4298093861557
  NULL     |  11.4559849803543
  NULL     |   12.677928946183
  NULL     |  14.8589832536621
  NULL     |  16.9730647978356
  NULL     |  18.1259609232502
  NULL     |  18.4386880878179
  NULL     |  19.6500047371521
  NULL     |  19.8535019992236
  NULL     |  20.0561956027087
  NULL     |  20.8859731929904
  NULL     |  22.4130930797138
  NULL     |  22.5364353596955
  NULL     |  25.3350295087435
  NULL     |  29.5717523088781
  NULL     |   30.168265976604
  NULL     |  33.6010026825349
  NULL     |  34.5913805653499
  NULL     |  34.8100182103951
  NULL     |  36.0546314605785
  NULL     |  36.3655120695077
  NULL     |    37.70059379019
  NULL     |  38.0144566068667
  NULL     |  38.4579349825266
  NULL     |  39.4962935467216
  NULL     |  40.5432051543244
  NULL     |  42.1179315296133
  NULL     |  43.5659862801811
  NULL     |  49.6691311423697
  NULL     |  50.3940697076095
  NULL     |  50.9209806421627
  NULL     |  52.9170017722981
  NULL     |  53.7155380731946
  NULL     |  54.5559089780465
  NULL     |  55.8747599998372
  NULL     |  56.3379525630364
  NULL     |  56.8033853758352
  NULL     |  58.1414720102914
  NULL     |  58.1800749814891
  NULL     |  58.6506239530332
  NULL     |  58.9849632586954
  NULL     |  59.7906621665983
  变压器   | NULL
  电表     | NULL
(57 rows)
> SELECT location, NULL AS ts
FROM rdb.Device
UNION
SELECT NULL AS location, ts
FROM tsdb.MonitoringCenter order by location, ts;
  location |              ts
-----------+--------------------------------
  NULL     | 2023-07-07 23:23:16.211+00:00
  NULL     | 2023-07-08 04:41:43.514+00:00
  NULL     | 2023-07-08 14:55:50.421+00:00
  NULL     | 2023-07-10 00:01:06.133+00:00
  NULL     | 2023-07-10 04:20:04.337+00:00
  area1    | NULL
  area2    | NULL
  area3    | NULL
(8 rows)
> SELECT ModelName, NULL AS current
FROM rdb.DeviceModel
UNION
SELECT NULL AS ModelName, current
FROM tsdb.MeterSuper order by ModelName,current;
   modelname   |     current
---------------+-------------------
  NULL         |  1.4552285651376
  NULL         |  2.5362712857187
  NULL         |  4.7143663137418
  NULL         |  5.1943308789773
  NULL         |  8.0020595087802
  NULL         | 11.1845391378352
  NULL         | 11.3623350383022
  NULL         | 12.2075528531539
  NULL         | 15.9094854493545
  NULL         | 19.1017958876088
  NULL         | 21.2326354535832
  NULL         | 26.9682940704655
  NULL         |  27.444401746537
  NULL         | 27.6364208231029
  NULL         | 28.5696601355255
  NULL         | 30.1632209734123
  NULL         | 32.2432444339341
  NULL         | 32.5922311651652
  NULL         | 35.0903702996475
  NULL         | 38.3605591260021
  NULL         | 38.7726102322915
  NULL         | 42.5942338040329
  NULL         | 43.7369827209636
  NULL         | 50.3771483027861
  NULL         | 51.3657007868602
  NULL         | 51.3779408142966
  NULL         | 51.4086117972453
  NULL         | 55.5757147937953
  NULL         | 58.7603069416189
  NULL         | 64.7608834949323
  NULL         | 65.8289096339743
  NULL         | 66.3840449793426
  NULL         | 69.6333622281017
  NULL         | 70.4166998637219
  NULL         | 77.9899693670714
  NULL         | 79.6054423091845
  NULL         |  83.497262058816
  NULL         | 83.6478628663485
  NULL         | 86.6408620731391
  NULL         | 88.2676084108624
  NULL         | 89.7564312801932
  NULL         | 92.1492678972427
  NULL         | 92.1571660223094
  NULL         | 93.3225547467301
  NULL         | 97.2639127907299
  NULL         | 99.4678675025397
  变压器模型10 | NULL
  变压器模型6  | NULL
  变压器模型7  | NULL
  变压器模型8  | NULL
  变压器模型9  | NULL
  电表模型1    | NULL
  电表模型2    | NULL
  电表模型3    | NULL
  电表模型4    | NULL
  电表模型5    | NULL
(56 rows)
> SELECT deviceID, installDate, location, NULL AS ts, NULL AS status
FROM rdb.Device
UNION ALL
SELECT NULL AS deviceID, NULL AS installDate, NULL AS location, ts, status
FROM tsdb.MonitoringCenter
ORDER BY deviceID ASC,ts;
  deviceid |        installdate        | location |              ts               | status
-----------+---------------------------+----------+-------------------------------+---------
  NULL     | NULL                      | NULL     | 2023-07-07 23:23:16.211+00:00 |      0
  NULL     | NULL                      | NULL     | 2023-07-08 04:41:43.514+00:00 |     -1
  NULL     | NULL                      | NULL     | 2023-07-08 14:55:50.421+00:00 |      0
  NULL     | NULL                      | NULL     | 2023-07-10 00:01:06.133+00:00 |     -1
  NULL     | NULL                      | NULL     | 2023-07-10 04:20:04.337+00:00 |      0
         1 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL
         2 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL
         3 | 2023-07-01 00:00:00+00:00 | area3    | NULL                          | NULL
         4 | 2023-07-02 00:00:00+00:00 | area1    | NULL                          | NULL
         5 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
         6 | 2023-07-03 00:00:00+00:00 | area2    | NULL                          | NULL
         7 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL
         8 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL
         9 | 2023-07-02 00:00:00+00:00 | area3    | NULL                          | NULL
        10 | 2023-07-04 00:00:00+00:00 | area2    | NULL                          | NULL
        11 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL
        12 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL
        13 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
        14 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL
        15 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL
        16 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL
        17 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL
        18 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL
        19 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL
        20 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
        21 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
(26 rows)
> SELECT ModelID, TypeID, ModelName, TypeName, NULL AS ts, NULL AS status
FROM rdb.DeviceModel
UNION ALL
SELECT NULL AS ModelID, NULL AS TypeID, NULL AS ModelName, NULL AS TypeName, ts, status
FROM tsdb.MonitoringCenter
ORDER BY ModelID ASC,ts;
  modelid | typeid |  modelname   | typename |              ts               | status
----------+--------+--------------+----------+-------------------------------+---------
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 23:23:16.211+00:00 |      0
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 04:41:43.514+00:00 |     -1
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 14:55:50.421+00:00 |      0
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 00:01:06.133+00:00 |     -1
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 04:20:04.337+00:00 |      0
        1 |      1 | 电表模型1    | 电表     | NULL                          | NULL
        2 |      1 | 电表模型2    | 电表     | NULL                          | NULL
        3 |      1 | 电表模型3    | 电表     | NULL                          | NULL
        4 |      1 | 电表模型4    | 电表     | NULL                          | NULL
        5 |      1 | 电表模型5    | 电表     | NULL                          | NULL
        6 |      2 | 变压器模型6  | 变压器   | NULL                          | NULL
        7 |      2 | 变压器模型7  | 变压器   | NULL                          | NULL
        8 |      2 | 变压器模型8  | 变压器   | NULL                          | NULL
        9 |      2 | 变压器模型9  | 变压器   | NULL                          | NULL
       10 |      2 | 变压器模型10 | 变压器   | NULL                          | NULL
(15 rows)
> SELECT deviceID, installDate, location, NULL AS ts, NULL AS current, NULL AS voltage, NULL AS frequency
FROM rdb.Device
UNION ALL
SELECT NULL AS deviceID, NULL AS installDate, NULL AS location, ts, current, voltage, frequency
FROM tsdb.MeterSuper
ORDER BY deviceID ASC,ts;
  deviceid |        installdate        | location |              ts               |     current      |     voltage      |     frequency
-----------+---------------------------+----------+-------------------------------+------------------+------------------+--------------------
  NULL     | NULL                      | NULL     | 2023-07-05 21:59:04.182+00:00 |  1.4552285651376 | 113.326792465594 |  30.4358871869071
  NULL     | NULL                      | NULL     | 2023-07-07 16:13:06.336+00:00 | 88.2676084108624 | 151.864034289804 |  26.3510798558143
  NULL     | NULL                      | NULL     | 2023-07-07 16:36:31.395+00:00 | 89.7564312801932 | 150.928638817977 |  9.72415321564185
  NULL     | NULL                      | NULL     | 2023-07-07 17:20:49.141+00:00 | 30.1632209734123 | 172.393339584028 |  5.50441383726124
  NULL     | NULL                      | NULL     | 2023-07-08 00:08:14.696+00:00 | 28.5696601355255 | 140.690224485548 |  16.0609791337855
  NULL     | NULL                      | NULL     | 2023-07-08 04:18:54.237+00:00 | 38.7726102322915 | 44.4525515100625 |   37.929835054358
  NULL     | NULL                      | NULL     | 2023-07-08 06:14:37.171+00:00 | 64.7608834949323 |  11.403069794533 |   6.9986076663541
  NULL     | NULL                      | NULL     | 2023-07-08 09:56:25.22+00:00  | 32.2432444339341 | 177.586383495766 |  3.31446460523622
  NULL     | NULL                      | NULL     | 2023-07-08 20:39:44.321+00:00 | 66.3840449793426 | 182.232060755966 |  19.6441539895672
  NULL     | NULL                      | NULL     | 2023-07-08 20:51:54.682+00:00 |  5.1943308789773 |  63.650041383934 |  52.2425306405712
  NULL     | NULL                      | NULL     | 2023-07-08 23:01:41.987+00:00 |  8.0020595087802 | 124.823615938242 |  53.8209955567292
  NULL     | NULL                      | NULL     | 2023-07-09 01:08:32.321+00:00 | 65.8289096339743 | 195.691458386067 |  25.5717958601356
  NULL     | NULL                      | NULL     | 2023-07-09 05:17:11.599+00:00 | 51.3657007868602 | 168.123109584792 |  21.9499207558219
  NULL     | NULL                      | NULL     | 2023-07-09 06:03:05.815+00:00 | 19.1017958876088 | 115.685714706139 |  1.19064069294282
  NULL     | NULL                      | NULL     | 2023-07-09 07:30:23.078+00:00 | 32.5922311651652 | 168.706203551883 |  50.6448815126542
  NULL     | NULL                      | NULL     | 2023-07-09 08:29:58.163+00:00 | 79.6054423091845 | 231.302018540164 |  4.59731967014122
  NULL     | NULL                      | NULL     | 2023-07-09 08:51:17.852+00:00 | 86.6408620731391 | 144.607216977954 |  50.9725199313202
  NULL     | NULL                      | NULL     | 2023-07-09 11:58:38.783+00:00 | 35.0903702996475 | 42.1546680819372 |  54.7685818789391
  NULL     | NULL                      | NULL     | 2023-07-09 15:08:47.661+00:00 | 38.3605591260021 | 154.900605102746 |  47.7261438820055
  NULL     | NULL                      | NULL     | 2023-07-09 16:27:56.456+00:00 | 11.3623350383022 | 152.529755792575 |  18.3155479848789
  NULL     | NULL                      | NULL     | 2023-07-09 17:57:30.224+00:00 | 12.2075528531539 | 129.540332823266 |  18.7137334201641
  NULL     | NULL                      | NULL     | 2023-07-09 18:29:18.423+00:00 | 83.6478628663485 | 89.6890974542114 |  37.5976599982106
  NULL     | NULL                      | NULL     | 2023-07-09 18:34:48.36+00:00  |  83.497262058816 | 109.481594926408 |  27.3247611980655
  NULL     | NULL                      | NULL     | 2023-07-09 18:39:30.438+00:00 |  4.7143663137418 | 73.3038314338742 |  8.27571492455618
  NULL     | NULL                      | NULL     | 2023-07-09 19:30:26.451+00:00 | 69.6333622281017 | 238.179538590531 |  58.9094193706912
  NULL     | NULL                      | NULL     | 2023-07-09 20:59:09.025+00:00 | 43.7369827209636 |  68.608811662107 |   59.894456926546
  NULL     | NULL                      | NULL     | 2023-07-09 22:23:27.094+00:00 | 21.2326354535832 | 160.295718477005 |  46.0412660803375
  NULL     | NULL                      | NULL     | 2023-07-09 22:48:17.624+00:00 | 55.5757147937953 | 105.947176785265 |  29.4643461196237
  NULL     | NULL                      | NULL     | 2023-07-09 23:26:27.903+00:00 |  2.5362712857187 | 184.428403488133 |  19.7483576372737
  NULL     | NULL                      | NULL     | 2023-07-10 00:48:26.703+00:00 |  27.444401746537 | 236.348242886617 |   14.455974850198
  NULL     | NULL                      | NULL     | 2023-07-10 00:56:07.349+00:00 | 77.9899693670714 | 193.149378415718 |  15.1528517268839
  NULL     | NULL                      | NULL     | 2023-07-10 00:56:27.711+00:00 | 26.9682940704655 | 221.252417769086 |  22.8587538443064
  NULL     | NULL                      | NULL     | 2023-07-10 01:24:52.379+00:00 | 11.1845391378352 | 39.4609662728706 | 0.602579310396294
  NULL     | NULL                      | NULL     | 2023-07-10 02:03:34.875+00:00 | 92.1571660223094 | 37.3173252950804 |  58.7212739638845
  NULL     | NULL                      | NULL     | 2023-07-10 02:25:17.444+00:00 | 27.6364208231029 | 154.367306029744 |  26.5355631647354
  NULL     | NULL                      | NULL     | 2023-07-10 02:36:56.581+00:00 | 58.7603069416189 | 159.241597291105 |  41.2031892727525
  NULL     | NULL                      | NULL     | 2023-07-10 02:55:40.981+00:00 | 50.3771483027861 | 161.310822672952 |  57.6755664361319
  NULL     | NULL                      | NULL     | 2023-07-10 03:13:15.191+00:00 | 51.3779408142966 | 205.924083865798 |   18.087854549501
  NULL     | NULL                      | NULL     | 2023-07-10 03:45:32.968+00:00 | 92.1492678972427 | 122.083784577671 |  27.4222859892684
  NULL     | NULL                      | NULL     | 2023-07-10 04:04:07.144+00:00 | 99.4678675025397 | 13.0252418928197 |  45.7828540678734
  NULL     | NULL                      | NULL     | 2023-07-10 04:37:27.129+00:00 | 93.3225547467301 | 66.6576742686871 |  43.9072248011065
  NULL     | NULL                      | NULL     | 2023-07-10 05:09:17.235+00:00 | 97.2639127907299 | 23.3376270607565 |  56.9383191613316
  NULL     | NULL                      | NULL     | 2023-07-10 05:33:16.169+00:00 | 42.5942338040329 | 208.615787918257 |  42.0235732491163
  NULL     | NULL                      | NULL     | 2023-07-10 05:48:09.817+00:00 | 70.4166998637219 | 38.3445896240576 |  16.8520033641003
  NULL     | NULL                      | NULL     | 2023-07-10 06:08:56.784+00:00 | 51.4086117972453 |  177.34815592286 |  3.01038255870466
  NULL     | NULL                      | NULL     | 2023-07-10 06:19:18.908+00:00 | 15.9094854493545 | 178.524534293103 |  36.9383322722616
         1 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
         2 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
         3 | 2023-07-01 00:00:00+00:00 | area3    | NULL                          | NULL             | NULL             | NULL
         4 | 2023-07-02 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
         5 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
         6 | 2023-07-03 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
         7 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
         8 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL             | NULL             | NULL
         9 | 2023-07-02 00:00:00+00:00 | area3    | NULL                          | NULL             | NULL             | NULL
        10 | 2023-07-04 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
        11 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
        12 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
        13 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
        14 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
        15 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
        16 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL             | NULL             | NULL
        17 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
        18 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
        19 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
        20 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
        21 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
(67 rows)
> SELECT ModelID, TypeID, ModelName, TypeName, NULL AS ts, NULL AS current, NULL AS voltage, NULL AS frequency
FROM rdb.DeviceModel
UNION ALL
SELECT NULL AS ModelID, NULL AS TypeID, NULL AS ModelName, NULL AS TypeName, ts, current, voltage, frequency
FROM tsdb.MeterSuper
ORDER BY ModelID ASC,ts;
  modelid | typeid |  modelname   | typename |              ts               |     current      |     voltage      |     frequency
----------+--------+--------------+----------+-------------------------------+------------------+------------------+--------------------
  NULL    | NULL   | NULL         | NULL     | 2023-07-05 21:59:04.182+00:00 |  1.4552285651376 | 113.326792465594 |  30.4358871869071
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 16:13:06.336+00:00 | 88.2676084108624 | 151.864034289804 |  26.3510798558143
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 16:36:31.395+00:00 | 89.7564312801932 | 150.928638817977 |  9.72415321564185
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 17:20:49.141+00:00 | 30.1632209734123 | 172.393339584028 |  5.50441383726124
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 00:08:14.696+00:00 | 28.5696601355255 | 140.690224485548 |  16.0609791337855
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 04:18:54.237+00:00 | 38.7726102322915 | 44.4525515100625 |   37.929835054358
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 06:14:37.171+00:00 | 64.7608834949323 |  11.403069794533 |   6.9986076663541
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 09:56:25.22+00:00  | 32.2432444339341 | 177.586383495766 |  3.31446460523622
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 20:39:44.321+00:00 | 66.3840449793426 | 182.232060755966 |  19.6441539895672
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 20:51:54.682+00:00 |  5.1943308789773 |  63.650041383934 |  52.2425306405712
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 23:01:41.987+00:00 |  8.0020595087802 | 124.823615938242 |  53.8209955567292
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 01:08:32.321+00:00 | 65.8289096339743 | 195.691458386067 |  25.5717958601356
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 05:17:11.599+00:00 | 51.3657007868602 | 168.123109584792 |  21.9499207558219
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 06:03:05.815+00:00 | 19.1017958876088 | 115.685714706139 |  1.19064069294282
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 07:30:23.078+00:00 | 32.5922311651652 | 168.706203551883 |  50.6448815126542
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 08:29:58.163+00:00 | 79.6054423091845 | 231.302018540164 |  4.59731967014122
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 08:51:17.852+00:00 | 86.6408620731391 | 144.607216977954 |  50.9725199313202
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 11:58:38.783+00:00 | 35.0903702996475 | 42.1546680819372 |  54.7685818789391
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 15:08:47.661+00:00 | 38.3605591260021 | 154.900605102746 |  47.7261438820055
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 16:27:56.456+00:00 | 11.3623350383022 | 152.529755792575 |  18.3155479848789
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 17:57:30.224+00:00 | 12.2075528531539 | 129.540332823266 |  18.7137334201641
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 18:29:18.423+00:00 | 83.6478628663485 | 89.6890974542114 |  37.5976599982106
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 18:34:48.36+00:00  |  83.497262058816 | 109.481594926408 |  27.3247611980655
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 18:39:30.438+00:00 |  4.7143663137418 | 73.3038314338742 |  8.27571492455618
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 19:30:26.451+00:00 | 69.6333622281017 | 238.179538590531 |  58.9094193706912
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 20:59:09.025+00:00 | 43.7369827209636 |  68.608811662107 |   59.894456926546
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 22:23:27.094+00:00 | 21.2326354535832 | 160.295718477005 |  46.0412660803375
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 22:48:17.624+00:00 | 55.5757147937953 | 105.947176785265 |  29.4643461196237
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 23:26:27.903+00:00 |  2.5362712857187 | 184.428403488133 |  19.7483576372737
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 00:48:26.703+00:00 |  27.444401746537 | 236.348242886617 |   14.455974850198
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 00:56:07.349+00:00 | 77.9899693670714 | 193.149378415718 |  15.1528517268839
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 00:56:27.711+00:00 | 26.9682940704655 | 221.252417769086 |  22.8587538443064
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 01:24:52.379+00:00 | 11.1845391378352 | 39.4609662728706 | 0.602579310396294
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 02:03:34.875+00:00 | 92.1571660223094 | 37.3173252950804 |  58.7212739638845
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 02:25:17.444+00:00 | 27.6364208231029 | 154.367306029744 |  26.5355631647354
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 02:36:56.581+00:00 | 58.7603069416189 | 159.241597291105 |  41.2031892727525
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 02:55:40.981+00:00 | 50.3771483027861 | 161.310822672952 |  57.6755664361319
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 03:13:15.191+00:00 | 51.3779408142966 | 205.924083865798 |   18.087854549501
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 03:45:32.968+00:00 | 92.1492678972427 | 122.083784577671 |  27.4222859892684
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 04:04:07.144+00:00 | 99.4678675025397 | 13.0252418928197 |  45.7828540678734
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 04:37:27.129+00:00 | 93.3225547467301 | 66.6576742686871 |  43.9072248011065
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 05:09:17.235+00:00 | 97.2639127907299 | 23.3376270607565 |  56.9383191613316
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 05:33:16.169+00:00 | 42.5942338040329 | 208.615787918257 |  42.0235732491163
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 05:48:09.817+00:00 | 70.4166998637219 | 38.3445896240576 |  16.8520033641003
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 06:08:56.784+00:00 | 51.4086117972453 |  177.34815592286 |  3.01038255870466
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 06:19:18.908+00:00 | 15.9094854493545 | 178.524534293103 |  36.9383322722616
        1 |      1 | 电表模型1    | 电表     | NULL                          | NULL             | NULL             | NULL
        2 |      1 | 电表模型2    | 电表     | NULL                          | NULL             | NULL             | NULL
        3 |      1 | 电表模型3    | 电表     | NULL                          | NULL             | NULL             | NULL
        4 |      1 | 电表模型4    | 电表     | NULL                          | NULL             | NULL             | NULL
        5 |      1 | 电表模型5    | 电表     | NULL                          | NULL             | NULL             | NULL
        6 |      2 | 变压器模型6  | 变压器   | NULL                          | NULL             | NULL             | NULL
        7 |      2 | 变压器模型7  | 变压器   | NULL                          | NULL             | NULL             | NULL
        8 |      2 | 变压器模型8  | 变压器   | NULL                          | NULL             | NULL             | NULL
        9 |      2 | 变压器模型9  | 变压器   | NULL                          | NULL             | NULL             | NULL
       10 |      2 | 变压器模型10 | 变压器   | NULL                          | NULL             | NULL             | NULL
(56 rows)
> SELECT deviceID, installDate, location, NULL AS ts, NULL AS current, NULL AS voltage, NULL AS frequency, NULL AS temperature
FROM rdb.Device
UNION ALL
SELECT NULL AS deviceID, NULL AS installDate, NULL AS location, ts, current, voltage, frequency, temperature
FROM tsdb.TransformerSuper
ORDER BY deviceID ASC,ts;
  deviceid |        installdate        | location |              ts               |      current      |     voltage      |     frequency     |    temperature
-----------+---------------------------+----------+-------------------------------+-------------------+------------------+-------------------+--------------------
  NULL     | NULL                      | NULL     | 2023-07-04 23:31:56.375+00:00 |  52.6645802382902 | 90.2966818407791 |  59.7906621665983 |  29.7222816635839
  NULL     | NULL                      | NULL     | 2023-07-05 19:06:03.818+00:00 |  24.9879851735457 | 72.9023828811242 |  16.9730647978356 |  36.2936778436917
  NULL     | NULL                      | NULL     | 2023-07-06 13:07:03.932+00:00 |  65.4808199433695 | 188.256752793934 |  36.3655120695077 |   3.4270151228769
  NULL     | NULL                      | NULL     | 2023-07-07 01:58:30.974+00:00 |  22.7135181634573 | 20.6630930277035 |  50.3940697076095 |  15.9826086472548
  NULL     | NULL                      | NULL     | 2023-07-07 08:03:17.177+00:00 |  43.9618086514638 | 154.080199954059 |  18.4386880878179 |  19.9063912659477
  NULL     | NULL                      | NULL     | 2023-07-07 15:25:08.656+00:00 |  80.7028813987483 | 226.761499606397 |  22.5364353596955 |  17.6025290481215
  NULL     | NULL                      | NULL     | 2023-07-07 16:34:00.392+00:00 |  45.2388433918319 |  99.004578998381 |  56.8033853758352 |   8.0043717691936
  NULL     | NULL                      | NULL     | 2023-07-07 22:21:08.139+00:00 |  99.0213883825213 | 223.713905458791 |  20.0561956027087 |  15.2389583134986
  NULL     | NULL                      | NULL     | 2023-07-07 23:53:58.05+00:00  |  25.0800514940146 | 131.974313155946 |  34.8100182103951 |  29.4223010516673
  NULL     | NULL                      | NULL     | 2023-07-08 00:12:44.892+00:00 |   29.141342330967 | 210.572640997603 |  55.8747599998372 |  0.88726046519966
  NULL     | NULL                      | NULL     | 2023-07-08 16:14:12.922+00:00 |  36.0909239408848 | 108.395207224193 |  25.3350295087435 |  38.2180913775925
  NULL     | NULL                      | NULL     | 2023-07-08 16:59:52.729+00:00 |  60.5488223239337 | 205.185891118596 |  19.8535019992236 |  4.26001444506568
  NULL     | NULL                      | NULL     | 2023-07-08 17:02:57.968+00:00 |   55.861789989644 | 49.2138283756682 |  10.0507297269897 |  27.8537278009513
  NULL     | NULL                      | NULL     | 2023-07-08 21:00:47.294+00:00 |  32.9024015492564 |  7.3255922041065 |   10.417407156384 |  8.32671806250303
  NULL     | NULL                      | NULL     | 2023-07-08 21:35:55.531+00:00 |  4.41960851489149 | 128.985755360718 |  40.5432051543244 |  35.6732716012075
  NULL     | NULL                      | NULL     | 2023-07-09 00:30:42.935+00:00 |  20.7830495176516 | 215.613071987667 |  54.5559089780465 |  4.02753975120433
  NULL     | NULL                      | NULL     | 2023-07-09 01:06:58.703+00:00 |  55.3486769858061 | 72.4093102835067 |  53.7155380731946 |  3.70442755758447
  NULL     | NULL                      | NULL     | 2023-07-09 11:02:45.648+00:00 |  62.0784232408795 | 90.3264767630324 |  5.24889455764125 |  14.2588989676399
  NULL     | NULL                      | NULL     | 2023-07-09 11:04:00.448+00:00 |  85.2337550871699 | 19.4365034998361 |    37.70059379019 |  8.99106030213915
  NULL     | NULL                      | NULL     | 2023-07-09 12:39:09.234+00:00 |  93.5522968739871 | 221.387096571049 |  5.65178560720362 |  30.0818710128209
  NULL     | NULL                      | NULL     | 2023-07-09 12:53:43.162+00:00 | 0.832251979106502 | 210.968491569062 |  7.07998283945599 |  20.5944805823982
  NULL     | NULL                      | NULL     | 2023-07-09 12:59:55.048+00:00 |  10.6589665223002 | 34.3637179200209 |  36.0546314605785 | 0.888262181329367
  NULL     | NULL                      | NULL     | 2023-07-09 15:28:55.104+00:00 |  17.0663783798606 | 142.441602089027 |  34.5913805653499 |  21.1191449238325
  NULL     | NULL                      | NULL     | 2023-07-09 15:52:46.965+00:00 |   17.312386131568 | 195.579912227776 |  49.6691311423697 |  10.4835555524902
  NULL     | NULL                      | NULL     | 2023-07-09 16:03:06.617+00:00 |   31.504070234341 | 127.986337408089 |   8.4282595331878 |  37.9130750083995
  NULL     | NULL                      | NULL     | 2023-07-09 16:03:27.034+00:00 |  87.2790526281609 | 206.070347266935 |  19.6500047371521 |  23.9241122925156
  NULL     | NULL                      | NULL     | 2023-07-09 19:16:34.716+00:00 |  79.0631329018989 |  236.11866419811 |  11.4298093861557 |  1.02756784982944
  NULL     | NULL                      | NULL     | 2023-07-09 19:19:38.863+00:00 |   3.2731315534992 | 70.0397236701451 |  58.9849632586954 |  37.1860326026061
  NULL     | NULL                      | NULL     | 2023-07-09 19:19:44.244+00:00 |  37.8918817740594 | 161.355020828364 |  58.1800749814891 |  14.7352206015563
  NULL     | NULL                      | NULL     | 2023-07-09 19:28:09.126+00:00 |  91.5020840605461 | 220.624857600152 |  22.4130930797138 |  31.8415012308714
  NULL     | NULL                      | NULL     | 2023-07-09 19:41:34.608+00:00 |   35.838912661572 | 123.099698869876 |  3.88934476100687 |  19.2503307615728
  NULL     | NULL                      | NULL     | 2023-07-09 20:05:51.094+00:00 |  88.2028084565192 |  97.649389955192 |  38.4579349825266 |  20.4276840331148
  NULL     | NULL                      | NULL     | 2023-07-09 20:33:49.565+00:00 |   15.245646381004 | 118.979588026805 |  5.03330816748402 |  5.17398884989191
  NULL     | NULL                      | NULL     | 2023-07-09 21:14:38.359+00:00 |  66.9504922275415 |   31.95429667723 |  52.9170017722981 |  16.1441346256395
  NULL     | NULL                      | NULL     | 2023-07-09 21:14:41.547+00:00 |  53.9127789548584 | 108.511358445958 |  39.4962935467216 |   12.141814707802
  NULL     | NULL                      | NULL     | 2023-07-09 21:39:27.497+00:00 |  5.29879598620902 | 163.309371206004 |  6.26727010942794 |  7.40772839981332
  NULL     | NULL                      | NULL     | 2023-07-09 21:43:54.89+00:00  |  85.5810191036721 |   43.27803927302 |  56.3379525630364 |  38.3103532390913
  NULL     | NULL                      | NULL     | 2023-07-09 21:51:01.906+00:00 |  1.47005709589649 | 61.2819106751286 |  20.8859731929904 |  36.1938530615818
  NULL     | NULL                      | NULL     | 2023-07-09 23:24:07.371+00:00 |   77.876255321485 | 112.812116134239 |  29.5717523088781 |  3.78880851739069
  NULL     | NULL                      | NULL     | 2023-07-09 23:54:00.036+00:00 |  91.9097851757016 | 89.8234905187272 |  9.81651559479857 |  28.3854293845305
  NULL     | NULL                      | NULL     | 2023-07-10 00:31:23.234+00:00 |  91.8309643480256 | 98.2060767880287 |  8.91706553719459 |  14.6356906093611
  NULL     | NULL                      | NULL     | 2023-07-10 00:43:24.784+00:00 |  17.9443341967612 |  62.093309068496 |   12.677928946183 |  16.3709197522662
  NULL     | NULL                      | NULL     | 2023-07-10 00:59:30.129+00:00 |  40.2841232147225 | 95.5581273127987 |   30.168265976604 |  28.3796205960211
  NULL     | NULL                      | NULL     | 2023-07-10 01:32:00.466+00:00 |  56.3362346237103 | 197.815366563331 | 0.128887904577155 |  19.9842878240267
  NULL     | NULL                      | NULL     | 2023-07-10 01:53:16.06+00:00  |  90.7270041420773 |  47.376657484987 |  58.1414720102914 |  21.6289511267588
  NULL     | NULL                      | NULL     | 2023-07-10 03:04:43.065+00:00 |  25.0607281292901 | 168.258950009786 |  38.0144566068667 |  12.7393411825183
  NULL     | NULL                      | NULL     | 2023-07-10 03:06:00.513+00:00 |  50.7714850897091 |  144.99413205258 |  58.6506239530332 |  5.22039849693016
  NULL     | NULL                      | NULL     | 2023-07-10 04:08:50.574+00:00 |  17.3987235568273 | 153.226330096026 |  11.4559849803543 |  22.8197108083401
  NULL     | NULL                      | NULL     | 2023-07-10 04:50:14.702+00:00 |   51.740815879706 |   225.5419937595 |  33.6010026825349 |   9.9844596700062
  NULL     | NULL                      | NULL     | 2023-07-10 04:58:21.72+00:00  |  92.2529547112337 | 7.46273196927859 |  50.9209806421627 |  34.3656367316592
  NULL     | NULL                      | NULL     | 2023-07-10 05:32:26.736+00:00 |  34.2366657909409 | 136.836842086963 |  42.1179315296133 |  14.6568703114464
  NULL     | NULL                      | NULL     | 2023-07-10 05:38:07.211+00:00 |  11.9868726942194 | 120.126571230442 |  43.5659862801811 |  16.0702858199367
  NULL     | NULL                      | NULL     | 2023-07-10 06:06:57.554+00:00 |  73.2377570573377 | 233.658626518117 |  18.1259609232502 |  15.3674872865237
  NULL     | NULL                      | NULL     | 2023-07-10 06:16:57.573+00:00 |  19.0125643334454 | 200.658115852603 |  7.40748941885712 |  1.78438278418483
  NULL     | NULL                      | NULL     | 2023-07-10 06:17:09.386+00:00 |   82.798367747235 | 74.3088997740017 |  14.8589832536621 |  16.9353628958774
         1 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL              | NULL             | NULL              | NULL
         2 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL              | NULL             | NULL              | NULL
         3 | 2023-07-01 00:00:00+00:00 | area3    | NULL                          | NULL              | NULL             | NULL              | NULL
         4 | 2023-07-02 00:00:00+00:00 | area1    | NULL                          | NULL              | NULL             | NULL              | NULL
         5 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL              | NULL             | NULL              | NULL
         6 | 2023-07-03 00:00:00+00:00 | area2    | NULL                          | NULL              | NULL             | NULL              | NULL
         7 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL              | NULL             | NULL              | NULL
         8 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL              | NULL             | NULL              | NULL
         9 | 2023-07-02 00:00:00+00:00 | area3    | NULL                          | NULL              | NULL             | NULL              | NULL
        10 | 2023-07-04 00:00:00+00:00 | area2    | NULL                          | NULL              | NULL             | NULL              | NULL
        11 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL              | NULL             | NULL              | NULL
        12 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL              | NULL             | NULL              | NULL
        13 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL              | NULL             | NULL              | NULL
        14 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL              | NULL             | NULL              | NULL
        15 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL              | NULL             | NULL              | NULL
        16 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL              | NULL             | NULL              | NULL
        17 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL              | NULL             | NULL              | NULL
        18 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL              | NULL             | NULL              | NULL
        19 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL              | NULL             | NULL              | NULL
        20 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL              | NULL             | NULL              | NULL
        21 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL              | NULL             | NULL              | NULL
(76 rows)
> SELECT ModelID, TypeID, ModelName, TypeName, NULL AS ts, NULL AS current, NULL AS voltage, NULL AS frequency, NULL AS temperature
FROM rdb.DeviceModel
UNION ALL
SELECT NULL AS ModelID, NULL AS TypeID, NULL AS ModelName, NULL AS TypeName, ts, current, voltage, frequency, temperature
FROM tsdb.TransformerSuper
ORDER BY ModelID ASC,ts;
  modelid | typeid |  modelname   | typename |              ts               |      current      |     voltage      |     frequency     |    temperature
----------+--------+--------------+----------+-------------------------------+-------------------+------------------+-------------------+--------------------
  NULL    | NULL   | NULL         | NULL     | 2023-07-04 23:31:56.375+00:00 |  52.6645802382902 | 90.2966818407791 |  59.7906621665983 |  29.7222816635839
  NULL    | NULL   | NULL         | NULL     | 2023-07-05 19:06:03.818+00:00 |  24.9879851735457 | 72.9023828811242 |  16.9730647978356 |  36.2936778436917
  NULL    | NULL   | NULL         | NULL     | 2023-07-06 13:07:03.932+00:00 |  65.4808199433695 | 188.256752793934 |  36.3655120695077 |   3.4270151228769
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 01:58:30.974+00:00 |  22.7135181634573 | 20.6630930277035 |  50.3940697076095 |  15.9826086472548
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 08:03:17.177+00:00 |  43.9618086514638 | 154.080199954059 |  18.4386880878179 |  19.9063912659477
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 15:25:08.656+00:00 |  80.7028813987483 | 226.761499606397 |  22.5364353596955 |  17.6025290481215
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 16:34:00.392+00:00 |  45.2388433918319 |  99.004578998381 |  56.8033853758352 |   8.0043717691936
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 22:21:08.139+00:00 |  99.0213883825213 | 223.713905458791 |  20.0561956027087 |  15.2389583134986
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 23:53:58.05+00:00  |  25.0800514940146 | 131.974313155946 |  34.8100182103951 |  29.4223010516673
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 00:12:44.892+00:00 |   29.141342330967 | 210.572640997603 |  55.8747599998372 |  0.88726046519966
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 16:14:12.922+00:00 |  36.0909239408848 | 108.395207224193 |  25.3350295087435 |  38.2180913775925
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 16:59:52.729+00:00 |  60.5488223239337 | 205.185891118596 |  19.8535019992236 |  4.26001444506568
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 17:02:57.968+00:00 |   55.861789989644 | 49.2138283756682 |  10.0507297269897 |  27.8537278009513
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 21:00:47.294+00:00 |  32.9024015492564 |  7.3255922041065 |   10.417407156384 |  8.32671806250303
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 21:35:55.531+00:00 |  4.41960851489149 | 128.985755360718 |  40.5432051543244 |  35.6732716012075
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 00:30:42.935+00:00 |  20.7830495176516 | 215.613071987667 |  54.5559089780465 |  4.02753975120433
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 01:06:58.703+00:00 |  55.3486769858061 | 72.4093102835067 |  53.7155380731946 |  3.70442755758447
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 11:02:45.648+00:00 |  62.0784232408795 | 90.3264767630324 |  5.24889455764125 |  14.2588989676399
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 11:04:00.448+00:00 |  85.2337550871699 | 19.4365034998361 |    37.70059379019 |  8.99106030213915
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 12:39:09.234+00:00 |  93.5522968739871 | 221.387096571049 |  5.65178560720362 |  30.0818710128209
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 12:53:43.162+00:00 | 0.832251979106502 | 210.968491569062 |  7.07998283945599 |  20.5944805823982
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 12:59:55.048+00:00 |  10.6589665223002 | 34.3637179200209 |  36.0546314605785 | 0.888262181329367
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 15:28:55.104+00:00 |  17.0663783798606 | 142.441602089027 |  34.5913805653499 |  21.1191449238325
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 15:52:46.965+00:00 |   17.312386131568 | 195.579912227776 |  49.6691311423697 |  10.4835555524902
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 16:03:06.617+00:00 |   31.504070234341 | 127.986337408089 |   8.4282595331878 |  37.9130750083995
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 16:03:27.034+00:00 |  87.2790526281609 | 206.070347266935 |  19.6500047371521 |  23.9241122925156
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 19:16:34.716+00:00 |  79.0631329018989 |  236.11866419811 |  11.4298093861557 |  1.02756784982944
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 19:19:38.863+00:00 |   3.2731315534992 | 70.0397236701451 |  58.9849632586954 |  37.1860326026061
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 19:19:44.244+00:00 |  37.8918817740594 | 161.355020828364 |  58.1800749814891 |  14.7352206015563
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 19:28:09.126+00:00 |  91.5020840605461 | 220.624857600152 |  22.4130930797138 |  31.8415012308714
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 19:41:34.608+00:00 |   35.838912661572 | 123.099698869876 |  3.88934476100687 |  19.2503307615728
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 20:05:51.094+00:00 |  88.2028084565192 |  97.649389955192 |  38.4579349825266 |  20.4276840331148
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 20:33:49.565+00:00 |   15.245646381004 | 118.979588026805 |  5.03330816748402 |  5.17398884989191
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 21:14:38.359+00:00 |  66.9504922275415 |   31.95429667723 |  52.9170017722981 |  16.1441346256395
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 21:14:41.547+00:00 |  53.9127789548584 | 108.511358445958 |  39.4962935467216 |   12.141814707802
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 21:39:27.497+00:00 |  5.29879598620902 | 163.309371206004 |  6.26727010942794 |  7.40772839981332
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 21:43:54.89+00:00  |  85.5810191036721 |   43.27803927302 |  56.3379525630364 |  38.3103532390913
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 21:51:01.906+00:00 |  1.47005709589649 | 61.2819106751286 |  20.8859731929904 |  36.1938530615818
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 23:24:07.371+00:00 |   77.876255321485 | 112.812116134239 |  29.5717523088781 |  3.78880851739069
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 23:54:00.036+00:00 |  91.9097851757016 | 89.8234905187272 |  9.81651559479857 |  28.3854293845305
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 00:31:23.234+00:00 |  91.8309643480256 | 98.2060767880287 |  8.91706553719459 |  14.6356906093611
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 00:43:24.784+00:00 |  17.9443341967612 |  62.093309068496 |   12.677928946183 |  16.3709197522662
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 00:59:30.129+00:00 |  40.2841232147225 | 95.5581273127987 |   30.168265976604 |  28.3796205960211
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 01:32:00.466+00:00 |  56.3362346237103 | 197.815366563331 | 0.128887904577155 |  19.9842878240267
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 01:53:16.06+00:00  |  90.7270041420773 |  47.376657484987 |  58.1414720102914 |  21.6289511267588
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 03:04:43.065+00:00 |  25.0607281292901 | 168.258950009786 |  38.0144566068667 |  12.7393411825183
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 03:06:00.513+00:00 |  50.7714850897091 |  144.99413205258 |  58.6506239530332 |  5.22039849693016
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 04:08:50.574+00:00 |  17.3987235568273 | 153.226330096026 |  11.4559849803543 |  22.8197108083401
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 04:50:14.702+00:00 |   51.740815879706 |   225.5419937595 |  33.6010026825349 |   9.9844596700062
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 04:58:21.72+00:00  |  92.2529547112337 | 7.46273196927859 |  50.9209806421627 |  34.3656367316592
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 05:32:26.736+00:00 |  34.2366657909409 | 136.836842086963 |  42.1179315296133 |  14.6568703114464
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 05:38:07.211+00:00 |  11.9868726942194 | 120.126571230442 |  43.5659862801811 |  16.0702858199367
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 06:06:57.554+00:00 |  73.2377570573377 | 233.658626518117 |  18.1259609232502 |  15.3674872865237
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 06:16:57.573+00:00 |  19.0125643334454 | 200.658115852603 |  7.40748941885712 |  1.78438278418483
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 06:17:09.386+00:00 |   82.798367747235 | 74.3088997740017 |  14.8589832536621 |  16.9353628958774
        1 |      1 | 电表模型1    | 电表     | NULL                          | NULL              | NULL             | NULL              | NULL
        2 |      1 | 电表模型2    | 电表     | NULL                          | NULL              | NULL             | NULL              | NULL
        3 |      1 | 电表模型3    | 电表     | NULL                          | NULL              | NULL             | NULL              | NULL
        4 |      1 | 电表模型4    | 电表     | NULL                          | NULL              | NULL             | NULL              | NULL
        5 |      1 | 电表模型5    | 电表     | NULL                          | NULL              | NULL             | NULL              | NULL
        6 |      2 | 变压器模型6  | 变压器   | NULL                          | NULL              | NULL             | NULL              | NULL
        7 |      2 | 变压器模型7  | 变压器   | NULL                          | NULL              | NULL             | NULL              | NULL
        8 |      2 | 变压器模型8  | 变压器   | NULL                          | NULL              | NULL             | NULL              | NULL
        9 |      2 | 变压器模型9  | 变压器   | NULL                          | NULL              | NULL             | NULL              | NULL
       10 |      2 | 变压器模型10 | 变压器   | NULL                          | NULL              | NULL             | NULL              | NULL
(65 rows)
> SELECT deviceID, installDate, location, NULL AS ts, NULL AS status
FROM rdb.Device
UNION ALL
SELECT NULL AS deviceID, NULL AS installDate, NULL AS location, ts, status
FROM tsdb.MonitoringCenter
ORDER BY installDate DESC,deviceid,ts;
  deviceid |        installdate        | location |              ts               | status
-----------+---------------------------+----------+-------------------------------+---------
         5 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
         8 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL
        10 | 2023-07-04 00:00:00+00:00 | area2    | NULL                          | NULL
        13 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
        16 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL
        20 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
        21 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
         6 | 2023-07-03 00:00:00+00:00 | area2    | NULL                          | NULL
        12 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL
        17 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL
         4 | 2023-07-02 00:00:00+00:00 | area1    | NULL                          | NULL
         7 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL
         9 | 2023-07-02 00:00:00+00:00 | area3    | NULL                          | NULL
        14 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL
        18 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL
         1 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL
         2 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL
         3 | 2023-07-01 00:00:00+00:00 | area3    | NULL                          | NULL
        11 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL
        15 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL
        19 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL
  NULL     | NULL                      | NULL     | 2023-07-07 23:23:16.211+00:00 |      0
  NULL     | NULL                      | NULL     | 2023-07-08 04:41:43.514+00:00 |     -1
  NULL     | NULL                      | NULL     | 2023-07-08 14:55:50.421+00:00 |      0
  NULL     | NULL                      | NULL     | 2023-07-10 00:01:06.133+00:00 |     -1
  NULL     | NULL                      | NULL     | 2023-07-10 04:20:04.337+00:00 |      0
(26 rows)
> SELECT ModelID, TypeID, ModelName, TypeName, NULL AS ts, NULL AS status
FROM rdb.DeviceModel
UNION ALL
SELECT NULL AS ModelID, NULL AS TypeID, NULL AS ModelName, NULL AS TypeName, ts, status
FROM tsdb.MonitoringCenter
ORDER BY ModelID DESC,ts;
  modelid | typeid |  modelname   | typename |              ts               | status
----------+--------+--------------+----------+-------------------------------+---------
       10 |      2 | 变压器模型10 | 变压器   | NULL                          | NULL
        9 |      2 | 变压器模型9  | 变压器   | NULL                          | NULL
        8 |      2 | 变压器模型8  | 变压器   | NULL                          | NULL
        7 |      2 | 变压器模型7  | 变压器   | NULL                          | NULL
        6 |      2 | 变压器模型6  | 变压器   | NULL                          | NULL
        5 |      1 | 电表模型5    | 电表     | NULL                          | NULL
        4 |      1 | 电表模型4    | 电表     | NULL                          | NULL
        3 |      1 | 电表模型3    | 电表     | NULL                          | NULL
        2 |      1 | 电表模型2    | 电表     | NULL                          | NULL
        1 |      1 | 电表模型1    | 电表     | NULL                          | NULL
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 23:23:16.211+00:00 |      0
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 04:41:43.514+00:00 |     -1
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 14:55:50.421+00:00 |      0
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 00:01:06.133+00:00 |     -1
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 04:20:04.337+00:00 |      0
(15 rows)
> SELECT deviceID, installDate, location, NULL AS ts, NULL AS current, NULL AS voltage, NULL AS frequency
FROM rdb.Device
UNION ALL
SELECT NULL AS deviceID, NULL AS installDate, NULL AS location, ts, current, voltage, frequency
FROM tsdb.MeterSuper
ORDER BY location DESC,deviceid,ts;
  deviceid |        installdate        | location |              ts               |     current      |     voltage      |     frequency
-----------+---------------------------+----------+-------------------------------+------------------+------------------+--------------------
         3 | 2023-07-01 00:00:00+00:00 | area3    | NULL                          | NULL             | NULL             | NULL
         8 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL             | NULL             | NULL
         9 | 2023-07-02 00:00:00+00:00 | area3    | NULL                          | NULL             | NULL             | NULL
        16 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL             | NULL             | NULL
         2 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
         6 | 2023-07-03 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
         7 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
        10 | 2023-07-04 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
        11 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
        14 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
        18 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
        19 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL             | NULL             | NULL
         1 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
         4 | 2023-07-02 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
         5 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
        12 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
        13 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
        15 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
        17 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
        20 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
        21 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL             | NULL             | NULL
  NULL     | NULL                      | NULL     | 2023-07-05 21:59:04.182+00:00 |  1.4552285651376 | 113.326792465594 |  30.4358871869071
  NULL     | NULL                      | NULL     | 2023-07-07 16:13:06.336+00:00 | 88.2676084108624 | 151.864034289804 |  26.3510798558143
  NULL     | NULL                      | NULL     | 2023-07-07 16:36:31.395+00:00 | 89.7564312801932 | 150.928638817977 |  9.72415321564185
  NULL     | NULL                      | NULL     | 2023-07-07 17:20:49.141+00:00 | 30.1632209734123 | 172.393339584028 |  5.50441383726124
  NULL     | NULL                      | NULL     | 2023-07-08 00:08:14.696+00:00 | 28.5696601355255 | 140.690224485548 |  16.0609791337855
  NULL     | NULL                      | NULL     | 2023-07-08 04:18:54.237+00:00 | 38.7726102322915 | 44.4525515100625 |   37.929835054358
  NULL     | NULL                      | NULL     | 2023-07-08 06:14:37.171+00:00 | 64.7608834949323 |  11.403069794533 |   6.9986076663541
  NULL     | NULL                      | NULL     | 2023-07-08 09:56:25.22+00:00  | 32.2432444339341 | 177.586383495766 |  3.31446460523622
  NULL     | NULL                      | NULL     | 2023-07-08 20:39:44.321+00:00 | 66.3840449793426 | 182.232060755966 |  19.6441539895672
  NULL     | NULL                      | NULL     | 2023-07-08 20:51:54.682+00:00 |  5.1943308789773 |  63.650041383934 |  52.2425306405712
  NULL     | NULL                      | NULL     | 2023-07-08 23:01:41.987+00:00 |  8.0020595087802 | 124.823615938242 |  53.8209955567292
  NULL     | NULL                      | NULL     | 2023-07-09 01:08:32.321+00:00 | 65.8289096339743 | 195.691458386067 |  25.5717958601356
  NULL     | NULL                      | NULL     | 2023-07-09 05:17:11.599+00:00 | 51.3657007868602 | 168.123109584792 |  21.9499207558219
  NULL     | NULL                      | NULL     | 2023-07-09 06:03:05.815+00:00 | 19.1017958876088 | 115.685714706139 |  1.19064069294282
  NULL     | NULL                      | NULL     | 2023-07-09 07:30:23.078+00:00 | 32.5922311651652 | 168.706203551883 |  50.6448815126542
  NULL     | NULL                      | NULL     | 2023-07-09 08:29:58.163+00:00 | 79.6054423091845 | 231.302018540164 |  4.59731967014122
  NULL     | NULL                      | NULL     | 2023-07-09 08:51:17.852+00:00 | 86.6408620731391 | 144.607216977954 |  50.9725199313202
  NULL     | NULL                      | NULL     | 2023-07-09 11:58:38.783+00:00 | 35.0903702996475 | 42.1546680819372 |  54.7685818789391
  NULL     | NULL                      | NULL     | 2023-07-09 15:08:47.661+00:00 | 38.3605591260021 | 154.900605102746 |  47.7261438820055
  NULL     | NULL                      | NULL     | 2023-07-09 16:27:56.456+00:00 | 11.3623350383022 | 152.529755792575 |  18.3155479848789
  NULL     | NULL                      | NULL     | 2023-07-09 17:57:30.224+00:00 | 12.2075528531539 | 129.540332823266 |  18.7137334201641
  NULL     | NULL                      | NULL     | 2023-07-09 18:29:18.423+00:00 | 83.6478628663485 | 89.6890974542114 |  37.5976599982106
  NULL     | NULL                      | NULL     | 2023-07-09 18:34:48.36+00:00  |  83.497262058816 | 109.481594926408 |  27.3247611980655
  NULL     | NULL                      | NULL     | 2023-07-09 18:39:30.438+00:00 |  4.7143663137418 | 73.3038314338742 |  8.27571492455618
  NULL     | NULL                      | NULL     | 2023-07-09 19:30:26.451+00:00 | 69.6333622281017 | 238.179538590531 |  58.9094193706912
  NULL     | NULL                      | NULL     | 2023-07-09 20:59:09.025+00:00 | 43.7369827209636 |  68.608811662107 |   59.894456926546
  NULL     | NULL                      | NULL     | 2023-07-09 22:23:27.094+00:00 | 21.2326354535832 | 160.295718477005 |  46.0412660803375
  NULL     | NULL                      | NULL     | 2023-07-09 22:48:17.624+00:00 | 55.5757147937953 | 105.947176785265 |  29.4643461196237
  NULL     | NULL                      | NULL     | 2023-07-09 23:26:27.903+00:00 |  2.5362712857187 | 184.428403488133 |  19.7483576372737
  NULL     | NULL                      | NULL     | 2023-07-10 00:48:26.703+00:00 |  27.444401746537 | 236.348242886617 |   14.455974850198
  NULL     | NULL                      | NULL     | 2023-07-10 00:56:07.349+00:00 | 77.9899693670714 | 193.149378415718 |  15.1528517268839
  NULL     | NULL                      | NULL     | 2023-07-10 00:56:27.711+00:00 | 26.9682940704655 | 221.252417769086 |  22.8587538443064
  NULL     | NULL                      | NULL     | 2023-07-10 01:24:52.379+00:00 | 11.1845391378352 | 39.4609662728706 | 0.602579310396294
  NULL     | NULL                      | NULL     | 2023-07-10 02:03:34.875+00:00 | 92.1571660223094 | 37.3173252950804 |  58.7212739638845
  NULL     | NULL                      | NULL     | 2023-07-10 02:25:17.444+00:00 | 27.6364208231029 | 154.367306029744 |  26.5355631647354
  NULL     | NULL                      | NULL     | 2023-07-10 02:36:56.581+00:00 | 58.7603069416189 | 159.241597291105 |  41.2031892727525
  NULL     | NULL                      | NULL     | 2023-07-10 02:55:40.981+00:00 | 50.3771483027861 | 161.310822672952 |  57.6755664361319
  NULL     | NULL                      | NULL     | 2023-07-10 03:13:15.191+00:00 | 51.3779408142966 | 205.924083865798 |   18.087854549501
  NULL     | NULL                      | NULL     | 2023-07-10 03:45:32.968+00:00 | 92.1492678972427 | 122.083784577671 |  27.4222859892684
  NULL     | NULL                      | NULL     | 2023-07-10 04:04:07.144+00:00 | 99.4678675025397 | 13.0252418928197 |  45.7828540678734
  NULL     | NULL                      | NULL     | 2023-07-10 04:37:27.129+00:00 | 93.3225547467301 | 66.6576742686871 |  43.9072248011065
  NULL     | NULL                      | NULL     | 2023-07-10 05:09:17.235+00:00 | 97.2639127907299 | 23.3376270607565 |  56.9383191613316
  NULL     | NULL                      | NULL     | 2023-07-10 05:33:16.169+00:00 | 42.5942338040329 | 208.615787918257 |  42.0235732491163
  NULL     | NULL                      | NULL     | 2023-07-10 05:48:09.817+00:00 | 70.4166998637219 | 38.3445896240576 |  16.8520033641003
  NULL     | NULL                      | NULL     | 2023-07-10 06:08:56.784+00:00 | 51.4086117972453 |  177.34815592286 |  3.01038255870466
  NULL     | NULL                      | NULL     | 2023-07-10 06:19:18.908+00:00 | 15.9094854493545 | 178.524534293103 |  36.9383322722616
(67 rows)
> SELECT ModelID, TypeID, ModelName, TypeName, NULL AS ts, NULL AS current, NULL AS voltage, NULL AS frequency
FROM rdb.DeviceModel
UNION ALL
SELECT NULL AS ModelID, NULL AS TypeID, NULL AS ModelName, NULL AS TypeName, ts, current, voltage, frequency
FROM tsdb.MeterSuper
ORDER BY TypeName DESC,modelid,ts;
  modelid | typeid |  modelname   | typename |              ts               |     current      |     voltage      |     frequency
----------+--------+--------------+----------+-------------------------------+------------------+------------------+--------------------
        1 |      1 | 电表模型1    | 电表     | NULL                          | NULL             | NULL             | NULL
        2 |      1 | 电表模型2    | 电表     | NULL                          | NULL             | NULL             | NULL
        3 |      1 | 电表模型3    | 电表     | NULL                          | NULL             | NULL             | NULL
        4 |      1 | 电表模型4    | 电表     | NULL                          | NULL             | NULL             | NULL
        5 |      1 | 电表模型5    | 电表     | NULL                          | NULL             | NULL             | NULL
        6 |      2 | 变压器模型6  | 变压器   | NULL                          | NULL             | NULL             | NULL
        7 |      2 | 变压器模型7  | 变压器   | NULL                          | NULL             | NULL             | NULL
        8 |      2 | 变压器模型8  | 变压器   | NULL                          | NULL             | NULL             | NULL
        9 |      2 | 变压器模型9  | 变压器   | NULL                          | NULL             | NULL             | NULL
       10 |      2 | 变压器模型10 | 变压器   | NULL                          | NULL             | NULL             | NULL
  NULL    | NULL   | NULL         | NULL     | 2023-07-05 21:59:04.182+00:00 |  1.4552285651376 | 113.326792465594 |  30.4358871869071
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 16:13:06.336+00:00 | 88.2676084108624 | 151.864034289804 |  26.3510798558143
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 16:36:31.395+00:00 | 89.7564312801932 | 150.928638817977 |  9.72415321564185
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 17:20:49.141+00:00 | 30.1632209734123 | 172.393339584028 |  5.50441383726124
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 00:08:14.696+00:00 | 28.5696601355255 | 140.690224485548 |  16.0609791337855
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 04:18:54.237+00:00 | 38.7726102322915 | 44.4525515100625 |   37.929835054358
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 06:14:37.171+00:00 | 64.7608834949323 |  11.403069794533 |   6.9986076663541
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 09:56:25.22+00:00  | 32.2432444339341 | 177.586383495766 |  3.31446460523622
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 20:39:44.321+00:00 | 66.3840449793426 | 182.232060755966 |  19.6441539895672
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 20:51:54.682+00:00 |  5.1943308789773 |  63.650041383934 |  52.2425306405712
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 23:01:41.987+00:00 |  8.0020595087802 | 124.823615938242 |  53.8209955567292
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 01:08:32.321+00:00 | 65.8289096339743 | 195.691458386067 |  25.5717958601356
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 05:17:11.599+00:00 | 51.3657007868602 | 168.123109584792 |  21.9499207558219
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 06:03:05.815+00:00 | 19.1017958876088 | 115.685714706139 |  1.19064069294282
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 07:30:23.078+00:00 | 32.5922311651652 | 168.706203551883 |  50.6448815126542
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 08:29:58.163+00:00 | 79.6054423091845 | 231.302018540164 |  4.59731967014122
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 08:51:17.852+00:00 | 86.6408620731391 | 144.607216977954 |  50.9725199313202
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 11:58:38.783+00:00 | 35.0903702996475 | 42.1546680819372 |  54.7685818789391
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 15:08:47.661+00:00 | 38.3605591260021 | 154.900605102746 |  47.7261438820055
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 16:27:56.456+00:00 | 11.3623350383022 | 152.529755792575 |  18.3155479848789
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 17:57:30.224+00:00 | 12.2075528531539 | 129.540332823266 |  18.7137334201641
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 18:29:18.423+00:00 | 83.6478628663485 | 89.6890974542114 |  37.5976599982106
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 18:34:48.36+00:00  |  83.497262058816 | 109.481594926408 |  27.3247611980655
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 18:39:30.438+00:00 |  4.7143663137418 | 73.3038314338742 |  8.27571492455618
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 19:30:26.451+00:00 | 69.6333622281017 | 238.179538590531 |  58.9094193706912
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 20:59:09.025+00:00 | 43.7369827209636 |  68.608811662107 |   59.894456926546
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 22:23:27.094+00:00 | 21.2326354535832 | 160.295718477005 |  46.0412660803375
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 22:48:17.624+00:00 | 55.5757147937953 | 105.947176785265 |  29.4643461196237
  NULL    | NULL   | NULL         | NULL     | 2023-07-09 23:26:27.903+00:00 |  2.5362712857187 | 184.428403488133 |  19.7483576372737
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 00:48:26.703+00:00 |  27.444401746537 | 236.348242886617 |   14.455974850198
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 00:56:07.349+00:00 | 77.9899693670714 | 193.149378415718 |  15.1528517268839
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 00:56:27.711+00:00 | 26.9682940704655 | 221.252417769086 |  22.8587538443064
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 01:24:52.379+00:00 | 11.1845391378352 | 39.4609662728706 | 0.602579310396294
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 02:03:34.875+00:00 | 92.1571660223094 | 37.3173252950804 |  58.7212739638845
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 02:25:17.444+00:00 | 27.6364208231029 | 154.367306029744 |  26.5355631647354
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 02:36:56.581+00:00 | 58.7603069416189 | 159.241597291105 |  41.2031892727525
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 02:55:40.981+00:00 | 50.3771483027861 | 161.310822672952 |  57.6755664361319
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 03:13:15.191+00:00 | 51.3779408142966 | 205.924083865798 |   18.087854549501
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 03:45:32.968+00:00 | 92.1492678972427 | 122.083784577671 |  27.4222859892684
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 04:04:07.144+00:00 | 99.4678675025397 | 13.0252418928197 |  45.7828540678734
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 04:37:27.129+00:00 | 93.3225547467301 | 66.6576742686871 |  43.9072248011065
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 05:09:17.235+00:00 | 97.2639127907299 | 23.3376270607565 |  56.9383191613316
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 05:33:16.169+00:00 | 42.5942338040329 | 208.615787918257 |  42.0235732491163
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 05:48:09.817+00:00 | 70.4166998637219 | 38.3445896240576 |  16.8520033641003
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 06:08:56.784+00:00 | 51.4086117972453 |  177.34815592286 |  3.01038255870466
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 06:19:18.908+00:00 | 15.9094854493545 | 178.524534293103 |  36.9383322722616
(56 rows)
> SELECT deviceID
FROM rdb.Device
INTERSECT
SELECT deviceID
FROM tsdb.MeterSuper order by deviceid;
  deviceid
------------
         1
         2
         3
         4
         5
         6
         7
         8
         9
        10
(10 rows)
> SELECT deviceID
FROM rdb.Device
WHERE installDate = '2023-07-01'
INTERSECT
SELECT deviceID
FROM tsdb.MeterSuper
WHERE current > 0 order by deviceid;
  deviceid
------------
         1
         2
         3
(3 rows)
> SELECT deviceID
FROM rdb.Device
WHERE location = 'area1'
INTERSECT
SELECT deviceID
FROM tsdb.TransformerSuper
WHERE frequency < 50 order by deviceid;
  deviceid
------------
        12
        13
        15
        17
        20
(5 rows)
> SELECT deviceID
FROM rdb.Device
WHERE modelID = 1
INTERSECT
SELECT deviceID
FROM tsdb.MeterSuper
WHERE voltage > 200 order by deviceid;
  deviceid
------------
         1
         6
(2 rows)
> SELECT deviceID
FROM rdb.Device
WHERE location = 'area2'
INTERSECT
SELECT deviceID
FROM tsdb.MeterSuper
WHERE voltage > 100 AND frequency < 60 order by deviceid;
  deviceid
------------
         2
         6
         7
        10
(4 rows)
> SELECT deviceID
FROM rdb.Device
WHERE modelID = 2
INTERSECT
SELECT deviceID
FROM tsdb.TransformerSuper
WHERE current > 10 AND temperature > 50;
  deviceid
------------
(0 rows)
> SELECT deviceID
FROM rdb.Device
WHERE installDate = '2023-07-04'
INTERSECT
SELECT deviceID
FROM tsdb.MeterSuper
WHERE current > 0 AND voltage > 0 order by deviceid;
  deviceid
------------
         5
         8
        10
(3 rows)
> SELECT deviceID
FROM rdb.Device
WHERE modelID = 4
INTERSECT
SELECT deviceID
FROM tsdb.TransformerSuper
WHERE current > 5 AND temperature < 40;
  deviceid
------------
(0 rows)
> SELECT deviceID
FROM rdb.Device
WHERE location = 'area3'
INTERSECT
SELECT deviceID
FROM tsdb.MeterSuper
WHERE current < 50 order by deviceid;
  deviceid
------------
         3
         8
         9
(3 rows)
> SELECT deviceID
FROM rdb.Device
WHERE installDate = '2023-07-02'
INTERSECT
SELECT deviceID
FROM tsdb.TransformerSuper
WHERE frequency > 50 order by deviceid;
  deviceid
------------
        14
        18
(2 rows)
> SELECT deviceID FROM rdb.Device
INTERSECT
SELECT deviceID FROM tsdb.MonitoringCenter
ORDER BY deviceID;
  deviceid
------------
         2
         7
        14
        16
        18
(5 rows)
> SELECT modelID FROM rdb.DeviceModel
INTERSECT
SELECT modelID FROM tsdb.MeterSuper
ORDER BY modelID DESC;
  modelid
-----------
        5
        4
        3
        2
        1
(5 rows)
> SELECT modelID FROM rdb.DeviceModel
INTERSECT
SELECT modelId FROM tsdb.TransformerSuper
ORDER BY modelID DESC;
  modelid
-----------
       10
        9
        8
        7
        6
(5 rows)
> SELECT deviceID FROM rdb.Device
INTERSECT
SELECT deviceID FROM tsdb.MeterSuper
ORDER BY deviceID;
  deviceid
------------
         1
         2
         3
         4
         5
         6
         7
         8
         9
        10
(10 rows)
> SELECT deviceID FROM rdb.Device
INTERSECT
SELECT deviceID FROM tsdb.TransformerSuper
ORDER BY deviceID DESC;
  deviceid
------------
        20
        19
        18
        17
        16
        15
        14
        13
        12
        11
(10 rows)
> SELECT deviceID FROM tsdb.MeterSuper
INTERSECT
SELECT deviceID FROM tsdb.TransformerSuper
ORDER BY deviceID;
  deviceid
------------
(0 rows)
> SELECT modelID FROM tsdb.MeterSuper
INTERSECT
SELECT modelId FROM tsdb.TransformerSuper
ORDER BY modelID DESC;
  modelid
-----------
(0 rows)
> SELECT deviceID FROM tsdb.MeterSuper
INTERSECT
SELECT deviceID FROM tsdb.MonitoringCenter
ORDER BY deviceID DESC;
  deviceid
------------
         7
         2
(2 rows)
> SELECT deviceID FROM tsdb.TransformerSuper
INTERSECT
SELECT deviceID FROM tsdb.MonitoringCenter
ORDER BY deviceID;
  deviceid
------------
        14
        16
        18
(3 rows)
> SELECT modelID FROM rdb.DeviceModel
INTERSECT
SELECT modelID FROM tsdb.MeterSuper
INTERSECT
SELECT modelId FROM tsdb.TransformerSuper
ORDER BY modelID;
  modelid
-----------
(0 rows)
> SELECT deviceID
FROM rdb.Device
INTERSECT ALL
SELECT deviceID
FROM tsdb.MeterSuper order by deviceid;
  deviceid
------------
         1
         2
         3
         4
         5
         6
         7
         8
         9
        10
(10 rows)
> SELECT deviceID
FROM rdb.Device
WHERE installDate = '2023-07-01'
INTERSECT ALL
SELECT deviceID
FROM tsdb.MeterSuper
WHERE current > 0  order by deviceid;
  deviceid
------------
         1
         2
         3
(3 rows)
> SELECT deviceID
FROM rdb.Device
WHERE location = 'area1'
INTERSECT ALL
SELECT deviceID
FROM tsdb.TransformerSuper
WHERE frequency < 50  order by deviceid;
  deviceid
------------
        12
        13
        15
        17
        20
(5 rows)
> SELECT deviceID
FROM rdb.Device
WHERE modelID = 1
INTERSECT ALL
SELECT deviceID
FROM tsdb.MeterSuper
WHERE voltage > 200 order by deviceid;
  deviceid
------------
         1
         6
(2 rows)
> SELECT deviceID
FROM rdb.Device
WHERE location = 'area2'
INTERSECT ALL
SELECT deviceID
FROM tsdb.MeterSuper
WHERE voltage > 100 AND frequency < 60 order by deviceid;
  deviceid
------------
         2
         6
         7
        10
(4 rows)
> SELECT deviceID
FROM rdb.Device
WHERE modelID = 2
INTERSECT ALL
SELECT deviceID
FROM tsdb.TransformerSuper
WHERE current > 10 AND temperature > 50 order by deviceid;
  deviceid
------------
(0 rows)
> SELECT deviceID
FROM rdb.Device
WHERE installDate = '2023-07-04'
INTERSECT ALL
SELECT deviceID
FROM

 tsdb.MeterSuper
WHERE current > 0 AND voltage > 0 order by deviceid;
  deviceid
------------
         5
         8
        10
(3 rows)
> SELECT deviceID
FROM rdb.Device
WHERE modelID = 4
INTERSECT ALL
SELECT deviceID
FROM tsdb.TransformerSuper
WHERE current > 5 AND temperature < 40 order by deviceid;
  deviceid
------------
(0 rows)
> SELECT deviceID
FROM rdb.Device
WHERE location = 'area3'
INTERSECT ALL
SELECT deviceID
FROM tsdb.MeterSuper
WHERE current < 50  order by deviceid;
  deviceid
------------
         3
         8
         9
(3 rows)
> SELECT deviceID
FROM rdb.Device
WHERE installDate = '2023-07-02'
INTERSECT ALL
SELECT deviceID
FROM tsdb.TransformerSuper
WHERE frequency > 50  order by deviceid;
  deviceid
------------
        14
        18
(2 rows)
> SELECT deviceID
FROM rdb.Device
EXCEPT
SELECT deviceID
FROM tsdb.MeterSuper  order by deviceid;
  deviceid
------------
        11
        12
        13
        14
        15
        16
        17
        18
        19
        20
        21
(11 rows)
> SELECT deviceID
FROM rdb.Device
WHERE installDate = '2023-07-01'
EXCEPT
SELECT deviceID
FROM tsdb.MeterSuper  order by deviceid;
  deviceid
------------
        11
        15
        19
(3 rows)
> SELECT deviceID
FROM rdb.Device
WHERE location = 'area1'
EXCEPT
SELECT deviceID
FROM tsdb.TransformerSuper  order by deviceid;
  deviceid
------------
         1
         4
         5
        21
(4 rows)
> SELECT deviceID
FROM rdb.Device
WHERE modelID = 1
EXCEPT
SELECT deviceID
FROM tsdb.MeterSuper  order by deviceid;
  deviceid
------------
(0 rows)
> SELECT deviceID
FROM rdb.Device
WHERE location = 'area2'
EXCEPT
SELECT deviceID
FROM tsdb.MeterSuper
WHERE voltage < 100  order by deviceid;
  deviceid
------------
         7
        11
        14
        18
        19
(5 rows)
> SELECT deviceID
FROM rdb.Device
WHERE modelID = 2
EXCEPT
SELECT deviceID
FROM tsdb.TransformerSuper  order by deviceid;
  deviceid
------------
         2
         7
(2 rows)
> SELECT deviceID
FROM rdb.Device
WHERE installDate = '2023-07-04'
EXCEPT
SELECT deviceID
FROM tsdb.MeterSuper
WHERE current <= 0 OR voltage <= 0  order by deviceid;
  deviceid
------------
         5
         8
        10
        13
        16
        20
        21
(7 rows)
> SELECT deviceID
FROM rdb.Device
WHERE modelID = 4
EXCEPT
SELECT deviceID
FROM tsdb.TransformerSuper
WHERE current <= 5 OR temperature >= 40 order by deviceid;
  deviceid
------------
         4
         9
(2 rows)
> SELECT deviceID
FROM rdb.Device
WHERE location = 'area3'
EXCEPT
SELECT deviceID
FROM tsdb.MeterSuper
WHERE current >= 50  order by deviceid;
  deviceid
------------
        16
(1 row)
> SELECT deviceID
FROM rdb.Device
WHERE installDate = '2023-07-02'
EXCEPT
SELECT deviceID
FROM tsdb.TransformerSuper
WHERE frequency <= 50  order by deviceid;
  deviceid
------------
         4
         7
         9
(3 rows)
> SELECT deviceID
FROM rdb.Device
EXCEPT ALL
SELECT deviceID
FROM tsdb.MeterSuper  order by deviceid;
  deviceid
------------
        11
        12
        13
        14
        15
        16
        17
        18
        19
        20
        21
(11 rows)
> SELECT deviceID
FROM rdb.Device
WHERE installDate = '2023-07-01'
EXCEPT ALL
SELECT deviceID
FROM tsdb.MeterSuper  order by deviceid;
  deviceid
------------
        11
        15
        19
(3 rows)
> SELECT deviceID
FROM rdb.Device
WHERE location = 'area1'
EXCEPT ALL
SELECT deviceID
FROM tsdb.TransformerSuper order by deviceid;
  deviceid
------------
         1
         4
         5
        21
(4 rows)
> SELECT deviceID
FROM rdb.Device
WHERE modelID = 1
EXCEPT ALL
SELECT deviceID
FROM tsdb.MeterSuper order by deviceid;
  deviceid
------------
(0 rows)
> SELECT deviceID
FROM rdb.Device
WHERE location = 'area2'
EXCEPT ALL
SELECT deviceID
FROM tsdb.MeterSuper
WHERE voltage < 100  order by deviceid;
  deviceid
------------
         7
        11
        14
        18
        19
(5 rows)
> SELECT deviceID
FROM rdb.Device
WHERE modelID = 2
EXCEPT ALL
SELECT deviceID
FROM tsdb.TransformerSuper order by deviceid;
  deviceid
------------
         2
         7
(2 rows)
> SELECT deviceID
FROM rdb.Device
WHERE installDate = '2023-07-04'
EXCEPT ALL
SELECT deviceID
FROM tsdb.MeterSuper
WHERE current <= 0 OR voltage <= 0  order by deviceid;
  deviceid
------------
         5
         8
        10
        13
        16
        20
        21
(7 rows)
> SELECT deviceID
FROM rdb.Device
WHERE modelID = 4
EXCEPT ALL
SELECT deviceID
FROM tsdb.TransformerSuper
WHERE current <= 5 OR temperature >= 40 order by deviceid;
  deviceid
------------
         4
         9
(2 rows)
> SELECT deviceID
FROM rdb.Device
WHERE location = 'area3'
EXCEPT ALL
SELECT deviceID
FROM tsdb.MeterSuper
WHERE current >= 50 order by deviceid;
  deviceid
------------
        16
(1 row)
> SELECT deviceID
FROM rdb.Device
WHERE installDate = '2023-07-02'
EXCEPT ALL
SELECT deviceID
FROM tsdb.TransformerSuper
WHERE frequency <= 50  order by deviceid;
  deviceid
------------
         4
         7
         9
(3 rows)
> SELECT DISTINCT TypeName, location
FROM (
    SELECT modelID, location 
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID, status
            FROM tsdb.MonitoringCenter
            WHERE ts IN (
                SELECT MAX(ts) 
                FROM tsdb.MonitoringCenter 
                WHERE status = 0
            )
        ) AS SubSubQuery1
    )
) AS SubQuery1
JOIN rdb.DeviceModel ON SubQuery1.modelID = rdb.DeviceModel.modelID
ORDER BY TypeName, location;
  typename | location
-----------+-----------
  电表     | area2
(1 row)
> SELECT SubQuery2.deviceID, ModelName, TypeName, status
FROM (
    SELECT modelID, deviceID 
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID 
        FROM (
            SELECT deviceID 
            FROM tsdb.MeterSuper
            WHERE current > '10' AND voltage > '220'
        ) AS SubSubQuery2
    )
) AS SubQuery2
JOIN rdb.DeviceModel ON SubQuery2.modelID = rdb.DeviceModel.modelID
JOIN tsdb.MonitoringCenter ON SubQuery2.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY status DESC, SubQuery2.deviceID;
  deviceid | modelname | typename | status
-----------+-----------+----------+---------
         2 | 电表模型2 | 电表     |      0
(1 row)
> SELECT SubQuery3.deviceID, ModelName, TypeName, status
FROM (
    SELECT modelID, deviceID 
    FROM rdb.Device
    WHERE installDate IN (
        SELECT MIN(installDate) 
        FROM (
            SELECT installDate 
            FROM rdb.Device
        ) AS SubSubQuery3
    )
) AS SubQuery3
JOIN rdb.DeviceModel ON SubQuery3.modelID = rdb.DeviceModel.modelID
JOIN tsdb.MonitoringCenter ON SubQuery3.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY SubQuery3.deviceID DESC;
  deviceid | modelname | typename | status
-----------+-----------+----------+---------
         2 | 电表模型2 | 电表     |      0
(1 row)
> SELECT SubQuery4.deviceID, ModelName, current, voltage
FROM (
    SELECT modelID, deviceID 
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID
            FROM tsdb.MonitoringCenter
            WHERE status = -1 AND ts IN (
                SELECT MAX(ts) 
                FROM tsdb.MonitoringCenter 
            )
        ) AS SubSubQuery4
    )
) AS SubQuery4
JOIN rdb.DeviceModel ON SubQuery4.modelID = rdb.DeviceModel.modelID
JOIN tsdb.MeterSuper ON SubQuery4.deviceID = tsdb.MeterSuper.deviceID
WHERE TypeName = '电表'
ORDER BY current DESC, voltage DESC;
  deviceid | modelname | current | voltage
-----------+-----------+---------+----------
(0 rows)
> SELECT SubQuery5.deviceID, ModelName, TypeName, status
FROM (
    SELECT modelID, deviceID 
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID 
        FROM (
            SELECT deviceID 
            FROM tsdb.TransformerSuper
            WHERE frequency > '20' AND temperature > '25'
        ) AS SubSubQuery5
    )
) AS SubQuery5
JOIN rdb.DeviceModel ON SubQuery5.modelID = rdb.DeviceModel.modelID
JOIN tsdb.MonitoringCenter ON SubQuery5.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY SubQuery5.deviceID,status DESC;
  deviceid |  modelname  | typename | status
-----------+-------------+----------+---------
        14 | 变压器模型9 | 变压器   |      0
        16 | 变压器模型6 | 变压器   |     -1
        18 | 变压器模型8 | 变压器   |      0
(3 rows)
> SELECT location, COUNT(*) as device_count
FROM (
    SELECT location
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID
            FROM rdb.Device
        ) AS SubSubQuery6
    )
) AS SubQuery6
GROUP BY location
ORDER BY device_count DESC;
  location | device_count
-----------+---------------
  area1    |            9
  area2    |            8
  area3    |            4
(3 rows)
> SELECT SubQuery7.deviceID, ModelName, current, voltage, status
FROM (
    SELECT modelID, deviceID
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID
            FROM tsdb.MeterSuper
            WHERE ts IN (
                SELECT MAX(ts)
                FROM tsdb.MeterSuper
            ) AND current < '100' AND voltage < '220'
        ) AS SubSubQuery7
    )
) AS SubQuery7
JOIN rdb.DeviceModel ON SubQuery7.modelID = rdb.DeviceModel.modelID
JOIN tsdb.MeterSuper ON SubQuery7.deviceID = tsdb.MeterSuper.deviceID
JOIN tsdb.MonitoringCenter ON SubQuery7.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY status DESC;
  deviceid | modelname |     current      |     voltage      | status
-----------+-----------+------------------+------------------+---------
         7 | 电表模型2 | 32.2432444339341 | 177.586383495766 |     -1
         7 | 电表模型2 | 32.5922311651652 | 168.706203551883 |     -1
         7 | 电表模型2 |  2.5362712857187 | 184.428403488133 |     -1
         7 | 电表模型2 | 15.9094854493545 | 178.524534293103 |     -1
(4 rows)
> SELECT SubQuery8.deviceID, ModelName, temperature, status
FROM (
    SELECT modelID, deviceID
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID
            FROM tsdb.TransformerSuper
            WHERE ts > '2023-07-03'
        ) AS SubSubQuery8
    )
) AS SubQuery8
JOIN rdb.DeviceModel ON SubQuery8.modelID = rdb.DeviceModel.modelID
JOIN tsdb.TransformerSuper ON SubQuery8.deviceID = tsdb.TransformerSuper.deviceID
JOIN tsdb.MonitoringCenter ON SubQuery8.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY deviceid,temperature;
  deviceid |  modelname  |    temperature    | status
-----------+-------------+-------------------+---------
        14 | 变压器模型9 |  0.88726046519966 |      0
        14 | 变压器模型9 | 0.888262181329367 |      0
        14 | 变压器模型9 |  19.9842878240267 |      0
        14 | 变压器模型9 |  20.5944805823982 |      0
        14 | 变压器模型9 |  27.8537278009513 |      0
        14 | 变压器模型9 |  28.3796205960211 |      0
        14 | 变压器模型9 |  30.0818710128209 |      0
        14 | 变压器模型9 |  35.6732716012075 |      0
        16 | 变压器模型6 |  4.02753975120433 |     -1
        16 | 变压器模型6 |  5.22039849693016 |     -1
        16 | 变压器模型6 |  12.7393411825183 |     -1
        16 | 变压器模型6 |  16.0702858199367 |     -1
        16 | 变压器模型6 |  19.2503307615728 |     -1
        16 | 变压器模型6 |  38.2180913775925 |     -1
        18 | 变压器模型8 |  8.99106030213915 |      0
        18 | 变压器模型8 |   12.141814707802 |      0
        18 | 变压器模型8 |  14.6356906093611 |      0
        18 | 变压器模型8 |  20.4276840331148 |      0
        18 | 变压器模型8 |  21.6289511267588 |      0
        18 | 变压器模型8 |  29.4223010516673 |      0
(20 rows)
> SELECT SubQuery9.deviceID, ModelName, current, voltage, status
FROM (
    SELECT modelID, deviceID
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID
            FROM tsdb.MeterSuper
            WHERE ts IN (
                SELECT MAX(ts)
                FROM tsdb.MeterSuper
            ) AND current > '10' AND voltage > '210'
        ) AS SubSubQuery9
    )
) AS SubQuery9
JOIN rdb.DeviceModel ON SubQuery9.modelID = rdb.DeviceModel.modelID
JOIN tsdb.MeterSuper ON SubQuery9.deviceID = tsdb.MeterSuper.deviceID
JOIN tsdb.MonitoringCenter ON SubQuery9.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY status DESC;
  deviceid | modelname | current | voltage | status
-----------+-----------+---------+---------+---------
(0 rows)
> SELECT SubQuery10.deviceID, ModelName, frequency, temperature, status
FROM (
    SELECT modelID, deviceID
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID
            FROM tsdb.TransformerSuper
            WHERE ts IN (
                SELECT MAX(ts)
                FROM tsdb.TransformerSuper
            ) AND frequency > '20' AND temperature > '30'
        ) AS SubSubQuery10
    )
) AS SubQuery10
JOIN rdb.DeviceModel ON SubQuery10.modelID = rdb.DeviceModel.modelID
JOIN tsdb.TransformerSuper ON SubQuery10.deviceID = tsdb.TransformerSuper.deviceID
JOIN tsdb.MonitoringCenter ON SubQuery10.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY status DESC;
  deviceid | modelname | frequency | temperature | status
-----------+-----------+-----------+-------------+---------
(0 rows)
> SELECT d.deviceID,dm.TypeName, dm.ModelName
FROM rdb.DeviceModel AS dm
INNER JOIN rdb.Device AS d ON dm.modelID = d.modelID
INNER JOIN tsdb.MonitoringCenter AS mc ON d.deviceID = mc.deviceID
WHERE mc.status = -1 ORDER by d.deviceID;
  deviceid | typename |  modelname
-----------+----------+--------------
         7 | 电表     | 电表模型2
        16 | 变压器   | 变压器模型6
(2 rows)
> SELECT d.deviceID, dm.ModelName, mc.status
FROM rdb.Device AS d
LEFT JOIN rdb.DeviceModel AS dm ON d.modelID = dm.modelID
LEFT JOIN tsdb.MonitoringCenter AS mc ON d.deviceID = mc.deviceID
WHERE mc.ts = (SELECT MAX(ts) FROM tsdb.MonitoringCenter WHERE deviceID = d.deviceID) ORDER by d.deviceID;
  deviceid |  modelname  | status
-----------+-------------+---------
         2 | 电表模型2   |      0
         7 | 电表模型2   |     -1
        14 | 变压器模型9 |      0
        16 | 变压器模型6 |     -1
        18 | 变压器模型8 |      0
(5 rows)
> SELECT d.deviceID,mc.status, dm.ModelName
FROM rdb.DeviceModel AS dm
RIGHT JOIN rdb.Device AS d ON dm.modelID = d.modelID
RIGHT JOIN tsdb.MonitoringCenter AS mc ON d.deviceID = mc.deviceID ORDER by d.deviceID,mc.status, dm.ModelName;
  deviceid | status |  modelname
-----------+--------+--------------
         2 |      0 | 电表模型2
         7 |     -1 | 电表模型2
        14 |      0 | 变压器模型9
        16 |     -1 | 变压器模型6
        18 |      0 | 变压器模型8
(5 rows)
> SELECT d.deviceID,mc.status, dm.ModelName
FROM rdb.DeviceModel AS dm
FULL JOIN rdb.Device AS d ON dm.modelID = d.modelID
FULL JOIN tsdb.MonitoringCenter AS mc ON d.deviceID = mc.deviceID ORDER by d.deviceID,mc.status, dm.ModelName;
  deviceid | status |  modelname
-----------+--------+---------------
         1 | NULL   | 电表模型1
         2 |      0 | 电表模型2
         3 | NULL   | 电表模型3
         4 | NULL   | 电表模型4
         5 | NULL   | 电表模型5
         6 | NULL   | 电表模型1
         7 |     -1 | 电表模型2
         8 | NULL   | 电表模型3
         9 | NULL   | 电表模型4
        10 | NULL   | 电表模型5
        11 | NULL   | 变压器模型6
        12 | NULL   | 变压器模型7
        13 | NULL   | 变压器模型8
        14 |      0 | 变压器模型9
        15 | NULL   | 变压器模型10
        16 |     -1 | 变压器模型6
        17 | NULL   | 变压器模型7
        18 |      0 | 变压器模型8
        19 | NULL   | 变压器模型9
        20 | NULL   | 变压器模型10
        21 | NULL   | 变压器模型10
(21 rows)
> SELECT d.deviceID,
       (SELECT MAX(status) FROM tsdb.MonitoringCenter WHERE deviceID = d.deviceID) AS LatestStatus
FROM rdb.Device AS d ORDER by d.deviceID;
  deviceid | lateststatus
-----------+---------------
         1 | NULL
         2 |            0
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 |           -1
         8 | NULL
         9 | NULL
        10 | NULL
        11 | NULL
        12 | NULL
        13 | NULL
        14 |            0
        15 | NULL
        16 |           -1
        17 | NULL
        18 |            0
        19 | NULL
        20 | NULL
        21 | NULL
(21 rows)
> SELECT * FROM rdb.Device
WHERE deviceID IN (
    SELECT deviceID FROM tsdb.MonitoringCenter 
    WHERE ts BETWEEN '2023-07-02' AND '2023-07-05'
) ORDER by deviceID,modelID,installDate,location;
  deviceid | modelid | installdate | location
-----------+---------+-------------+-----------
(0 rows)
> SELECT * FROM tsdb.MonitoringCenter
WHERE deviceID IN (
    SELECT deviceID FROM rdb.Device 
    WHERE modelID = 1
) ORDER by deviceID,status,ts;
  ts | deviceid | status | location | type
-----+----------+--------+----------+-------
(0 rows)
> SELECT * FROM rdb.Device
WHERE deviceID IN (
    SELECT deviceID FROM tsdb.MonitoringCenter 
    WHERE status = -1
) ORDER by deviceID,modelID,installDate,location;
  deviceid | modelid |        installdate        | location
-----------+---------+---------------------------+-----------
         7 |       2 | 2023-07-02 00:00:00+00:00 | area2
        16 |       6 | 2023-07-04 00:00:00+00:00 | area3
(2 rows)
> SELECT * FROM tsdb.MonitoringCenter
WHERE deviceID IN (
    SELECT deviceID FROM rdb.Device 
    WHERE installDate BETWEEN '2023-07-01' AND '2023-07-05'
) ORDER by deviceID,status,ts;
               ts               | deviceid | status | location |   type
--------------------------------+----------+--------+----------+-----------
  2023-07-10 04:20:04.337+00:00 |        2 |      0 | beijing  | 监控中心
  2023-07-08 04:41:43.514+00:00 |        7 |     -1 | beijing  | 监控中心
  2023-07-08 14:55:50.421+00:00 |       14 |      0 | beijing  | 监控中心
  2023-07-10 00:01:06.133+00:00 |       16 |     -1 | beijing  | 监控中心
  2023-07-07 23:23:16.211+00:00 |       18 |      0 | beijing  | 监控中心
(5 rows)
> SELECT * FROM tsdb.MonitoringCenter
WHERE deviceID IN (
    SELECT deviceID FROM rdb.Device 
    WHERE location = 'area1'
)ORDER by deviceID,status,ts;
  ts | deviceid | status | location | type
-----+----------+--------+----------+-------
(0 rows)
> SELECT * FROM rdb.Device
WHERE deviceID IN (
    SELECT deviceID FROM tsdb.MonitoringCenter 
    WHERE status = -1
) AND location = 'area1' ORDER by deviceID,modelID,installDate,location;
  deviceid | modelid | installdate | location
-----------+---------+-------------+-----------
(0 rows)
> SELECT * FROM tsdb.MonitoringCenter
WHERE deviceID IN (
    SELECT deviceID FROM rdb.Device 
    WHERE modelID IN (
        SELECT modelID FROM rdb.DeviceModel
        WHERE TypeName = '电表'
    ) AND location = 'area1'
)ORDER by deviceID,status,ts;
  ts | deviceid | status | location | type
-----+----------+--------+----------+-------
(0 rows)
> SELECT d.location
FROM rdb.Device d
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
    AND mc.status = -1
) ORDER by d.location;
  location
------------
  area2
  area3
(2 rows)
> SELECT dm.TypeName
FROM rdb.DeviceModel dm
JOIN rdb.Device d ON dm.ModelID = d.modelID
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
    GROUP BY mc.deviceID
    HAVING COUNT(*) > 5
);
  typename
------------
(0 rows)
> SELECT dm.ModelName, mc.status
FROM rdb.DeviceModel dm
JOIN tsdb.MonitoringCenter mc ON dm.modelID = mc.deviceID
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MonitoringCenter mc2
    WHERE mc2.deviceID = mc.deviceID
)
ORDER BY mc.status DESC;
   modelname  | status
--------------+---------
  电表模型2   |      0
  变压器模型7 |     -1
(2 rows)
> SELECT dm.ModelName, m.current, mc.status
FROM rdb.DeviceModel dm
JOIN tsdb.MeterSuper m ON dm.modelID = m.modelID
JOIN tsdb.MonitoringCenter mc ON m.deviceID = mc.deviceID
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MeterSuper m2
    WHERE

 m2.deviceID = m.deviceID
)
ORDER BY m.current DESC, mc.status ASC;
  modelname |     current      | status
------------+------------------+---------
  电表模型2 | 77.9899693670714 |      0
  电表模型2 | 32.5922311651652 |     -1
  电表模型2 | 32.2432444339341 |     -1
  电表模型2 | 28.5696601355255 |      0
  电表模型2 | 26.9682940704655 |      0
  电表模型2 | 15.9094854493545 |     -1
  电表模型2 | 12.2075528531539 |      0
  电表模型2 | 11.1845391378352 |      0
  电表模型2 |  4.7143663137418 |      0
  电表模型2 |  2.5362712857187 |     -1
(10 rows)
> SELECT dm.ModelName, m.current, mc.status
FROM rdb.DeviceModel dm
JOIN tsdb.MeterSuper m ON dm.modelID = m.modelID
JOIN tsdb.MonitoringCenter mc ON m.deviceID = mc.deviceID
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MeterSuper m2
    WHERE m2.deviceID = m.deviceID
)
    AND (m.current > 100 OR mc.status = 1)
ORDER BY m.current DESC, mc.status ASC;
  modelname | current | status
------------+---------+---------
(0 rows)
> SELECT d.installDate, m.voltage
FROM rdb.Device d
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
JOIN tsdb.MonitoringCenter mc ON m.deviceID = mc.deviceID
WHERE d.location = 'area2'
    AND mc.status = 0
    AND EXISTS (
        SELECT 1
        FROM rdb.DeviceModel dm
        WHERE dm.modelID = d.modelID
            AND dm.TypeName = '电表'
    )
ORDER BY d.installDate DESC;
         installdate        |     voltage
----------------------------+-------------------
  2023-07-01 00:00:00+00:00 | 140.690224485548
  2023-07-01 00:00:00+00:00 | 73.3038314338742
  2023-07-01 00:00:00+00:00 | 129.540332823266
  2023-07-01 00:00:00+00:00 | 221.252417769086
  2023-07-01 00:00:00+00:00 | 193.149378415718
  2023-07-01 00:00:00+00:00 | 39.4609662728706
(6 rows)
> SELECT dm.ModelName, dm.TypeName, m.current, mc.status
FROM rdb.DeviceModel dm
JOIN tsdb.MeterSuper m ON dm.modelID = m.modelID
JOIN tsdb.MonitoringCenter mc ON m.deviceID = mc.deviceID
WHERE EXISTS (
    SELECT 1
    FROM rdb.Device d
    WHERE d.modelID = dm.modelID
)
ORDER BY m.deviceID ASC,m.current;
  modelname | typename |     current      | status
------------+----------+------------------+---------
  电表模型2 | 电表     |  4.7143663137418 |      0
  电表模型2 | 电表     | 11.1845391378352 |      0
  电表模型2 | 电表     | 12.2075528531539 |      0
  电表模型2 | 电表     | 26.9682940704655 |      0
  电表模型2 | 电表     | 28.5696601355255 |      0
  电表模型2 | 电表     | 77.9899693670714 |      0
  电表模型2 | 电表     |  2.5362712857187 |     -1
  电表模型2 | 电表     | 15.9094854493545 |     -1
  电表模型2 | 电表     | 32.2432444339341 |     -1
  电表模型2 | 电表     | 32.5922311651652 |     -1
(10 rows)
> SELECT dm.ModelName, m.current
FROM rdb.DeviceModel dm
JOIN tsdb.MeterSuper m ON dm.modelID = m.modelID
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = m.deviceID
        AND mc.status = 1
)
ORDER BY dm.ModelName ASC;
  modelname | current
------------+----------
(0 rows)
> SELECT dm.ModelName, m.current
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.modelID
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
JOIN tsdb.MonitoringCenter mc ON d.deviceID = mc.deviceID
WHERE d.location = 'area2'
    AND mc.status = 0
ORDER BY m.current DESC;
  modelname |     current
------------+-------------------
  电表模型2 | 77.9899693670714
  电表模型2 | 28.5696601355255
  电表模型2 | 26.9682940704655
  电表模型2 | 12.2075528531539
  电表模型2 | 11.1845391378352
  电表模型2 |  4.7143663137418
(6 rows)
> SELECT d.location, m.voltage
FROM rdb.Device d
JOIN tsdb.MeterSuper m ON d.deviceID = m.deviceID
JOIN tsdb.MonitoringCenter mc ON d.deviceID = mc.deviceID
WHERE d.installDate > '2023-05-01'
    AND mc.status = 1
ORDER BY m.voltage ASC;
  location | voltage
-----------+----------
(0 rows)
> SELECT d.deviceID,
    (SELECT COUNT(mc.status)
     FROM tsdb.MonitoringCenter mc
     WHERE mc.deviceID = d.deviceID) AS StatusCount
FROM rdb.Device d order by d.deviceID;
  deviceid | statuscount
-----------+--------------
         1 |           0
         2 |           1
         3 |           0
         4 |           0
         5 |           0
         6 |           0
         7 |           1
         8 |           0
         9 |           0
        10 |           0
        11 |           0
        12 |           0
        13 |           0
        14 |           1
        15 |           0
        16 |           1
        17 |           0
        18 |           1
        19 |           0
        20 |           0
        21 |           0
(21 rows)
> SELECT d.deviceID,
    (SELECT mc.status
     FROM tsdb.MonitoringCenter mc
     WHERE mc.deviceID = d.deviceID
     ORDER BY mc.ts DESC
     LIMIT 1) AS LatestStatus
FROM rdb.Device d order by deviceid;
  deviceid | lateststatus
-----------+---------------
         1 | NULL
         2 |            0
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 |           -1
         8 | NULL
         9 | NULL
        10 | NULL
        11 | NULL
        12 | NULL
        13 | NULL
        14 |            0
        15 | NULL
        16 |           -1
        17 | NULL
        18 |            0
        19 | NULL
        20 | NULL
        21 | NULL
(21 rows)
> SELECT d.deviceID,
    (SELECT MIN(mc.ts)
     FROM tsdb.MonitoringCenter mc
     WHERE mc.deviceID = d.deviceID) AS EarliestStatusTime
FROM rdb.Device d order by d.deviceID;
  deviceid |      earlieststatustime
-----------+--------------------------------
         1 | NULL
         2 | 2023-07-10 04:20:04.337+00:00
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 | 2023-07-08 04:41:43.514+00:00
         8 | NULL
         9 | NULL
        10 | NULL
        11 | NULL
        12 | NULL
        13 | NULL
        14 | 2023-07-08 14:55:50.421+00:00
        15 | NULL
        16 | 2023-07-10 00:01:06.133+00:00
        17 | NULL
        18 | 2023-07-07 23:23:16.211+00:00
        19 | NULL
        20 | NULL
        21 | NULL
(21 rows)
> SELECT d.deviceID,
    (SELECT AVG(mc.status)
     FROM tsdb.MonitoringCenter mc
     WHERE mc.deviceID = d.deviceID) AS AverageStatus
FROM rdb.Device d order by d.deviceID;
  deviceid | averagestatus
-----------+----------------
         1 | NULL
         2 |             0
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 |            -1
         8 | NULL
         9 | NULL
        10 | NULL
        11 | NULL
        12 | NULL
        13 | NULL
        14 |             0
        15 | NULL
        16 |            -1
        17 | NULL
        18 |             0
        19 | NULL
        20 | NULL
        21 | NULL
(21 rows)
> SELECT d.location,
       (SELECT mc.status FROM tsdb.MonitoringCenter mc WHERE mc.deviceID = d.deviceID) AS Status
FROM rdb.Device d
WHERE (SELECT COUNT(*) FROM tsdb.MonitoringCenter mc WHERE mc.deviceID = d.deviceID AND mc.status = 1) > 2
ORDER BY d.location DESC;
  location | status
-----------+---------
(0 rows)
> SELECT d.deviceID
FROM rdb.Device d
WHERE d.installDate < (
    SELECT MIN(mc.ts)
    FROM tsdb.MonitoringCenter mc
);
  deviceid
------------
         1
         2
         3
         4
         5
         6
         7
         8
         9
        10
        11
        12
        13
        14
        15
        16
        17
        18
        19
        20
        21
(21 rows)
> SELECT d.deviceID
FROM rdb.Device d
WHERE d.installDate = (
    SELECT MIN(mc.ts)
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = (
        SELECT d.deviceID
        FROM rdb.Device d ORDER by d.deviceID limit 1
    )
);
  deviceid
------------
(0 rows)
> SELECT dm.TypeName
FROM rdb.DeviceModel dm
WHERE dm.ModelID = (
    SELECT d.modelID
    FROM rdb.Device d
    WHERE d.deviceID = (
        SELECT mc.deviceID
        FROM tsdb.MonitoringCenter mc ORDER by mc.deviceID limit 1
    )
);
  typename
------------
  电表
(1 row)
> SELECT dm.ModelName,
       (SELECT COUNT(*) FROM rdb.Device d WHERE d.modelID = dm.modelID) AS DeviceCount,
       (SELECT COUNT(*) FROM tsdb.MonitoringCenter mc WHERE mc.deviceID = ANY(SELECT d.deviceID FROM rdb.Device d WHERE d.modelID = dm.modelID) AND mc.status = 1) AS StatusCount
FROM rdb.DeviceModel dm
ORDER BY DeviceCount DESC, dm.ModelName;
   modelname   | devicecount | statuscount
---------------+-------------+--------------
  变压器模型10 |           3 |           0
  变压器模型6  |           2 |           0
  变压器模型7  |           2 |           0
  变压器模型8  |           2 |           0
  变压器模型9  |           2 |           0
  电表模型1    |           2 |           0
  电表模型2    |           2 |           0
  电表模型3    |           2 |           0
  电表模型4    |           2 |           0
  电表模型5    |           2 |           0
(10 rows)
> SELECT d.deviceID
FROM rdb.Device d
GROUP BY d.deviceID
HAVING d.deviceID IN (
    SELECT mc.deviceID
    FROM tsdb.MonitoringCenter mc
    GROUP BY mc.deviceID
    HAVING COUNT(*) > 5
);
  deviceid
------------
(0 rows)
> SELECT d.deviceID, dm.TypeName
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
GROUP BY d.deviceID, dm.TypeName
HAVING AVG(d.deviceID) < (
    SELECT AVG(mc.status)
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
);
  deviceid | typename
-----------+-----------
(0 rows)
> SELECT dm.ModelName,
COUNT(1) AS DeviceCount,
(SELECT COUNT(1) FROM tsdb.MonitoringCenter mc WHERE mc.deviceID = d.deviceID AND mc.status = 1) AS StatusCount
FROM rdb.DeviceModel dm
JOIN rdb.Device d ON dm.modelID = d.modelID
GROUP BY dm.ModelName, d.deviceID
HAVING COUNT(*) > 2
ORDER BY DeviceCount DESC;
  modelname | devicecount | statuscount
------------+-------------+--------------
(0 rows)
> SELECT dm.ModelName,
t.temperature AS Temperature
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.modelID
JOIN tsdb.TransformerSuper t ON d.deviceID = t.deviceID
WHERE d.deviceID IN (SELECT mc.deviceID FROM tsdb.MonitoringCenter mc WHERE mc.status = 0)
AND (SELECT MAX(m.current) FROM tsdb.MeterSuper m WHERE m.deviceID = d.deviceID) < 100
ORDER BY Temperature DESC;
  modelname | temperature
------------+--------------
(0 rows)
> SELECT d.location,
       mc.status AS Status
FROM rdb.Device d
JOIN tsdb.MonitoringCenter mc ON d.deviceID = mc.deviceID
WHERE EXISTS (
    SELECT 1
    FROM rdb.Device d2
    WHERE d2.location = d.location
    HAVING COUNT(*) > 1
)
ORDER BY d.location DESC,status;
  location | status
-----------+---------
  area3    |     -1
  area2    |     -1
  area2    |      0
  area2    |      0
  area2    |      0
(5 rows)
> SELECT d.deviceID, dm.TypeName
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
ORDER BY (
    SELECT COUNT(mc.status)
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
) ASC, d.deviceID;
  deviceid | typename
-----------+-----------
         1 | 电表
         3 | 电表
         4 | 电表
         5 | 电表
         6 | 电表
         8 | 电表
         9 | 电表
        10 | 电表
        11 | 变压器
        12 | 变压器
        13 | 变压器
        15 | 变压器
        17 | 变压器
        19 | 变压器
        20 | 变压器
        21 | 变压器
         2 | 电表
         7 | 电表
        14 | 变压器
        16 | 变压器
        18 | 变压器
(21 rows)
> SELECT d.deviceID, dm.TypeName
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
ORDER BY (
    SELECT MIN(mc.ts)
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
) ASC, d.deviceID;
  deviceid | typename
-----------+-----------
         1 | 电表
         3 | 电表
         4 | 电表
         5 | 电表
         6 | 电表
         8 | 电表
         9 | 电表
        10 | 电表
        11 | 变压器
        12 | 变压器
        13 | 变压器
        15 | 变压器
        17 | 变压器
        19 | 变压器
        20 | 变压器
        21 | 变压器
        18 | 变压器
         7 | 电表
        14 | 变压器
        16 | 变压器
         2 | 电表
(21 rows)
> SELECT d.deviceID
FROM rdb.Device d
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
    HAVING COUNT(*) > 10
);
  deviceid
------------
(0 rows)
> SELECT d.deviceID
FROM rdb.Device d
WHERE EXISTS (
    SELECT 1
    FROM tsdb.MonitoringCenter mc
    WHERE mc.deviceID = d.deviceID
    AND mc.status = 0
) order by deviceID;
  deviceid
------------
         2
        14
        18
(3 rows)
> SELECT d.deviceID, dm.TypeName, AVG(mc.status), MAX(mc.status)
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
JOIN tsdb.MonitoringCenter mc ON d.deviceID = mc.deviceID
GROUP BY d.deviceID, dm.TypeName
HAVING COUNT(mc.status) > 10;
  deviceid | typename | avg | max
-----------+----------+-----+------
(0 rows)
> SELECT d.deviceID, dm.TypeName, AVG(mc.status), MIN(mc.status)
FROM rdb.Device d
JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
JOIN tsdb.MonitoringCenter mc ON d.deviceID = mc.deviceID
WHERE mc.status = 0
GROUP BY d.deviceID, dm.TypeName order by d.deviceID;
  deviceid | typename | avg | min
-----------+----------+-----+------
         2 | 电表     |   0 |   0
        14 | 变压器   |   0 |   0
        18 | 变压器   |   0 |   0
(3 rows)
> SELECT deviceID, NULL AS ts
FROM rdb.Device
UNION
SELECT NULL AS deviceID, ts
FROM tsdb.MonitoringCenter order by deviceID, ts;
  deviceid |              ts
-----------+--------------------------------
  NULL     | 2023-07-07 23:23:16.211+00:00
  NULL     | 2023-07-08 04:41:43.514+00:00
  NULL     | 2023-07-08 14:55:50.421+00:00
  NULL     | 2023-07-10 00:01:06.133+00:00
  NULL     | 2023-07-10 04:20:04.337+00:00
         1 | NULL
         2 | NULL
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 | NULL
         8 | NULL
         9 | NULL
        10 | NULL
        11 | NULL
        12 | NULL
        13 | NULL
        14 | NULL
        15 | NULL
        16 | NULL
        17 | NULL
        18 | NULL
        19 | NULL
        20 | NULL
        21 | NULL
(26 rows)
> SELECT deviceID, NULL AS status
FROM rdb.Device
UNION
SELECT NULL AS deviceID, status
FROM tsdb.MonitoringCenter order by deviceID, status;
  deviceid | status
-----------+---------
  NULL     |     -1
  NULL     |      0
         1 | NULL
         2 | NULL
         3 | NULL
         4 | NULL
         5 | NULL
         6 | NULL
         7 | NULL
         8 | NULL
         9 | NULL
        10 | NULL
        11 | NULL
        12 | NULL
        13 | NULL
        14 | NULL
        15 | NULL
        16 | NULL
        17 | NULL
        18 | NULL
        19 | NULL
        20 | NULL
        21 | NULL
(23 rows)
> SELECT TypeName, NULL AS status
FROM rdb.DeviceModel
UNION
SELECT NULL AS TypeName, status
FROM tsdb.MonitoringCenter order by TypeName, status;
  typename | status
-----------+---------
  NULL     |     -1
  NULL     |      0
  变压器   | NULL
  电表     | NULL
(4 rows)
> SELECT location, NULL AS ts
FROM rdb.Device
UNION
SELECT NULL AS location, ts
FROM tsdb.MonitoringCenter order by location,ts;
  location |              ts
-----------+--------------------------------
  NULL     | 2023-07-07 23:23:16.211+00:00
  NULL     | 2023-07-08 04:41:43.514+00:00
  NULL     | 2023-07-08 14:55:50.421+00:00
  NULL     | 2023-07-10 00:01:06.133+00:00
  NULL     | 2023-07-10 04:20:04.337+00:00
  area1    | NULL
  area2    | NULL
  area3    | NULL
(8 rows)
> SELECT deviceID, installDate, location, NULL AS ts, NULL AS status
FROM rdb.Device
UNION ALL
SELECT NULL AS deviceID, NULL AS installDate, NULL AS location, ts, status
FROM tsdb.MonitoringCenter
ORDER BY deviceID, installDate, location ASC,ts;
  deviceid |        installdate        | location |              ts               | status
-----------+---------------------------+----------+-------------------------------+---------
  NULL     | NULL                      | NULL     | 2023-07-07 23:23:16.211+00:00 |      0
  NULL     | NULL                      | NULL     | 2023-07-08 04:41:43.514+00:00 |     -1
  NULL     | NULL                      | NULL     | 2023-07-08 14:55:50.421+00:00 |      0
  NULL     | NULL                      | NULL     | 2023-07-10 00:01:06.133+00:00 |     -1
  NULL     | NULL                      | NULL     | 2023-07-10 04:20:04.337+00:00 |      0
         1 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL
         2 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL
         3 | 2023-07-01 00:00:00+00:00 | area3    | NULL                          | NULL
         4 | 2023-07-02 00:00:00+00:00 | area1    | NULL                          | NULL
         5 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
         6 | 2023-07-03 00:00:00+00:00 | area2    | NULL                          | NULL
         7 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL
         8 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL
         9 | 2023-07-02 00:00:00+00:00 | area3    | NULL                          | NULL
        10 | 2023-07-04 00:00:00+00:00 | area2    | NULL                          | NULL
        11 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL
        12 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL
        13 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
        14 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL
        15 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL
        16 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL
        17 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL
        18 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL
        19 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL
        20 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
        21 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
(26 rows)
> SELECT ModelID, TypeID, ModelName, TypeName, NULL AS ts, NULL AS status
FROM rdb.DeviceModel
UNION ALL
SELECT NULL AS ModelID, NULL AS TypeID, NULL AS ModelName, NULL AS TypeName, ts, status
FROM tsdb.MonitoringCenter
ORDER BY ModelID ASC, ts;
  modelid | typeid |  modelname   | typename |              ts               | status
----------+--------+--------------+----------+-------------------------------+---------
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 23:23:16.211+00:00 |      0
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 04:41:43.514+00:00 |     -1
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 14:55:50.421+00:00 |      0
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 00:01:06.133+00:00 |     -1
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 04:20:04.337+00:00 |      0
        1 |      1 | 电表模型1    | 电表     | NULL                          | NULL
        2 |      1 | 电表模型2    | 电表     | NULL                          | NULL
        3 |      1 | 电表模型3    | 电表     | NULL                          | NULL
        4 |      1 | 电表模型4    | 电表     | NULL                          | NULL
        5 |      1 | 电表模型5    | 电表     | NULL                          | NULL
        6 |      2 | 变压器模型6  | 变压器   | NULL                          | NULL
        7 |      2 | 变压器模型7  | 变压器   | NULL                          | NULL
        8 |      2 | 变压器模型8  | 变压器   | NULL                          | NULL
        9 |      2 | 变压器模型9  | 变压器   | NULL                          | NULL
       10 |      2 | 变压器模型10 | 变压器   | NULL                          | NULL
(15 rows)
> SELECT deviceID, installDate, location, NULL AS ts, NULL AS status
FROM rdb.Device
UNION ALL
SELECT NULL AS deviceID, NULL AS installDate, NULL AS location, ts, status
FROM tsdb.MonitoringCenter
ORDER BY installDate DESC,deviceid,ts;
  deviceid |        installdate        | location |              ts               | status
-----------+---------------------------+----------+-------------------------------+---------
         5 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
         8 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL
        10 | 2023-07-04 00:00:00+00:00 | area2    | NULL                          | NULL
        13 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
        16 | 2023-07-04 00:00:00+00:00 | area3    | NULL                          | NULL
        20 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
        21 | 2023-07-04 00:00:00+00:00 | area1    | NULL                          | NULL
         6 | 2023-07-03 00:00:00+00:00 | area2    | NULL                          | NULL
        12 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL
        17 | 2023-07-03 00:00:00+00:00 | area1    | NULL                          | NULL
         4 | 2023-07-02 00:00:00+00:00 | area1    | NULL                          | NULL
         7 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL
         9 | 2023-07-02 00:00:00+00:00 | area3    | NULL                          | NULL
        14 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL
        18 | 2023-07-02 00:00:00+00:00 | area2    | NULL                          | NULL
         1 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL
         2 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL
         3 | 2023-07-01 00:00:00+00:00 | area3    | NULL                          | NULL
        11 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL
        15 | 2023-07-01 00:00:00+00:00 | area1    | NULL                          | NULL
        19 | 2023-07-01 00:00:00+00:00 | area2    | NULL                          | NULL
  NULL     | NULL                      | NULL     | 2023-07-07 23:23:16.211+00:00 |      0
  NULL     | NULL                      | NULL     | 2023-07-08 04:41:43.514+00:00 |     -1
  NULL     | NULL                      | NULL     | 2023-07-08 14:55:50.421+00:00 |      0
  NULL     | NULL                      | NULL     | 2023-07-10 00:01:06.133+00:00 |     -1
  NULL     | NULL                      | NULL     | 2023-07-10 04:20:04.337+00:00 |      0
(26 rows)
> SELECT ModelID, TypeID, ModelName, TypeName, NULL AS ts, NULL AS status
FROM rdb.DeviceModel
UNION ALL
SELECT NULL AS ModelID, NULL AS TypeID, NULL AS ModelName, NULL AS TypeName, ts, status
FROM tsdb.MonitoringCenter
ORDER BY ModelID,  ts DESC;
  modelid | typeid |  modelname   | typename |              ts               | status
----------+--------+--------------+----------+-------------------------------+---------
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 04:20:04.337+00:00 |      0
  NULL    | NULL   | NULL         | NULL     | 2023-07-10 00:01:06.133+00:00 |     -1
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 14:55:50.421+00:00 |      0
  NULL    | NULL   | NULL         | NULL     | 2023-07-08 04:41:43.514+00:00 |     -1
  NULL    | NULL   | NULL         | NULL     | 2023-07-07 23:23:16.211+00:00 |      0
        1 |      1 | 电表模型1    | 电表     | NULL                          | NULL
        2 |      1 | 电表模型2    | 电表     | NULL                          | NULL
        3 |      1 | 电表模型3    | 电表     | NULL                          | NULL
        4 |      1 | 电表模型4    | 电表     | NULL                          | NULL
        5 |      1 | 电表模型5    | 电表     | NULL                          | NULL
        6 |      2 | 变压器模型6  | 变压器   | NULL                          | NULL
        7 |      2 | 变压器模型7  | 变压器   | NULL                          | NULL
        8 |      2 | 变压器模型8  | 变压器   | NULL                          | NULL
        9 |      2 | 变压器模型9  | 变压器   | NULL                          | NULL
       10 |      2 | 变压器模型10 | 变压器   | NULL                          | NULL
(15 rows)
> SELECT deviceID FROM rdb.Device
INTERSECT
SELECT deviceID FROM tsdb.MonitoringCenter
ORDER BY deviceID;
  deviceid
------------
         2
         7
        14
        16
        18
(5 rows)
> SELECT deviceID FROM tsdb.MeterSuper
INTERSECT
SELECT deviceID FROM tsdb.MonitoringCenter
ORDER BY deviceID DESC;
  deviceid
------------
         7
         2
(2 rows)
> SELECT deviceID FROM tsdb.TransformerSuper
INTERSECT
SELECT deviceID FROM tsdb.MonitoringCenter
ORDER BY deviceID;
  deviceid
------------
        14
        16
        18
(3 rows)
> SELECT DISTINCT TypeName, location
FROM (
    SELECT modelID, location 
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID, status
            FROM tsdb.MonitoringCenter
            WHERE ts IN (
                SELECT MAX(ts) 
                FROM tsdb.MonitoringCenter 
                WHERE status = 0
            )
        ) AS SubSubQuery1
    )
) AS SubQuery1
JOIN rdb.DeviceModel ON SubQuery1.modelID = rdb.DeviceModel.modelID
ORDER BY TypeName, location;
  typename | location
-----------+-----------
  电表     | area2
(1 row)
> SELECT SubQuery2.deviceID, ModelName, TypeName, status
FROM (
    SELECT modelID, deviceID 
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID 
        FROM (
            SELECT deviceID 
            FROM tsdb.MeterSuper
            WHERE current > '10' AND voltage > '220'
        ) AS SubSubQuery2
    )
) AS SubQuery2
JOIN rdb.DeviceModel ON SubQuery2.modelID = rdb.DeviceModel.modelID
JOIN tsdb.MonitoringCenter ON SubQuery2.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY status DESC, SubQuery2.deviceID;
  deviceid | modelname | typename | status
-----------+-----------+----------+---------
         2 | 电表模型2 | 电表     |      0
(1 row)
> SELECT SubQuery3.deviceID, ModelName, TypeName, status
FROM (
    SELECT modelID, deviceID 
    FROM rdb.Device
    WHERE installDate IN (
        SELECT MIN(installDate) 
        FROM (
            SELECT installDate 
            FROM rdb.Device
        ) AS SubSubQuery3
    )
) AS SubQuery3
JOIN rdb.DeviceModel ON SubQuery3.modelID = rdb.DeviceModel.modelID
JOIN tsdb.MonitoringCenter ON SubQuery3.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY SubQuery3.deviceID DESC;
  deviceid | modelname | typename | status
-----------+-----------+----------+---------
         2 | 电表模型2 | 电表     |      0
(1 row)
> SELECT SubQuery4.deviceID, ModelName, current, voltage
FROM (
    SELECT modelID, deviceID 
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID
            FROM tsdb.MonitoringCenter
            WHERE status = -1 AND ts IN (
                SELECT MAX(ts) 
                FROM tsdb.MonitoringCenter 
            )
        ) AS SubSubQuery4
    )
) AS SubQuery4
JOIN rdb.DeviceModel ON SubQuery4.modelID = rdb.DeviceModel.modelID
JOIN tsdb.MeterSuper ON SubQuery4.deviceID = tsdb.MeterSuper.deviceID
WHERE TypeName = '电表'
ORDER BY current DESC, voltage DESC;
  deviceid | modelname | current | voltage
-----------+-----------+---------+----------
(0 rows)
> SELECT SubQuery5.deviceID, ModelName, TypeName, status
FROM (
    SELECT modelID, deviceID 
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID 
        FROM (
            SELECT deviceID 
            FROM tsdb.TransformerSuper
            WHERE frequency > '20' AND temperature > '25'
        ) AS SubSubQuery5
    )
) AS SubQuery5
JOIN rdb.DeviceModel ON SubQuery5.modelID = rdb.DeviceModel.modelID
JOIN tsdb.MonitoringCenter ON SubQuery5.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY status DESC, SubQuery5.deviceID;
  deviceid |  modelname  | typename | status
-----------+-------------+----------+---------
        14 | 变压器模型9 | 变压器   |      0
        18 | 变压器模型8 | 变压器   |      0
        16 | 变压器模型6 | 变压器   |     -1
(3 rows)
> SELECT location, COUNT(*) as device_count
FROM (
    SELECT location
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID
            FROM rdb.Device
        ) AS SubSubQuery6
    )
) AS SubQuery6
GROUP BY location
ORDER BY device_count DESC;
  location | device_count
-----------+---------------
  area1    |            9
  area2    |            8
  area3    |            4
(3 rows)
> SELECT SubQuery7.deviceID, ModelName, current, voltage, status
FROM (
    SELECT modelID, deviceID
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID
            FROM tsdb.MeterSuper
            WHERE ts IN (



                SELECT MAX(ts)
                FROM tsdb.MeterSuper
            ) AND current < '100' AND voltage < '220'
        ) AS SubSubQuery7
    )
) AS SubQuery7
JOIN rdb.DeviceModel ON SubQuery7.modelID = rdb.DeviceModel.modelID
JOIN tsdb.MeterSuper ON SubQuery7.deviceID = tsdb.MeterSuper.deviceID
JOIN tsdb.MonitoringCenter ON SubQuery7.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY status DESC;
  deviceid | modelname |     current      |     voltage      | status
-----------+-----------+------------------+------------------+---------
         7 | 电表模型2 | 32.2432444339341 | 177.586383495766 |     -1
         7 | 电表模型2 | 32.5922311651652 | 168.706203551883 |     -1
         7 | 电表模型2 |  2.5362712857187 | 184.428403488133 |     -1
         7 | 电表模型2 | 15.9094854493545 | 178.524534293103 |     -1
(4 rows)
> SELECT SubQuery8.deviceID, ModelName, temperature, status
FROM (
    SELECT modelID, deviceID
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID
            FROM tsdb.TransformerSuper
            WHERE ts > '2023-07-03'
        ) AS SubSubQuery8
    )
) AS SubQuery8
JOIN rdb.DeviceModel ON SubQuery8.modelID = rdb.DeviceModel.modelID
JOIN tsdb.TransformerSuper ON SubQuery8.deviceID = tsdb.TransformerSuper.deviceID
JOIN tsdb.MonitoringCenter ON SubQuery8.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY deviceid,temperature;
  deviceid |  modelname  |    temperature    | status
-----------+-------------+-------------------+---------
        14 | 变压器模型9 |  0.88726046519966 |      0
        14 | 变压器模型9 | 0.888262181329367 |      0
        14 | 变压器模型9 |  19.9842878240267 |      0
        14 | 变压器模型9 |  20.5944805823982 |      0
        14 | 变压器模型9 |  27.8537278009513 |      0
        14 | 变压器模型9 |  28.3796205960211 |      0
        14 | 变压器模型9 |  30.0818710128209 |      0
        14 | 变压器模型9 |  35.6732716012075 |      0
        16 | 变压器模型6 |  4.02753975120433 |     -1
        16 | 变压器模型6 |  5.22039849693016 |     -1
        16 | 变压器模型6 |  12.7393411825183 |     -1
        16 | 变压器模型6 |  16.0702858199367 |     -1
        16 | 变压器模型6 |  19.2503307615728 |     -1
        16 | 变压器模型6 |  38.2180913775925 |     -1
        18 | 变压器模型8 |  8.99106030213915 |      0
        18 | 变压器模型8 |   12.141814707802 |      0
        18 | 变压器模型8 |  14.6356906093611 |      0
        18 | 变压器模型8 |  20.4276840331148 |      0
        18 | 变压器模型8 |  21.6289511267588 |      0
        18 | 变压器模型8 |  29.4223010516673 |      0
(20 rows)
> SELECT SubQuery9.deviceID, ModelName, current, voltage, status
FROM (
    SELECT modelID, deviceID
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID
            FROM tsdb.MeterSuper
            WHERE ts IN (
                SELECT MAX(ts)
                FROM tsdb.MeterSuper
            ) AND current > '10' AND voltage > '210'
        ) AS SubSubQuery9
    )
) AS SubQuery9
JOIN rdb.DeviceModel ON SubQuery9.modelID = rdb.DeviceModel.modelID
JOIN tsdb.MeterSuper ON SubQuery9.deviceID = tsdb.MeterSuper.deviceID
JOIN tsdb.MonitoringCenter ON SubQuery9.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY status DESC;
  deviceid | modelname | current | voltage | status
-----------+-----------+---------+---------+---------
(0 rows)
> SELECT SubQuery10.deviceID, ModelName, frequency, temperature, status
FROM (
    SELECT modelID, deviceID
    FROM rdb.Device
    WHERE deviceID IN (
        SELECT deviceID
        FROM (
            SELECT deviceID
            FROM tsdb.TransformerSuper
            WHERE ts IN (
                SELECT MAX(ts)
                FROM tsdb.TransformerSuper
            ) AND frequency > '20' AND temperature > '30'
        ) AS SubSubQuery10
    )
) AS SubQuery10
JOIN rdb.DeviceModel ON SubQuery10.modelID = rdb.DeviceModel.modelID
JOIN tsdb.TransformerSuper ON SubQuery10.deviceID = tsdb.TransformerSuper.deviceID
JOIN tsdb.MonitoringCenter ON SubQuery10.deviceID = tsdb.MonitoringCenter.deviceID
ORDER BY status DESC;
  deviceid | modelname | frequency | temperature | status
-----------+-----------+-----------+-------------+---------
(0 rows)
> SELECT d.deviceID, dm.ModelName, mc.status
FROM rdb.Device AS d
JOIN rdb.DeviceModel AS dm ON d.modelID = dm.ModelID
JOIN tsdb.MonitoringCenter AS mc ON d.deviceID = mc.deviceID
WHERE d.deviceID IN (
  SELECT deviceID
  FROM tsdb.MonitoringCenter
  WHERE status = 0
)
UNION 
SELECT ms.deviceID, dm.ModelName, NULL AS status
FROM tsdb.MeterSuper AS ms
JOIN rdb.DeviceModel AS dm ON ms.modelID = dm.ModelID
JOIN rdb.Device AS d ON ms.deviceID = d.deviceID
WHERE ms.voltage > (
  SELECT AVG(voltage)
  FROM tsdb.MeterSuper
)  
UNION
SELECT ts.deviceID, dm.ModelName, NULL AS status
FROM tsdb.TransformerSuper AS ts
JOIN rdb.DeviceModel AS dm ON ts.modelID = dm.ModelID
JOIN rdb.Device AS d ON ts.deviceID = d.deviceID
WHERE ts.temperature > (
  SELECT MAX(temperature)
  FROM tsdb.TransformerSuper
)
ORDER BY deviceID ASC, status;
  deviceid |  modelname  | status
-----------+-------------+---------
         1 | 电表模型1   | NULL
         2 | 电表模型2   | NULL
         2 | 电表模型2   |      0
         3 | 电表模型3   | NULL
         4 | 电表模型4   | NULL
         5 | 电表模型5   | NULL
         6 | 电表模型1   | NULL
         7 | 电表模型2   | NULL
         8 | 电表模型3   | NULL
         9 | 电表模型4   | NULL
        10 | 电表模型5   | NULL
        14 | 变压器模型9 |      0
        18 | 变压器模型8 |      0
(13 rows)
> SELECT d.deviceID, dm.ModelName, mc.status
FROM rdb.Device AS d
JOIN rdb.DeviceModel AS dm ON d.modelID = dm.ModelID
JOIN tsdb.MonitoringCenter AS mc ON d.deviceID = mc.deviceID
UNION 
SELECT ms.deviceID, dm.ModelName, NULL AS status
FROM tsdb.MeterSuper AS ms
JOIN rdb.DeviceModel AS dm ON ms.modelID = dm.ModelID
JOIN rdb.Device AS d ON ms.deviceID = d.deviceID
UNION
SELECT ts.deviceID, dm.ModelName, NULL AS status  
FROM tsdb.TransformerSuper AS ts
JOIN rdb.DeviceModel AS dm ON ts.modelID = dm.ModelID
JOIN rdb.Device AS d ON ts.deviceID = d.deviceID
ORDER BY deviceID ASC,status;
  deviceid |  modelname   | status
-----------+--------------+---------
         1 | 电表模型1    | NULL
         2 | 电表模型2    | NULL
         2 | 电表模型2    |      0
         3 | 电表模型3    | NULL
         4 | 电表模型4    | NULL
         5 | 电表模型5    | NULL
         6 | 电表模型1    | NULL
         7 | 电表模型2    | NULL
         7 | 电表模型2    |     -1
         8 | 电表模型3    | NULL
         9 | 电表模型4    | NULL
        10 | 电表模型5    | NULL
        11 | 变压器模型6  | NULL
        12 | 变压器模型7  | NULL
        13 | 变压器模型8  | NULL
        14 | 变压器模型9  | NULL
        14 | 变压器模型9  |      0
        15 | 变压器模型10 | NULL
        16 | 变压器模型6  | NULL
        16 | 变压器模型6  |     -1
        17 | 变压器模型7  | NULL
        18 | 变压器模型8  | NULL
        18 | 变压器模型8  |      0
        19 | 变压器模型9  | NULL
        20 | 变压器模型10 | NULL
(25 rows)
> select STR_TO_DATE(hour,'%Y-%m-%d %H') as create_time,ifnull(vehicle.number,0) number from ( select * from (
select concat(a.thisweek,' ',b.hh) as hour from (
SELECT  DATE(subdate(curdate(),date_format(curdate(),'%w')-1)) as thisweek
union all
SELECT  DATE(DATE_ADD(subdate(curdate(),date_format(curdate(),'%w')-1), interval 1 day)) as thisweek
union all
SELECT  DATE(DATE_ADD(subdate(curdate(),date_format(curdate(),'%w')-1), interval 2 day)) as thisweek
union all
SELECT  DATE(DATE_ADD(subdate(curdate(),date_format(curdate(),'%w')-1), interval 3 day)) as thisweek
union all
SELECT  DATE(DATE_ADD(subdate(curdate(),date_format(curdate(),'%w')-1), interval 4 day)) as thisweek
union all
SELECT DATE(DATE_ADD(subdate(curdate(),date_format(curdate(),'%w')-1), interval 5 day)) as thisweek
union all
SELECT DATE(DATE_ADD(subdate(curdate(),date_format(curdate(),'%w')-1), interval 6 day)) as thisweek
) a left join (
SELECT *
FROM
(
SELECT hh
FROM
(
SELECT DATE_FORMAT(CURDATE(),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 1 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 2 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 3 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 4 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 5 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 6 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 7 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 8 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 9 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 10 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 11 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 12 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 13 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 14 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 15 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 16 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 17 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 18 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 19 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 20 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 21 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 22 HOUR),'%H') AS hh UNION
SELECT DATE_FORMAT(DATE_ADD(CURDATE(),INTERVAL 23 HOUR),'%H') AS hh
) hourtable
) hourtable
) b on 1=1 order by a.thisweek,b.hh) c where hour <= DATE_FORMAT(now(),'%Y-%m-%d %H')) days left join (
select hh,h,count(*) number from (
select hh, min(create_time) h from (
select distinct date_format(create_time,'%Y-%m-%d %H') hh, create_time,vid from dcjg_vehicle_device_online_status where online = 1
) a
group by hh order by hh,h) tem1 left join dcjg_vehicle_device_online_status tem2 on tem1.h=tem2.create_time
where tem2.online = 1
group by hh,h) vehicle on days.hour= vehicle.hh
order by hour;
ERROR: at or near "1": syntax error
SQLSTATE: 42601
DETAIL: source SQL:
select STR_TO_DATE(hour,'%Y-%m-%d %H') as create_time,ifnull(vehicle.number,0) number from ( select * from (
select concat(a.thisweek,' ',b.hh) as hour from (
SELECT  DATE(subdate(curdate(),date_format(curdate(),'%w')-1)) as thisweek
union all
SELECT  DATE(DATE_ADD(subdate(curdate(),date_format(curdate(),'%w')-1), interval 1 day)) as thisweek
                                                                                 ^
> SELECT d.deviceID, dm.TypeName
FROM rdb.Device d
         JOIN rdb.DeviceModel dm ON d.modelID = dm.ModelID
ORDER BY 1,2,(
    SELECT MAX(ms.current) - MIN(ms.current)
    FROM tsdb.MeterSuper ms
    WHERE ms.deviceID = d.deviceID
) DESC;
  deviceid | typename
-----------+-----------
         1 | 电表
         2 | 电表
         3 | 电表
         4 | 电表
         5 | 电表
         6 | 电表
         7 | 电表
         8 | 电表
         9 | 电表
        10 | 电表
        11 | 变压器
        12 | 变压器
        13 | 变压器
        14 | 变压器
        15 | 变压器
        16 | 变压器
        17 | 变压器
        18 | 变压器
        19 | 变压器
        20 | 变压器
        21 | 变压器
(21 rows)
> SELECT ms.deviceID, ms.current,
       (SELECT AVG(ms2.current)
        FROM tsdb.MeterSuper ms2
        WHERE ms2.deviceID = ms.deviceID) AS AverageCurrent
FROM tsdb.MeterSuper ms ORDER BY ms.deviceID, ms.current;
  deviceid |     current      |  averagecurrent
-----------+------------------+-------------------
         1 | 11.3623350383022 | 71.5437497690942
         1 | 51.3657007868602 | 71.5437497690942
         1 | 69.6333622281017 | 71.5437497690942
         1 |  83.497262058816 | 71.5437497690942
         1 | 92.1571660223094 | 71.5437497690942
         1 | 93.3225547467301 | 71.5437497690942
         1 | 99.4678675025397 | 71.5437497690942
         2 |  4.7143663137418 | 26.9390636462989
         2 | 11.1845391378352 | 26.9390636462989
         2 | 12.2075528531539 | 26.9390636462989
         2 | 26.9682940704655 | 26.9390636462989
         2 | 28.5696601355255 | 26.9390636462989
         2 | 77.9899693670714 | 26.9390636462989
         3 |  5.1943308789773 | 60.1016472893237
         3 | 19.1017958876088 | 60.1016472893237
         3 | 42.5942338040329 | 60.1016472893237
         3 | 83.6478628663485 | 60.1016472893237
         3 | 88.2676084108624 | 60.1016472893237
         3 | 89.7564312801932 | 60.1016472893237
         3 | 92.1492678972427 | 60.1016472893237
         4 | 50.3771483027861 | 68.0488984336449
         4 | 64.7608834949323 | 68.0488984336449
         4 | 70.4166998637219 | 68.0488984336449
         4 | 86.6408620731391 | 68.0488984336449
         5 | 38.3605591260021 | 46.9681369598987
         5 | 55.5757147937953 | 46.9681369598987
         6 |  8.0020595087802 |  23.862926735298
         6 | 21.2326354535832 |  23.862926735298
         6 |  27.444401746537 |  23.862926735298
         6 | 38.7726102322915 |  23.862926735298
         7 |  2.5362712857187 | 20.8203080835431
         7 | 15.9094854493545 | 20.8203080835431
         7 | 32.2432444339341 | 20.8203080835431
         7 | 32.5922311651652 | 20.8203080835431
         8 | 43.7369827209636 | 64.1365024363129
         8 | 51.4086117972453 | 64.1365024363129
         8 | 97.2639127907299 | 64.1365024363129
         9 |  1.4552285651376 |  48.761286186874
         9 | 51.3779408142966 |  48.761286186874
         9 | 58.7603069416189 |  48.761286186874
         9 | 65.8289096339743 |  48.761286186874
         9 | 66.3840449793426 |  48.761286186874
        10 | 27.6364208231029 | 43.1238636013368
        10 | 30.1632209734123 | 43.1238636013368
        10 | 35.0903702996475 | 43.1238636013368
        10 | 79.6054423091845 | 43.1238636013368
(46 rows)
> INSERT INTO tsdb.MeterSuper VALUES ('2023-07-04 03:01:52.471061', 47.208762254501835, 210.62415836770043, 0.1394836664495358,005,5);
INSERT 1
> SELECT ms.deviceID, ms.ts
FROM tsdb.MeterSuper ms
WHERE EXISTS (
SELECT 1
FROM rdb.Device d
WHERE d.deviceID = ms.deviceID
AND d.installDate = ms.ts::date
) ORDER by ts;
  deviceid |              ts
-----------+--------------------------------
         5 | 2023-07-04 03:01:52.471+00:00
(1 row)
> reset extra_float_digits;
SET
> drop DATABASE rdb;
DROP DATABASE
> drop DATABASE tsdb cascade;
DROP DATABASE
> create ts database iot_gas_meter;
CREATE TS DATABASE
> USE iot_gas_meter;
SET
> CREATE TABLE iot_gas_meter.meter_detail_info (
create_time                     TIMESTAMPTZ     NOT NULL,
read_time                   TIMESTAMPTZ     NOT NULL,
std_sum_vol             FLOAT4                  NOT NULL,
meter_status                INT8                    NULL,
event_code                  INT8                    NULL,
meter_time                  TIMESTAMPTZ             NOT NULL,
main_voltage                FLOAT4                  NULL,
eng_sum_vol                 FLOAT4                  NULL,
com_sum_vol                 FLOAT4                  NULL,
temperature                 FLOAT4                  NULL,
pressure                    INT8                    NULL,
acoustic_velocity   INT4                    NULL,
measure_voltage         FLOAT4                  NULL,
update_time                 TIMESTAMPTZ     NOT NULL
) TAGS (
meter_id                    INT8                    NOT NULL,
ou_id                           INT4                    NOT NULL,
mnft_code                       INT2                    NOT NULL
) PRIMARY TAGS(mnft_code, meter_id)
retentions 30d
ACTIVETIME 30d
partition interval 10d ;
CREATE TABLE
> CREATE TABLE iot_gas_meter.bill_abs_info (
 create_time                             TIMESTAMPTZ     NOT NULL,
 charge_time                                 TIMESTAMPTZ     NOT NULL,
 calc_amount                                     FLOAT8                  NULL,
 calc_volume                                 FLOAT8                  NULL,
 accumulate_volume                   FLOAT8                  NULL,
 meter_balance                               FLOAT8                  NULL,
 update_time                                 TIMESTAMPTZ     NOT NULL
) TAGS (
meter_id                                        INT8                    NOT NULL,
ou_id                                           INT4                    NOT NULL,
mnft_code                                       INT2                    NOT NULL
) PRIMARY TAGS(mnft_code, meter_id) retentions 30d partition interval 10d;
CREATE TABLE
> create database statistics;
CREATE DATABASE
> create table statistics.tmp_uniq_id_lost (last_time TIMESTAMPTZ not null, meter_id int8 not null unique, ou_id int4, mnft_code int2);
CREATE TABLE
> explain select *
from meter_detail_info
where meter_id = '1252011120050116'
  and mnft_code = '125'
    limit 10;
           tree          |     field      |         description
-------------------------+----------------+------------------------------
                         | distributed    | true
                         | vectorized     | false
  limit                  |                |
   │                     | engine type    | time series
   │                     | count          | 10
   └── synchronizer      |                |
        └── limit        |                |
             │           | engine type    | time series
             │           | count          | 10
             └── ts scan |                |
                         | ts-table       | meter_detail_info
                         | access mode    | tagIndexTable
                         | ptag filter[0] | meter_id = 1252011120050116
                         | ptag filter[1] | mnft_code = 125
(14 rows)
> explain select *
from meter_detail_info
where create_time >= TIMESTAMPTZ '2024-12-13 00:00:00.000+00:00'
  and meter_id = '1252011120050116'
  and mnft_code = '125'
limit 10;
           tree          |     field      |          description
-------------------------+----------------+--------------------------------
                         | distributed    | true
                         | vectorized     | false
  limit                  |                |
   │                     | engine type    | time series
   │                     | count          | 10
   └── synchronizer      |                |
        └── limit        |                |
             │           | engine type    | time series
             │           | count          | 10
             └── ts scan |                |
                         | ts-table       | meter_detail_info
                         | access mode    | tagIndexTable
                         | spans:fromTime | 2024-12-13 00:00:00 +0000 UTC
                         | spans:toTime   | 2970-01-01 00:00:00 +0000 UTC
                         | ptag filter[0] | meter_id = 1252011120050116
                         | ptag filter[1] | mnft_code = 125
(16 rows)
> explain select count(1)
from meter_detail_info
where create_time >=date_trunc('day', '2024-01-01 10:00:00'::timestamptz)-2h
  and create_time <date_trunc('day', '2024-01-01 10:00:00'::timestamptz)-1h;
        tree        |        field        |            description
--------------------+---------------------+------------------------------------
                    | distributed         | true
                    | vectorized          | false
  group             |                     |
   │                | engine type         | time series
   │                | aggregate 0         | count(1)
   │                | scalar              |
   │                | pushLocalAggToScan  | true
   │                | addSynchronizer     | true
   └── render       |                     |
        │           | engine type         | time series
        │           | 1                   | 1
        └── ts scan |                     |
                    | ts-table            | meter_detail_info
                    | access mode         | metaTable
                    | use statistic       | true
                    | spans:fromTime      | 2023-12-31 22:00:00 +0000 UTC
                    | spans:toTime        | 2023-12-31 22:59:59.999 +0000 UTC
(17 rows)
> set cluster setting sql.stats.ts_automatic_collection.enabled=true;
SET CLUSTER SETTING
> explain select meter_id, mnft_code, ou_id, count(1) as num
from meter_detail_info
where create_time >=date_trunc('day', '2024-01-01 10:00:00'::timestamptz)-2h
  and create_time <date_trunc('day', '2024-01-01 10:00:00'::timestamptz)-1h
  and ou_id = '138800'
group by meter_id, mnft_code , ou_id having count(1)>1;
                tree               |        field        |            description
-----------------------------------+---------------------+------------------------------------
                                   | distributed         | true
                                   | vectorized          | false
  render                           |                     |
   │                               | engine type         | time series
   │                               | meter_id            | meter_id
   │                               | mnft_code           | mnft_code
   │                               | ou_id               | any_not_null
   │                               | num                 | count
   └── filter                      |                     |
        │                          | engine type         | time series
        │                          | filter              | count > 1
        └── group                  |                     |
             │                     | engine type         | time series
             │                     | aggregate 0         | meter_id
             │                     | aggregate 1         | mnft_code
             │                     | aggregate 2         | count(1)
             │                     | aggregate 3         | any_not_null(ou_id)
             │                     | group by            | meter_id, mnft_code
             │                     | pushLocalAggToScan  | true
             │                     | pruneFinalAgg       | true
             └── synchronizer      |                     |
                  └── render       |                     |
                       │           | engine type         | time series
                       │           | 1                   | 1
                       │           | meter_id            | meter_id
                       │           | ou_id               | ou_id
                       │           | mnft_code           | mnft_code
                       └── ts scan |                     |
                                   | ts-table            | meter_detail_info
                                   | access mode         | tableTableMeta
                                   | use statistic       | true
                                   | spans:fromTime      | 2023-12-31 22:00:00 +0000 UTC
                                   | spans:toTime        | 2023-12-31 22:59:59.999 +0000 UTC
                                   | tag filter[0]       | ou_id = 138800
(34 rows)
> reset cluster setting sql.stats.ts_automatic_collection.enabled;
SET CLUSTER SETTING
> drop database iot_gas_meter cascade;
DROP DATABASE
> drop database statistics cascade;
DROP DATABASE
