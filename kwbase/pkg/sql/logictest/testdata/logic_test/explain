# LogicTest: local local-vec-off local-vec

statement ok
CREATE TABLE t (a INT PRIMARY KEY)

# Test that EXPLAIN (DISTSQL) on a query with a subquery works.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT * FROM (SELECT avg(a) OVER () FROM t)]
----
eJyUkE9LwzAYxu9-ivCeWolsHZ5y2tAqhbnNtkxh9BCblxHokpik6hj97rKmBzeY6PF9_uT5kQO49wYYFOk8vStJaxvykC-fyCZ9Xc1n2YJE91lRFs_zmAyR6xCIhpN_bCMek-U6zUkUB8_HFVBQWuCC79AB20ACFQVjdY3OaXuUDn0gE1_AxhSkMq0_yhWFWlsEdgAvfYPAoORvDebIBdrRGCgI9Fw2_bN-aqzccbsHCoXhyjFyAxSWrTetL_cGHSNS-VuoOgq6V4cR5_kWgSUd_TvIi1RCf6IdJacUs_VjNE3iMMzIdHKOILCWO95cpJj8hyJHZ7RyeMJw6eVxV1FAscXw5U63tsaV1XU_E86A2gsCnQ9uEo5MBesI-LOc_FqenJWr7uo7AAD__25jxeA=

# Test that explaining a query that contains a subquery the result of which is
# needed to make the physical plan is rejected. See #40677.
statement error running EXPLAIN \(DISTSQL\) on this query is unsupported because of the presence of subqueries
EXPLAIN (DISTSQL) SELECT avg(a) OVER (ROWS (SELECT count(*) FROM t) PRECEDING) FROM t
